{"version":3,"sources":["..\\..\\..\\..\\..\\assets\\script\\ui/assets\\script\\ui\\fjssz_UIMain.js"],"names":["app","require","cc","Class","extends","subGameName","properties","resVersion","Label","OnCreateInit","practiceConfig","GetTableDict","FormManager","RegEvent","Event_GetCurRoomID","Event_CodeError","OnShow","SetGameType","curRoomID","curGameTypeStr","SetGetRoomIDByUI","SendPack","sys","isNative","string","getLocalVersion","ShowForm","SetAutoPlayIng","CloseForm","allSwitchGameData","switchGameData","localStorage","getItem","push","JSON","parse","i","length","console","log","action","fromName","setItem","event","serverPack","roomID","gameType","toLowerCase","codeInfo","ShareDefine","NotFind_Room","ShowSysMsg","OnClose","InitGameBtnList","SetWaitForConfirm","msgID","type","msgArg","cbArg","ConfirmManager","SetWaitForConfirmForm","OnConFirm","bind","ShowConfirm","clickType","backArgList","Click_btn_goRoom","clubId","clubCardNtfs","splice","data","setTimeout","clubName","roomcardattention","OnClick","btnName","btnNode","Confirm","RemoveClientManager","LocalDataManager","SetConfigProperty","gamePath","jsb","fileUtils","getWritablePath","window","error","OnEvent_LoginGetCurRoomID"],"mappings":"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","file":"fjssz_UIMain.js","sourceRoot":"..\\..\\..\\..\\..\\assets\\script\\ui","sourcesContent":["var app = require(\"fjssz_app\");\r\ncc.Class({\r\n\textends: require(app.subGameName + \"_BaseForm\"),\r\n\r\n\tproperties: {\r\n\t\tresVersion: cc.Label,\r\n\t},\r\n\tOnCreateInit: function () {\r\n\t\tthis.practiceConfig = app[app.subGameName + \"_SysDataManager\"]().GetTableDict(\"practice\");\r\n\t\tthis.FormManager = app[app.subGameName + \"_FormManager\"]();\r\n\t\tthis.RegEvent(\"GetCurRoomID\", this.Event_GetCurRoomID, this);\r\n\t\tthis.RegEvent(\"CodeError\", this.Event_CodeError, this);\r\n\t},\r\n\t//-----------------显示函数------------------\r\n\tOnShow: function () {\r\n\t\tapp[app.subGameName + \"Client\"].SetGameType('');\r\n\t\tthis.curRoomID = 0;\r\n\t\tthis.curGameTypeStr = '';\r\n\t\tapp[app.subGameName + \"_GameManager\"]().SetGetRoomIDByUI(true);\r\n\t\tapp[app.subGameName + \"_NetManager\"]().SendPack(\"game.C1101GetRoomID\", {});\r\n\r\n\t\tif (cc.sys.isNative) {\r\n\t\t\tthis.resVersion.string = \"resV\" + app[app.subGameName + \"_HotUpdateMgr\"]().getLocalVersion();\r\n\t\t} else {\r\n\t\t\tthis.resVersion.string = '';\r\n\t\t}\r\n\t\tthis.FormManager.ShowForm(app.subGameName + \"_UITop\", app.subGameName + \"_UIMain\", true, false, true);\r\n\t\tapp[app.subGameName + \"_GameManager\"]().SetAutoPlayIng(false);\r\n\t\tthis.FormManager.CloseForm(app.subGameName + \"_UIAutoPlay\");\r\n\t\t//返回大厅检测下是否有需要处理的数据\r\n\t\tlet allSwitchGameData = [];\r\n\t\tlet switchGameData = cc.sys.localStorage.getItem(\"switchGameData\");\r\n\t\tif (switchGameData != \"\") {\r\n\t\t\tallSwitchGameData.push(JSON.parse(switchGameData));\r\n\t\t}\r\n\t\tfor (let i = 0; i < allSwitchGameData.length; i++) {\r\n\t\t\tif (!allSwitchGameData[i]) return;\r\n\t\t\tconsole.log(\"allSwitchGameData[i].action\");\r\n\t\t\tlet action = allSwitchGameData[i].action;\r\n\t\t\tswitch (action) {\r\n\t\t\t\tcase 'showForm':\r\n\t\t\t\t\tthis.FormManager.ShowForm(allSwitchGameData[i].fromName);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tdefault:\r\n\t\t\t\t\tconsole.log('未知动作: ' + action);\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\t\tcc.sys.localStorage.setItem(\"switchGameData\", \"\");\r\n\t},\r\n\r\n\tEvent_GetCurRoomID: function (event) {\r\n\t\tlet serverPack = event;\r\n\t\tthis.curRoomID = serverPack.roomID;\r\n\t\tif (0 != this.curRoomID) {\r\n\t\t\tthis.curGameTypeStr = serverPack.gameType.toLowerCase();\r\n\t\t}\r\n\t},\r\n\tEvent_CodeError: function (event) {\r\n\t\tlet codeInfo = event;\r\n\t\tif (codeInfo[\"Code\"] == this.ShareDefine.NotFind_Room) {\r\n\t\t\tapp[app.subGameName + \"_SysNotifyManager\"]().ShowSysMsg('DissolveRoom');\r\n\t\t\tthis.curRoomID = 0;\r\n\t\t\tthis.curGameTypeStr = '';\r\n\t\t}\r\n\t},\r\n\tOnClose: function () {\r\n\t},\r\n\t//---------点击函数---------------------\r\n\tInitGameBtnList: function (serverPack) {\r\n\t\tthis.FormManager.ShowForm(\"UICreatRoom\", serverPack, app.subGameName);\r\n\t},\r\n\tSetWaitForConfirm: function (msgID, type, msgArg = [], cbArg = []) {\r\n\t\tlet ConfirmManager = app[app.subGameName + \"_ConfirmManager\"]();\r\n\t\tConfirmManager.SetWaitForConfirmForm(this.OnConFirm.bind(this), msgID, cbArg);\r\n\t\tConfirmManager.ShowConfirm(type, msgID, msgArg);\r\n\t},\r\n\tOnConFirm: function (clickType, msgID, backArgList) {\r\n\t\tif (clickType != \"Sure\") {\r\n\t\t\treturn\r\n\t\t}\r\n\t\tif ('MSG_GO_ROOM' == msgID) {\r\n\t\t\tthis.Click_btn_goRoom();\r\n\t\t}\r\n\t\telse if ('MSG_CLUB_RoomCard_Not_Enough' == msgID) {\r\n\t\t\tlet clubId = backArgList[0];\r\n\t\t\tfor (let i = 0; i < this.clubCardNtfs.length; i++) {\r\n\t\t\t\tif (this.clubCardNtfs[i].clubId == clubId) {\r\n\t\t\t\t\tthis.clubCardNtfs.splice(i, 1);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (0 != this.clubCardNtfs.length) {\r\n\t\t\t\tlet data = this.clubCardNtfs[0];\r\n\t\t\t\tsetTimeout(function () {\r\n\t\t\t\t\tapp[app.subGameName + \"_SysNotifyManager\"]().ShowSysMsg('MSG_CLUB_RoomCard_Not_Enough', [data.clubName, data.roomcardattention]);\r\n\t\t\t\t}, 200);\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\tOnClick: function (btnName, btnNode) {\r\n\t\tif ('btn_create' == btnName) {\r\n\t\t\tif (0 != this.curRoomID) {\r\n\t\t\t\tthis.SetWaitForConfirm('MSG_GO_ROOM', this.ShareDefine.Confirm, [this.curGameTypeStr]);\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tthis.FormManager.ShowForm(app.subGameName + \"_UICreatRoom\", null, app.subGameName);\r\n\t\t} else if ('btn_lxc' == btnName) {\r\n\t\t\tif (0 != this.curRoomID) {\r\n\t\t\t\tthis.SetWaitForConfirm('MSG_GO_ROOM', this.ShareDefine.Confirm, [this.curGameTypeStr]);\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tthis.FormManager.ShowForm(app.subGameName + \"_UIPractice\");\r\n\t\t}\r\n\t\telse if ('btn_join' == btnName) {\r\n\t\t\tif (0 != this.curRoomID) {\r\n\t\t\t\tthis.SetWaitForConfirm('MSG_GO_ROOM', this.ShareDefine.Confirm, [this.curGameTypeStr]);\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tthis.FormManager.ShowForm(app.subGameName + \"_UIJoin\");\r\n\t\t}\r\n\t\telse if ('btn_exit' == btnName) {\r\n\t\t\tif (!cc.sys.isNative) return;\r\n\t\t\t//如果是游戏切换需要释放内存，重新加载\r\n\t\t\tapp[app.subGameName + \"Client\"].RemoveClientManager();\r\n\t\t\tapp[app.subGameName + \"_NetManager\"]().SendPack(\"base.C1110UUID\", {\"gameName\": \"hall\"}, function (event) {\r\n\t\t\t\tapp.LocalDataManager().SetConfigProperty(\"Account\", \"uuid\", event);\r\n\t\t\t\tlet gamePath = (jsb.fileUtils ? jsb.fileUtils.getWritablePath() : '/') + \"ALLGame/fjssz\";\r\n\t\t\t\twindow.require(gamePath + \"/src/dating.js\");\r\n\t\t\t}, function (error) {\r\n\t\t\t\tconsole.log(\"获取uuid失败\");\r\n\t\t\t});\r\n\t\t}\r\n\t\telse if ('btn_race' == btnName) {\r\n\t\t\tif (0 != this.curRoomID) {\r\n\t\t\t\tthis.SetWaitForConfirm('MSG_GO_ROOM', this.ShareDefine.Confirm, [this.curGameTypeStr]);\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tthis.FormManager.ShowForm(app.subGameName + \"_UICreatRoom\", null, app.subGameName);\r\n\t\t}\r\n\t\telse {\r\n\t\t\tconsole.error(\"OnClick(%s) not find\", btnName);\r\n\t\t}\r\n\r\n\t},\r\n\r\n\tClick_btn_goRoom: function () {\r\n\t\tapp[app.subGameName + \"Client\"].SetGameType(this.curGameTypeStr);\r\n\t\tlet event = {};\r\n\t\tevent = {};\r\n\t\tevent.roomID = this.curRoomID;\r\n\t\tapp[app.subGameName + \"Client\"].OnEvent_LoginGetCurRoomID(event);\r\n\t},\r\n});"]}