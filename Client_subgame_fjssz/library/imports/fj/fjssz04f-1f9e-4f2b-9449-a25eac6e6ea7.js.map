{"version":3,"sources":["..\\..\\..\\..\\..\\assets\\script\\ui/assets\\script\\ui\\fjssz_UILogin.js"],"names":["app","require","cc","Class","extends","subGameName","properties","OnCreateInit","gameName","EditBoxAccount","node","getChildByName","getComponent","EditBox","EditBoxPsw","HeroAccountManager","ShareDefine","RegEvent","Event_CodeError","Event_ConnectFail","isToken","event","argDict","code","KickOut_AccountTokenError","string","KickOut_ServerClose","WaitForConfirm","ConfirmYN","UpdateAccessPoint","ShowSysMsg","OnShow","ShowAccountInfo","accountList","GetLocalAccountList","count","length","account","token","GetAccountToken","OnClick","btnName","btnNode","Click_btnLogin","Click_btnReg","console","error","charAccount","psw","AccountLogin","OneKeyRegAccount","OnEditBoxBegin","sender","ChangeAccessPoint"],"mappings":"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","file":"fjssz_UILogin.js","sourceRoot":"..\\..\\..\\..\\..\\assets\\script\\ui","sourcesContent":["/*\r\n    UILogin 登陆界面\r\n*/\r\nvar app = require(\"fjssz_app\");\r\n\r\ncc.Class({\r\n\textends: require(app.subGameName + \"_BaseForm\"),\r\n\r\n\tproperties: {},\r\n\r\n\t//初始化\r\n\tOnCreateInit: function () {\r\n\t\tthis.gameName = app[\"subGameName\"];\r\n\r\n\t\tthis.EditBoxAccount = this.node.getChildByName(\"EditBoxAccount\").getComponent(cc.EditBox);\r\n\t\tthis.EditBoxPsw = this.node.getChildByName(\"EditBoxPsw\").getComponent(cc.EditBox);\r\n\t\tthis.HeroAccountManager = app[this.gameName + \"_HeroAccountManager\"]();\r\n\t\tthis.ShareDefine = app[this.gameName + \"_ShareDefine\"]();\r\n\r\n\t\tthis.RegEvent(\"CodeError\", this.Event_CodeError);\r\n\t\tthis.RegEvent(\"ConnectFail\", this.Event_ConnectFail);\r\n\r\n\t\tthis.isToken = 0;\r\n\t},\r\n\r\n\t//登录错误码\r\n\tEvent_CodeError: function (event) {\r\n\t\tlet argDict = event;\r\n\t\tlet code = argDict[\"Code\"];\r\n\t\tif (code == this.ShareDefine.KickOut_AccountTokenError) {\r\n\t\t\tthis.EditBoxPsw.string = \"\";\r\n\t\t}\r\n\t\telse if (code == this.ShareDefine.KickOut_ServerClose) {\r\n\t\t\tthis.WaitForConfirm(\"Code_10016\", [], [], this.ShareDefine.ConfirmYN)\r\n\t\t}\r\n\t},\r\n\r\n\t//连接服务器失败\r\n\tEvent_ConnectFail: function (event) {\r\n\t\tthis.UpdateAccessPoint();\r\n\t\tlet argDict = event;\r\n\t\tif (!argDict['bCloseByLogout'])\r\n\t\t\tthis.ShowSysMsg(\"Net_ConnectFail\");\r\n\t},\r\n\r\n\t//--------------------显示函数----------------\r\n\r\n\tOnShow: function () {\r\n\r\n\t\tthis.ShowAccountInfo();\r\n\t},\r\n\r\n\t//显示账号信息\r\n\tShowAccountInfo: function () {\r\n\t\tlet accountList = this.HeroAccountManager.GetLocalAccountList();\r\n\t\tlet count = accountList.length;\r\n\r\n\t\tlet account = \"\";\r\n\t\tlet token = \"\";\r\n\r\n\t\tif (count) {\r\n\t\t\taccount = accountList[count - 1];\r\n\t\t\ttoken = this.HeroAccountManager.GetAccountToken(account);\r\n\t\t\tthis.isToken = 1;\r\n\t\t}\r\n\r\n\t\tthis.EditBoxAccount.string = account;\r\n\t\tthis.EditBoxPsw.string = token;\r\n\r\n\t},\r\n\r\n\t//---------点击函数---------------------\r\n\r\n\tOnClick: function (btnName, btnNode) {\r\n\r\n\t\tif (btnName == \"btnLogin\") {\r\n\t\t\tthis.Click_btnLogin();\r\n\t\t}\r\n\t\telse if (btnName == \"btnReg\") {\r\n\t\t\tthis.Click_btnReg();\r\n\t\t}\r\n\t\telse {\r\n\t\t\tconsole.error(\"OnClick:%s not find\", btnName);\r\n\t\t}\r\n\t},\r\n\r\n\t//点击登陆\r\n\tClick_btnLogin: function () {\r\n\t\tlet charAccount = this.EditBoxAccount.string;\r\n\t\tif (!charAccount) {\r\n\t\t\tthis.ShowSysMsg(\"AccountLogin_NotInputAccount\")\r\n\t\t\treturn\r\n\t\t}\r\n\t\tlet psw = this.EditBoxPsw.string;\r\n\t\tif (!psw) {\r\n\t\t\tthis.ShowSysMsg(\"AccountLogin_NotInputPsw\")\r\n\t\t\treturn\r\n\t\t}\r\n\r\n\t\t//如果密码等于token为token登录\r\n\t\tif (this.isToken) {\r\n\t\t\tpsw = this.HeroAccountManager.GetAccountToken(charAccount);\r\n\t\t}\r\n\r\n\t\t//账号密码登陆\r\n\t\tthis.HeroAccountManager.AccountLogin(charAccount, psw, this.isToken);\r\n\r\n\t},\r\n\r\n\t//点击注册\r\n\tClick_btnReg: function () {\r\n\t\tthis.HeroAccountManager.OneKeyRegAccount();\r\n\t},\r\n\r\n\tOnEditBoxBegin: function (sender) {\r\n\r\n\t\t//如果点击了密码输入,则清除token标示\r\n\t\tif (sender == this.EditBoxPsw) {\r\n\t\t\tthis.isToken = 0;\r\n\t\t\tsender.string = \"\";\r\n\t\t}\r\n\t},\r\n\tUpdateAccessPoint: function () {\r\n\t\tthis.HeroAccountManager.ChangeAccessPoint();\r\n\t},\r\n});\r\n"]}