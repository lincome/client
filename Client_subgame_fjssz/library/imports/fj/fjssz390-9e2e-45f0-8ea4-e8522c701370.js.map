{"version":3,"sources":["..\\..\\..\\..\\..\\assets\\script\\ui/assets\\script\\ui\\fjssz_UIUserInfo.js"],"names":["app","require","cc","Class","extends","subGameName","properties","sp_boy","SpriteFrame","sp_girl","itemPrefab","Prefab","OnCreateInit","ZorderLv","sp_ip","node","getChildByName","sp_gps","sp_head","getComponent","Sprite","sp_female","label_name","GetWndNode","Label","label_id","label_ip","label_gps","itemsNode","btnCopyNode","editBox","EditBox","ReqIP","pos","RegEvent","OnEvt_ShowInfoDistance","OnEvt_CopyTextNtf","Gifts","GetTableDict","giftCfg","key","itemNode","instantiate","name","on","OnGiftClick","addChild","imgPath","ImageName","iconPath","SetWndImageByFilePath","EditBoxChangeCB","EditBoxEndCB","string","OnShow","active","ShowHero_NameOrID","RoomMgr","toUpperCase","room","GetEnterRoom","roomPosMgr","GetRoomPosMgr","ShowPlayerInfo","playerInfo","GetPlayerInfoByPos","ShowPlayerAddress","pid","ShowSex","SetGiftBtnInteractable","ScaleIn","that","sendPack","SendPack","success","detail","locationInfo","address","Address","updateTime","now","Math","floor","Date","getTime","error","SendHttpRequest","serverUrl","argString","requestType","url","join","dataStr","JSON","stringify","httpRequest","XMLHttpRequest","timeout","open","setRequestHeader","onerror","ErrLog","OnConnectHttpFail","readyState","status","ontimeout","onreadystatechange","OnReceiveHttpPack","responseText","send","httpResText","serverPack","parse","myip","bEnable","items","children","i","length","btn","Button","interactable","allPlayerInfo","GetRoomAllPlayerInfo","GetRoomProperty","ComTool","GetPid","SetShowIDNode","WeChatHeadImage1","ShowHeroHead","HeroManager","unionId","GetRoomConfigByProperty","log","GetHeroID","sportsPoint","event","distance","parseInt","toString","GetClientPos","heroName","GetHeroProperty","heroID","sex","GetAccountProperty","HeroSex_Boy","spriteFrame","itemName","target","data","roomID","productId","substr","CloseForm","sys","isNative","code","ShowSysMsg","msg","OnClick","btnName","btnNode","str","argList","CallToNative"],"mappings":"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","file":"fjssz_UIUserInfo.js","sourceRoot":"..\\..\\..\\..\\..\\assets\\script\\ui","sourcesContent":["var app = require(\"fjssz_app\");\r\ncc.Class({\r\n    extends: require(app.subGameName + \"_BaseForm\"),\r\n\r\n    properties: {\r\n\t    sp_boy:cc.SpriteFrame,\r\n\t    sp_girl:cc.SpriteFrame,\r\n\t    itemPrefab:cc.Prefab,\r\n    },\r\n\r\n    OnCreateInit: function () {\r\n\t    this.ZorderLv = 7;\r\n\t    this.sp_ip = this.node.getChildByName(\"sp_ip\");\r\n\t    this.sp_gps = this.node.getChildByName(\"sp_gps\");\r\n\t    this.sp_head = this.node.getChildByName(\"sprite_head\").getComponent(cc.Sprite);\r\n\t    this.sp_female = this.node.getChildByName(\"sp_female\").getComponent(cc.Sprite);\r\n\t    this.label_name = this.GetWndNode(\"sp_female/label_name\").getComponent(cc.Label);\r\n\t    this.label_id = this.GetWndNode(\"sp_id/label_ID\").getComponent(cc.Label);\r\n\t    this.label_ip = this.GetWndNode(\"sp_ip/label_IP\").getComponent(cc.Label);\r\n\t    this.label_gps = this.GetWndNode(\"sp_gps/lb_gps\").getComponent(cc.Label);\r\n\t    this.itemsNode = this.GetWndNode(\"ScrollView/items\");\r\n\t    this.btnCopyNode = this.GetWndNode(\"sp_id/btn_copy\");\r\n\t    this.editBox = this.GetWndNode(\"sp_id/editBox\").getComponent(cc.EditBox);\r\n\r\n        this.ReqIP();\r\n        this.pos=-1;\r\n        this.RegEvent(\"SHOWINFODISTANCE\", this.OnEvt_ShowInfoDistance);\r\n        this.RegEvent(\"OnCopyTextNtf\", this.OnEvt_CopyTextNtf);\r\n        \r\n        let Gifts = app[app.subGameName + \"_SysDataManager\"]().GetTableDict(\"Gift\");\r\n        this.giftCfg = [];\r\n        for(let key in Gifts){\r\n            let itemNode = cc.instantiate(this.itemPrefab);\r\n            itemNode.name = 'item' + key;\r\n            itemNode.on('click',this.OnGiftClick,this);\r\n\r\n            this.itemsNode.addChild(itemNode);\r\n            let imgPath = 'texture/ui/' +app.subGameName +  '_UIUserInfo/' + Gifts[key].ImageName;\r\n            let iconPath = 'ScrollView/items/' + itemNode.name + '/item_icon'\r\n            this.SetWndImageByFilePath(iconPath,imgPath);\r\n        }\r\n        this.editBox.node.on('editing-did-ended',this.EditBoxChangeCB,this);\r\n    },\r\n    EditBoxEndCB:function(){\r\n        this.editBox.string = this.label_id.string;\r\n    },\r\n    OnShow: function (pos=-1) {\r\n//        app.LocationMgr().setType(\"userinfo\");\r\n        this.pos = pos;\r\n        if(pos<0){\r\n            this.sp_gps.active = false;\r\n            this.itemsNode.active = false;\r\n            this.ShowHero_NameOrID();\r\n        }else{\r\n            this.RoomMgr = app[app.subGameName.toUpperCase() + \"RoomMgr\"]();\r\n            let room = this.RoomMgr.GetEnterRoom();\r\n            let roomPosMgr = room.GetRoomPosMgr();\r\n            this.sp_gps.active = true;\r\n            this.itemsNode.active = true;\r\n            this.ShowPlayerInfo(room);\r\n            let playerInfo=roomPosMgr.GetPlayerInfoByPos(this.pos);\r\n            if(playerInfo){\r\n                this.ShowPlayerAddress(playerInfo.pid);\r\n            }\r\n        }\r\n        this.ShowSex();\r\n        this.SetGiftBtnInteractable(this.sp_gps.active);\r\n        this.ScaleIn(this.node)\r\n    },\r\n    ShowPlayerAddress:function(pid){\r\n        if(pid>0){\r\n            let that=this;\r\n            let sendPack={\"pid\":pid};\r\n            app[app.subGameName + \"_NetManager\"]().SendPack(\"game.CPlayerLocationInfo\",sendPack,function(success){\r\n                let detail=success.locationInfo;\r\n                let address=detail.Address;\r\n                let updateTime=detail.updateTime;\r\n                let now=Math.floor(new Date().getTime()/1000);\r\n                if(now-updateTime>10800){\r\n                    //3小时内的定位有效\r\n                    that.label_gps.string =\"未知地址\";\r\n                    return;\r\n                }\r\n                if(address){\r\n                    that.label_gps.string =\"地址:\"+address;\r\n                }else{\r\n                    that.label_gps.string =\"未知地址\";\r\n                }\r\n                \r\n            },function(error){\r\n                //全部定位获取失败\r\n                that.label_gps.string =\"未知地址\";\r\n            });\r\n        }else{\r\n            this.label_gps.string =\"未知地址\";\r\n        }\r\n        //显示用户ip\r\n       this.SendHttpRequest('http://www.qp355.com/myip.php', \"?Sign=ddcat\", \"GET\",{});\r\n    },\r\n    SendHttpRequest:function(serverUrl, argString, requestType, sendPack){\r\n\r\n        var url = [serverUrl, argString].join(\"\")\r\n\r\n        var dataStr = JSON.stringify(sendPack);\r\n\r\n        //每次都实例化一个，否则会引起请求结束，实例被释放了\r\n        var httpRequest = new XMLHttpRequest();\r\n\r\n        httpRequest.timeout = 2000;\r\n\r\n\r\n        httpRequest.open(requestType, url, true);\r\n        //服务器json解码\r\n        httpRequest.setRequestHeader(\"Content-Type\", \"application/json\");\r\n        var that = this;\r\n        httpRequest.onerror = function(){\r\n            that.ErrLog(\"httpRequest.error:%s\", url);\r\n            that.OnConnectHttpFail(serverUrl, httpRequest.readyState, httpRequest.status);\r\n        };\r\n        httpRequest.ontimeout = function(){\r\n            \r\n        };\r\n        httpRequest.onreadystatechange = function(){\r\n\r\n            //执行成功\r\n            if (httpRequest.status == 200){\r\n                if(httpRequest.readyState == 4){\r\n                    that.OnReceiveHttpPack(serverUrl, httpRequest.responseText);\r\n                }\r\n            }\r\n            else{\r\n                that.OnConnectHttpFail(serverUrl, httpRequest.readyState, httpRequest.status);\r\n                that.ErrLog(\"onreadystatechange(%s,%s)\", httpRequest.readyState, httpRequest.status);\r\n            }\r\n        };\r\n        httpRequest.send(dataStr);\r\n\r\n    },\r\n    OnReceiveHttpPack:function(serverUrl, httpResText){\r\n        try{\r\n            let serverPack = JSON.parse(httpResText);\r\n            if(serverPack[\"IsSuccess\"] == 1){\r\n                this.sp_ip.getChildByName('label_IP').getComponent(cc.Label).string=serverPack.myip;\r\n            }\r\n            else{\r\n               this.sp_ip.getChildByName('label_IP').getComponent(cc.Label).string='未知ip';\r\n            }\r\n        }\r\n        catch (error){\r\n            this.sp_ip.getChildByName('label_IP').getComponent(cc.Label).string='未知ip';\r\n        }\r\n    },\r\n    OnConnectHttpFail:function(serverUrl, readyState, status){\r\n       this.sp_ip.getChildByName('label_IP').getComponent(cc.Label).string='未知ip';\r\n    },\r\n    SetGiftBtnInteractable:function(bEnable){\r\n        let items = this.itemsNode.children;\r\n        for(let i=0;i<items.length;i++){\r\n            let btn = items[i].getComponent(cc.Button);\r\n            if(btn)\r\n                btn.interactable = bEnable;\r\n        }\r\n    },\r\n    ShowPlayerInfo:function(room){\r\n        let roomPosMgr = room.GetRoomPosMgr();\r\n        let allPlayerInfo = null;\r\n        if(roomPosMgr)\r\n            allPlayerInfo = roomPosMgr.GetRoomAllPlayerInfo();\r\n        else\r\n            allPlayerInfo = room.GetRoomProperty('posList');\r\n        let playerInfo = allPlayerInfo[this.pos];\r\n        this.label_name.string = playerInfo[\"name\"];\r\n        this.label_id.string = this.ComTool.GetPid(playerInfo[\"pid\"]);\r\n        this.editBox.string = this.label_id.string;\r\n        this.SetShowIDNode();\r\n        // if(playerInfo[\"playerIP\"]==undefined){\r\n        //     this.label_ip.string=\"ip获取失败\"\r\n        // }else{\r\n        //     this.label_ip.string = playerInfo[\"playerIP\"];  \r\n        // }\r\n        //this.label_gps.string = \"您距\"+ this.label_name.string +\"的距离：未知距离\";\r\n        let WeChatHeadImage1 = this.sp_head.getComponent(app.subGameName + \"_WeChatHeadImage\");\r\n        WeChatHeadImage1.ShowHeroHead(playerInfo[\"pid\"]);\r\n        this.HeroManager = app[app.subGameName + \"_HeroManager\"]();\r\n        this.unionId = this.RoomMgr.GetEnterRoom().GetRoomConfigByProperty(\"unionId\");\r\n        cc.log(playerInfo,this.HeroManager.GetHeroID())\r\n        if (playerInfo[\"pid\"] == this.HeroManager.GetHeroID() && this.unionId > 0) {\r\n            this.node.getChildByName(\"lb_bsf\").getComponent(cc.Label).string = \"比赛分:\" + playerInfo.sportsPoint\r\n        }\r\n        else{\r\n            this.node.getChildByName(\"lb_bsf\").getComponent(cc.Label).string = \"\"\r\n        }\r\n        //app.LocationMgr().OnGetLocation();\r\n\r\n    },\r\n    //显示距离\r\n    OnEvt_ShowInfoDistance:function(event){\r\n        let room = this.RoomMgr.GetEnterRoom();\r\n        let roomPosMgr = room.GetRoomPosMgr();\r\n        let distance = parseInt(event[\"distance\"].toString());\r\n        if(event[\"pos1\"]==roomPosMgr.GetClientPos()&&event[\"pos2\"]==this.pos){\r\n            this.label_gps.string = \"您距\"+ this.label_name.string +\"的距离：\"+ distance +\"米\";\r\n        }else if(event[\"pos2\"]==roomPosMgr.GetClientPos()&&event[\"pos1\"]==this.pos){\r\n            this.label_gps.string = \"您距\"+ this.label_name.string +\"的距离：\"+ distance +\"米\";\r\n        }\r\n    },\r\n    ReqIP:function(){\r\n        app[app.subGameName + \"_NetManager\"]().SendPack('game.CPlayerAddress', {});\r\n    },\r\n  \r\n    ShowHero_NameOrID:function () {\r\n        let heroName = app[app.subGameName + \"_HeroManager\"]().GetHeroProperty(\"name\");\r\n        this.label_name.string =heroName;\r\n        let heroID = app[app.subGameName + \"_HeroManager\"]().GetHeroProperty(\"pid\");\r\n        this.label_id.string =this.ComTool.GetPid(heroID);// app.i18n.t(\"UIMain_PIDText\",{\"pid\":this.ComTool.GetPid(heroID)});\r\n        this.editBox.string = this.label_id.string;\r\n        let WeChatHeadImage1 = this.sp_head.getComponent(app.subGameName + \"_WeChatHeadImage\");\r\n        WeChatHeadImage1.ShowHeroHead(heroID);\r\n        this.SetShowIDNode();\r\n    },\r\n    ShowSex:function(){\r\n    \tlet sex = -1;\r\n        if(-1 == this.pos)\r\n            sex = app[app.subGameName + \"_HeroAccountManager\"]().GetAccountProperty(\"Sex\");\r\n        else{\r\n            let room = this.RoomMgr.GetEnterRoom();\r\n            sex = room.GetRoomProperty('posList')[this.pos].sex;\r\n        }\r\n    \tif (sex == app[app.subGameName + \"_ShareDefine\"]().HeroSex_Boy) {\r\n    \t\tthis.sp_female.spriteFrame = this.sp_boy;\r\n    \t} else {\r\n    \t\tthis.sp_female.spriteFrame = this.sp_girl;\r\n    \t}\r\n    },\r\n    OnGiftClick:function(event){\r\n        if(-1 == this.pos)\r\n            return;\r\n        if(!this.RoomMgr)\r\n            return;\r\n        let room = this.RoomMgr.GetEnterRoom();\r\n        if(!room)\r\n            return;\r\n\r\n        let itemName = event.target.name;\r\n        let data = {};\r\n        data.roomID = room.GetRoomProperty(\"roomID\");\r\n        data.pos = this.pos;\r\n        data.productId = parseInt(itemName.substr(('item').length));\r\n        app[app.subGameName + \"_NetManager\"]().SendPack(app.subGameName + \".C\" + app.subGameName.toUpperCase() + \"SendGift\", data);\r\n        this.CloseForm();\r\n    },\r\n    SetShowIDNode:function(){\r\n        if(cc.sys.isNative){\r\n            this.label_id.node.active = true;\r\n            this.editBox.node.active = false;\r\n            //this.btnCopyNode.active = true;\r\n        }\r\n        else{\r\n            this.label_id.node.active = false;\r\n            this.editBox.node.active = true;\r\n            this.btnCopyNode.active = false;\r\n        }\r\n    },\r\n    OnEvt_CopyTextNtf:function(event){\r\n        if(0 == event.code)\r\n            this.ShowSysMsg(\"已复制ID：\"+event.msg);\r\n        else\r\n            this.ShowSysMsg(\"复制失败\");\r\n    },\r\n    OnClick:function(btnName, btnNode){\r\n        if('btn_copy' == btnName){\r\n            let str = this.label_id.string;\r\n            if(cc.sys.isNative){\r\n                let argList = [{\"Name\":\"msg\",\"Value\":str.toString()}];\r\n                app[app.subGameName + \"_NativeManager\"]().CallToNative(\"copyText\", argList);\r\n            }\r\n            else{\r\n                \r\n            }\r\n        }\r\n    },\r\n});\r\n"]}