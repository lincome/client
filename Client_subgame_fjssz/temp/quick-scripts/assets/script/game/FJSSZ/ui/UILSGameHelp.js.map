{"version":3,"sources":["UILSGameHelp.js"],"names":["app","require","cc","Class","extends","subGameName","properties","content","Node","scroll_Right","ScrollView","OnCreateInit","curShowViewName","SysDataManager","allGameHelpConfig","GetTableDict","ConfigList","gameType","key","push","OnShow","ReShow","ShowGameRule","ruleStr","scrollToBottom","node","active","console","error","removeAllChildren","i","length","gameName","img","CreateImg","desc","reg","replace","fontSize","colorList","fontColor","split","id","color","CreateLabel","isTitle","UpdateContent","str","index","name","dataIndex","curLabel","addComponent","Label","horizontalAlign","HorizontalAlign","LEFT","overflow","Overflow","RESIZE_HEIGHT","cacheMode","CacheMode","CHAR","lineHeight","anchorX","x","width","enableWrapText","isSystemFontUsed","string","y","addChild","path","self","Sprite","CreateLoadPromise","SpriteFrame","then","spriteFrame","curSprite","getComponent","catch","destroy","stack","childs","children","needHeight","height","zIndex","sortAllChildren","sortChild","a","b"],"mappings":";;;;;;AAAA,IAAIA,MAAMC,QAAQ,WAAR,CAAV;AACAC,GAAGC,KAAH,CAAS;AACRC,UAASH,QAAQD,IAAIK,WAAJ,GAAkB,WAA1B,CADD;;AAGRC,aAAY;AACXC,WAASL,GAAGM,IADD;AAEXC,gBAAcP,GAAGQ;AAFN,EAHJ;AAORC,eAAc,wBAAY;AACzB,OAAKC,eAAL,GAAuB,EAAvB;AACA,OAAKC,cAAL,GAAsBb,IAAIA,IAAIK,WAAJ,GAAkB,iBAAtB,GAAtB;AACA,MAAIS,oBAAoB,KAAKD,cAAL,CAAoBE,YAApB,CAAiC,UAAjC,CAAxB;AACA,OAAKC,UAAL,GAAkB,EAAlB;AACA,OAAKC,QAAL,GAAgB,EAAhB;AACA,OAAK,IAAIC,GAAT,IAAgBJ,iBAAhB,EAAmC;AAClC,QAAKE,UAAL,CAAgBG,IAAhB,CAAqBL,kBAAkBI,GAAlB,CAArB;AACA;AACD,EAhBO;AAiBRE,SAAQ,kBAA8B;AAAA,MAApBH,QAAoB,uEAAT,OAAS;;AACrC,OAAKA,QAAL,GAAgBA,QAAhB;AACA,OAAKI,MAAL;AACA,EApBO;AAqBRA,SAAQ,kBAAY;AACnB,OAAKC,YAAL,CAAkB,KAAKL,QAAvB;AACA,EAvBO;AAwBRK,eAAc,sBAAUC,OAAV,EAAmB;AAChC,OAAKd,YAAL,CAAkBe,cAAlB;AACA,MAAID,WAAW,EAAf,EAAmB;AAClB,QAAKE,IAAL,CAAUC,MAAV,GAAmB,CAAnB;AACAC,WAAQC,KAAR,CAAc,aAAd;AACA;AACA;AACD,MAAI,KAAKhB,eAAL,IAAwBW,OAA5B,EAAqC;AACpC,QAAKd,YAAL,CAAkBe,cAAlB;AACA;AACA;AACD,OAAKjB,OAAL,CAAasB,iBAAb;AACA,OAAKjB,eAAL,GAAuBW,OAAvB;;AAEA,OAAK,IAAIO,IAAI,CAAb,EAAgBA,IAAI,KAAKd,UAAL,CAAgBe,MAApC,EAA4CD,GAA5C,EAAiD;AAChD,OAAI,KAAKd,UAAL,CAAgBc,CAAhB,EAAmBE,QAAnB,IAA+B,KAAKpB,eAAxC,EAAyD;AACxD,QAAI,KAAKI,UAAL,CAAgBc,CAAhB,EAAmBG,GAAnB,IAA0B,MAA9B,EAAsC;AACrC;AACA,UAAKC,SAAL,CAAe,KAAKlB,UAAL,CAAgBc,CAAhB,EAAmBG,GAAlC,EAAuCH,CAAvC;AACA,KAHD,MAIK;AACJ,SAAIK,OAAO,KAAKnB,UAAL,CAAgBc,CAAhB,EAAmBK,IAA9B;AACA,SAAIC,MAAM,MAAV;AACAD,YAAOA,KAAKE,OAAL,CAAaD,GAAb,EAAkB,IAAlB,CAAP;AACAA,WAAM,MAAN;AACAD,YAAOA,KAAKE,OAAL,CAAaD,GAAb,EAAkB,IAAlB,CAAP;AACA,SAAIE,WAAW,KAAKtB,UAAL,CAAgBc,CAAhB,EAAmBQ,QAAlC;AACA,SAAIC,YAAY,KAAKvB,UAAL,CAAgBc,CAAhB,EAAmBU,SAAnB,CAA6BC,KAA7B,CAAmC,GAAnC,CAAhB;AACA,SAAIF,UAAUR,MAAV,IAAoB,CAAxB,EAA2B;AAC1BJ,cAAQC,KAAR,CAAc,wCAAwC,KAAKZ,UAAL,CAAgBc,CAAhB,EAAmBY,EAAzE;AACA;AACA;AACD,SAAIC,QAAQ,IAAIzC,GAAGyC,KAAP,CAAaJ,UAAU,CAAV,CAAb,EAA2BA,UAAU,CAAV,CAA3B,EAAyCA,UAAU,CAAV,CAAzC,EAAuDA,UAAU,CAAV,CAAvD,CAAZ;AACA;AACA,UAAKK,WAAL,CAAiBT,IAAjB,EAAuBG,QAAvB,EAAiCK,KAAjC,EAAwC,KAAK3B,UAAL,CAAgBc,CAAhB,EAAmBe,OAA3D,EAAoEf,CAApE;AACA;AACD;AACD;AACD,OAAKgB,aAAL;AACA,OAAKrC,YAAL,CAAkBe,cAAlB;AACA,EAhEO;AAiERoB,cAAa,qBAAUG,GAAV,EAAeT,QAAf,EAAyBK,KAAzB,EAAgCE,OAAhC,EAAyCG,KAAzC,EAAgD;AAC5D,MAAIvB,OAAO,IAAIvB,GAAGM,IAAP,EAAX;AACAiB,OAAKwB,IAAL,GAAY,UAAUD,KAAtB;AACAvB,OAAKyB,SAAL,GAAiBF,KAAjB;AACA,MAAIG,WAAW1B,KAAK2B,YAAL,CAAkBlD,GAAGmD,KAArB,CAAf;AACAF,WAASb,QAAT,GAAoBA,QAApB;AACAa,WAASG,eAAT,GAA2BpD,GAAGmD,KAAH,CAASE,eAAT,CAAyBC,IAApD;AACAL,WAASM,QAAT,GAAoBvD,GAAGmD,KAAH,CAASK,QAAT,CAAkBC,aAAtC;AACAR,WAASS,SAAT,GAAqB1D,GAAGmD,KAAH,CAASQ,SAAT,CAAmBC,IAAxC;AACA,MAAIjB,OAAJ,EACCM,SAASY,UAAT,GAAsB,EAAtB,CADD,KAGCZ,SAASY,UAAT,GAAsB,EAAtB;AACDtC,OAAKuC,OAAL,GAAe,CAAf;AACAvC,OAAKwC,CAAL,GAAS,EAAE,KAAK1D,OAAL,CAAa2D,KAAb,GAAqB,CAAvB,CAAT;AACAzC,OAAKyC,KAAL,GAAa,KAAK3D,OAAL,CAAa2D,KAA1B;AACAf,WAASgB,cAAT,GAA0B,IAA1B;AACAhB,WAASiB,gBAAT,GAA4B,IAA5B;AACAjB,WAASkB,MAAT,GAAkBtB,GAAlB;AACAtB,OAAKkB,KAAL,GAAaA,KAAb;AACA;AACAlB,OAAK6C,CAAL,GAAS7C,KAAK6C,CAAL,GAAS,GAAlB;AACA,OAAK/D,OAAL,CAAagE,QAAb,CAAsB9C,IAAtB;AACA,EAxFO;AAyFRS,YAAW,mBAAUsC,IAAV,EAAgBxB,KAAhB,EAAuB;AACjC,MAAIyB,OAAO,IAAX;AACA,MAAIhD,OAAO,IAAIvB,GAAGM,IAAP,EAAX;AACAiB,OAAKwB,IAAL,GAAY,QAAQD,KAApB;AACAvB,OAAKyB,SAAL,GAAiBF,KAAjB;AACAvB,OAAK2B,YAAL,CAAkBlD,GAAGwE,MAArB;AACAjD,OAAKuC,OAAL,GAAe,CAAf;AACAvC,OAAKwC,CAAL,GAAS,EAAE,KAAK1D,OAAL,CAAa2D,KAAb,GAAqB,CAAvB,CAAT;AACAlE,MAAIA,IAAIK,WAAJ,GAAkB,iBAAtB,IAA2CsE,iBAA3C,CAA6DH,IAA7D,EAAmEtE,GAAG0E,WAAtE,EACEC,IADF,CACO,UAAUC,WAAV,EAAuB;AAC5B,OAAI,CAACA,WAAL,EAAkB;AACjBnD,YAAQC,KAAR,CAAc,8CAAd,EAA8D4C,IAA9D;AACA;AACA;AACD,OAAIO,YAAYtD,KAAKuD,YAAL,CAAkB9E,GAAGwE,MAArB,CAAhB;AACAK,aAAUD,WAAV,GAAwBA,WAAxB;AACAL,QAAKlE,OAAL,CAAagE,QAAb,CAAsB9C,IAAtB;AACAgD,QAAK3B,aAAL;AACA,GAVF,EAWEmC,KAXF,CAWQ,UAAUrD,KAAV,EAAiB;AACvBH,QAAKyD,OAAL;AACAvD,WAAQC,KAAR,CAAc,iCAAd,EAAiD4C,IAAjD,EAAuD5C,MAAMuD,KAA7D;AACA,GAdF;AAeA,EAhHO;AAiHRrC,gBAAe,yBAAY;AAC1B,MAAIsC,SAAS,KAAK7E,OAAL,CAAa8E,QAA1B;AACA,MAAI,KAAKD,OAAOrD,MAAhB,EAAwB;AACvB;AACA;AACD;AACA,MAAIuD,aAAa,CAAjB;AACA,OAAK,IAAIxD,IAAI,CAAb,EAAgBA,IAAIsD,OAAOrD,MAA3B,EAAmCD,GAAnC,EAAwC;AACvCwD,iBAAcF,OAAOtD,CAAP,EAAUyD,MAAxB;AACAH,UAAOtD,CAAP,EAAU0D,MAAV,GAAmBJ,OAAOtD,CAAP,EAAUoB,SAA7B;AACA;AACD,OAAK3C,OAAL,CAAagF,MAAb,GAAsBD,aAAa,EAAnC;AACA,OAAK/E,OAAL,CAAakF,eAAb;AACA,OAAKhF,YAAL,CAAkBe,cAAlB;AACA,EA/HO;AAgIRkE,YAAW,mBAAUC,CAAV,EAAaC,CAAb,EAAgB;AAC1B,SAAOD,EAAEzC,SAAF,GAAc0C,EAAE1C,SAAvB;AACA;AAlIO,CAAT","file":"UILSGameHelp.js","sourceRoot":"..\\..\\..\\..\\..\\..\\..\\assets\\script\\game\\FJSSZ\\ui","sourcesContent":["var app = require(\"fjssz_app\");\r\ncc.Class({\r\n\textends: require(app.subGameName + \"_BaseForm\"),\r\n\r\n\tproperties: {\r\n\t\tcontent: cc.Node,\r\n\t\tscroll_Right: cc.ScrollView,\r\n\t},\r\n\tOnCreateInit: function () {\r\n\t\tthis.curShowViewName = \"\";\r\n\t\tthis.SysDataManager = app[app.subGameName + \"_SysDataManager\"]();\r\n\t\tlet allGameHelpConfig = this.SysDataManager.GetTableDict(\"GameHelp\");\r\n\t\tthis.ConfigList = [];\r\n\t\tthis.gameType = '';\r\n\t\tfor (let key in allGameHelpConfig) {\r\n\t\t\tthis.ConfigList.push(allGameHelpConfig[key]);\r\n\t\t}\r\n\t},\r\n\tOnShow: function (gameType = 'fjssz') {\r\n\t\tthis.gameType = gameType;\r\n\t\tthis.ReShow();\r\n\t},\r\n\tReShow: function () {\r\n\t\tthis.ShowGameRule(this.gameType);\r\n\t},\r\n\tShowGameRule: function (ruleStr) {\r\n\t\tthis.scroll_Right.scrollToBottom();\r\n\t\tif (ruleStr == \"\") {\r\n\t\t\tthis.node.active = 0;\r\n\t\t\tconsole.error(\"没传帮助参数,无法读表\");\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif (this.curShowViewName == ruleStr) {\r\n\t\t\tthis.scroll_Right.scrollToBottom();\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tthis.content.removeAllChildren();\r\n\t\tthis.curShowViewName = ruleStr;\r\n\r\n\t\tfor (let i = 0; i < this.ConfigList.length; i++) {\r\n\t\t\tif (this.ConfigList[i].gameName == this.curShowViewName) {\r\n\t\t\t\tif (this.ConfigList[i].img != \"null\") {\r\n\t\t\t\t\t// if (this.ConfigList[i].img == \"null\") {\r\n\t\t\t\t\tthis.CreateImg(this.ConfigList[i].img, i);\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\tlet desc = this.ConfigList[i].desc;\r\n\t\t\t\t\tlet reg = /\\/n/g;\r\n\t\t\t\t\tdesc = desc.replace(reg, \"\\n\");\r\n\t\t\t\t\treg = /\\/t/g;\r\n\t\t\t\t\tdesc = desc.replace(reg, \"\\t\");\r\n\t\t\t\t\tlet fontSize = this.ConfigList[i].fontSize;\r\n\t\t\t\t\tlet colorList = this.ConfigList[i].fontColor.split(\",\");\r\n\t\t\t\t\tif (colorList.length != 4) {\r\n\t\t\t\t\t\tconsole.error(\"GameHelp Config color error id is :\" + this.ConfigList[i].id);\r\n\t\t\t\t\t\tcontinue;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tlet color = new cc.color(colorList[0], colorList[1], colorList[2], colorList[3]);\r\n\t\t\t\t\t// let color = new cc.Color(colorList[0], colorList[1], colorList[2]);\r\n\t\t\t\t\tthis.CreateLabel(desc, fontSize, color, this.ConfigList[i].isTitle, i);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tthis.UpdateContent();\r\n\t\tthis.scroll_Right.scrollToBottom();\r\n\t},\r\n\tCreateLabel: function (str, fontSize, color, isTitle, index) {\r\n\t\tlet node = new cc.Node();\r\n\t\tnode.name = \"label\" + index;\r\n\t\tnode.dataIndex = index;\r\n\t\tlet curLabel = node.addComponent(cc.Label);\r\n\t\tcurLabel.fontSize = fontSize;\r\n\t\tcurLabel.horizontalAlign = cc.Label.HorizontalAlign.LEFT;\r\n\t\tcurLabel.overflow = cc.Label.Overflow.RESIZE_HEIGHT;\r\n\t\tcurLabel.cacheMode = cc.Label.CacheMode.CHAR;\r\n\t\tif (isTitle)\r\n\t\t\tcurLabel.lineHeight = 60;\r\n\t\telse\r\n\t\t\tcurLabel.lineHeight = 40;\r\n\t\tnode.anchorX = 0;\r\n\t\tnode.x = -(this.content.width / 2);\r\n\t\tnode.width = this.content.width;\r\n\t\tcurLabel.enableWrapText = true;\r\n\t\tcurLabel.isSystemFontUsed = true;\r\n\t\tcurLabel.string = str;\r\n\t\tnode.color = color;\r\n\t\t// node.color = cc.color(114, 20, 15, 255);\r\n\t\tnode.y = node.y - 200;\r\n\t\tthis.content.addChild(node);\r\n\t},\r\n\tCreateImg: function (path, index) {\r\n\t\tlet self = this;\r\n\t\tlet node = new cc.Node();\r\n\t\tnode.name = \"img\" + index;\r\n\t\tnode.dataIndex = index;\r\n\t\tnode.addComponent(cc.Sprite);\r\n\t\tnode.anchorX = 0;\r\n\t\tnode.x = -(this.content.width / 2);\r\n\t\tapp[app.subGameName + \"_ControlManager\"]().CreateLoadPromise(path, cc.SpriteFrame)\r\n\t\t\t.then(function (spriteFrame) {\r\n\t\t\t\tif (!spriteFrame) {\r\n\t\t\t\t\tconsole.error(\"gameHelp CreateImg(%s) load spriteFrame fail\", path);\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tlet curSprite = node.getComponent(cc.Sprite);\r\n\t\t\t\tcurSprite.spriteFrame = spriteFrame;\r\n\t\t\t\tself.content.addChild(node);\r\n\t\t\t\tself.UpdateContent();\r\n\t\t\t})\r\n\t\t\t.catch(function (error) {\r\n\t\t\t\tnode.destroy();\r\n\t\t\t\tconsole.error(\"gameHelp CreateImg(%s) error:%s\", path, error.stack);\r\n\t\t\t})\r\n\t},\r\n\tUpdateContent: function () {\r\n\t\tlet childs = this.content.children;\r\n\t\tif (0 == childs.length) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\t//childs.sort(this.sortChild);//creator自己排序不会去刷新ui得设置下zIndex在sortAllChildren\r\n\t\tlet needHeight = 0;\r\n\t\tfor (let i = 0; i < childs.length; i++) {\r\n\t\t\tneedHeight += childs[i].height;\r\n\t\t\tchilds[i].zIndex = childs[i].dataIndex;\r\n\t\t}\r\n\t\tthis.content.height = needHeight + 50;\r\n\t\tthis.content.sortAllChildren();\r\n\t\tthis.scroll_Right.scrollToBottom();\r\n\t},\r\n\tsortChild: function (a, b) {\r\n\t\treturn a.dataIndex > b.dataIndex;\r\n\t}\r\n});"]}