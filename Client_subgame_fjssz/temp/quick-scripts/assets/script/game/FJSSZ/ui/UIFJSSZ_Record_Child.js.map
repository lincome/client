{"version":3,"sources":["UIFJSSZ_Record_Child.js"],"names":["app","require","cc","Class","extends","subGameName","properties","jushu","Label","btn_down","Node","cardPrefab","Prefab","cardNode","icon_mapai","SpriteFrame","OnLoad","PokerCard","SSSRoomMgr","toUpperCase","LogicGame","redColor","Color","greenColor","showInfo","string","itmeId","toString","playerResults","data","posResultList","idx","length","child","node","getChildByName","getComponent","shui","color","setItemData","eval","dataJsonRes","sort","sortFunByPos","rankeds","a","b","posIdx","hiedeAllPlayer","i","find","active","callBackDown","event","scaleY","height","dunPos","special","specialNode","imagePath","that","loader","loadRes","error","spriteFrame","ErrLog","Sprite","zjid","pid","beishu","allCards","pokers","first","concat","second","third","tonghuas","SanTongHua","j","push","children","name","card","instantiate","addChild","ShowCard","cardType","newPoker","SubCardValue","GetPokeCard","room","GetEnterRoom","removeFromParent","maPaiValue","GetRoomSet","GetRoomSetProperty","icon","sp","addComponent"],"mappings":"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","file":"UIFJSSZ_Record_Child.js","sourceRoot":"..\\..\\..\\..\\..\\..\\..\\assets\\script\\game\\FJSSZ\\ui","sourcesContent":["var app = require(\"fjssz_app\");\ncc.Class({\n    extends: require(app.subGameName + \"_BaseComponent\"),\n\n    properties: {\n        jushu: cc.Label,\n        btn_down:cc.Node,\n        cardPrefab:cc.Prefab,\n        cardNode:cc.Node,\n        icon_mapai:cc.SpriteFrame,\n    },\n\n    OnLoad:function() {\n        this.PokerCard = app[app.subGameName + \"_PokerCard\"]();\n        this.SSSRoomMgr = app[app.subGameName.toUpperCase() + \"RoomMgr\"]();\n        this.LogicGame = app[app.subGameName.toUpperCase() + \"LogicGame\"]();\n\n        this.redColor = new cc.Color(181,104,48);\n        this.greenColor = new cc.Color(59,138,133);\n    },\n\n    //显示\n    showInfo:function() {\n        this.jushu.string = (this.itmeId + 1).toString();\n\n        let playerResults = this.data.posResultList;\n\n        for(let idx = 0; idx < playerResults.length; idx++){\n            let child = this.node.getChildByName(\"lb_chengji0\" + (idx+1).toString());\n            child.getComponent(cc.Label).string = playerResults[idx].shui;\n            if (playerResults[idx].shui < 0 && child) {\n                child.color = this.greenColor;\n            }\n            else if(playerResults[idx].shui >= 0 && child){\n                child.color = this.redColor;\n            }\n        }\n    },\n\n    setItemData:function(idx,data){\n        this.itmeId = idx;\n        this.data = eval('(' + data.dataJsonRes + ')');\n        this.data.posResultList.sort(this.sortFunByPos);\n        this.data.rankeds.sort(this.sortFunByPos);\n        this.showInfo();\n    },\n\n    sortFunByPos:function(a,b){\n        return a.posIdx - b.posIdx;\n    },\n\n    hiedeAllPlayer:function(){\n        for(let i = 0; i < 8; i++){\n            let node = cc.find(\"cardNode/\" + \"player\" + (i+1).toString(),this.node);\n            node.active = false;\n        }\n    },\n\n    callBackDown:function(event){\n        if(this.btn_down.scaleY == -1){\n            this.btn_down.scaleY = 1;\n            this.node.height -= this.cardNode.height;\n            this.cardNode.active = false;\n        }\n        else{\n            this.btn_down.scaleY = -1;\n            this.node.height += this.cardNode.height;\n            this.cardNode.active = true;\n            let rankeds = this.data.rankeds;\n            //如果玩家查看牌型 显示牌型 否则不显示\n            this.hiedeAllPlayer();\n            for(let i = 0; i < rankeds.length; i++){\n                let node = cc.find(\"cardNode/\" + \"player\" + (i+1).toString(),this.node);\n                node.active = true;\n                let dunPos = rankeds[i].dunPos;\n                let special = rankeds[i].special;\n                if(special != -1){\n                    //显示特殊牌型\n                    let specialNode = node.getChildByName('special_card');\n                    specialNode.active = true;\n                    let imagePath = \"texture/game/sss/special/special_\" + special;\n                    //加载图片精灵\n                    let that = this;\n                    cc.loader.loadRes(imagePath, cc.SpriteFrame, function (error, spriteFrame) {\n                        if(error){\n                            that.ErrLog(\"ShowMap imagePath(%s) loader error:%s\", imagePath, error);\n                            return\n                        }\n                        specialNode.getComponent(cc.Sprite).spriteFrame = spriteFrame;\n                    });\n                }\n                if(this.data.zjid == rankeds[i].pid){\n                    node.getChildByName('zhuangjia').active = true;\n                    if(this.data.beishu != 0){\n                        node.getChildByName('beishu').active = true;\n                        node.getChildByName('beishu').getComponent(cc.Label).string = 'x'+this.data.beishu;\n                    }\n                }\n\n                let allCards = [];\n                if(special == 85 || special == 95){\n                    let pokers = dunPos.first.concat(dunPos.second,dunPos.third);\n                    let tonghuas = this.LogicGame.SanTongHua(pokers);\n                    for(let i = 0; i < tonghuas.length; i++){\n                        for(let j = 0; j < tonghuas[i].length; j++){\n                            allCards.push(tonghuas[i][j]);\n                        }\n                    }\n                }\n                else{\n                    allCards = dunPos.first.concat(dunPos.second,dunPos.third);\n                }\n                for(let j = 0; j < node.children.length; j++){\n                    let child = node.children[j];\n                    if(child.name == 'zhuangjia' ||\n                        child.name == 'beishu' ||\n                        child.name == 'special_card'){\n                        continue;\n                    } \n                    if(!child.getChildByName(\"cardPrefab\")){\n                        let card = cc.instantiate(this.cardPrefab);\n                        child.addChild(card);\n                        this.ShowCard(allCards[j], card);\n                    }\n                    else{\n                        let card = child.getChildByName(\"cardPrefab\");\n                        this.ShowCard(allCards[j], card);\n                    }\n                }\n            }\n        }\n    },\n    ShowCard:function(cardType, node){\n        let newPoker = this.PokerCard.SubCardValue(cardType);\n        this.PokerCard.GetPokeCard(newPoker, node);\n        \n        node.getChildByName(\"poker_back\").active = false;\n\n        let room = this.SSSRoomMgr.GetEnterRoom();\n        if(!room)  return;\n\n        let child = node.getChildByName(\"icon_mapai\");\n        if(child){\n            child.removeFromParent();\n        }\n        let maPaiValue = room.GetRoomSet().GetRoomSetProperty(\"mapai\");\n        if(newPoker == maPaiValue){\n            let icon = new cc.Node();\n            icon.name = \"icon_mapai\";\n            let sp = icon.addComponent(cc.Sprite);\n            sp.spriteFrame = this.icon_mapai;\n            node.addChild(icon);\n        }\n    },\n    \n});\n\n"]}