{"version":3,"sources":["fjssz_GameManager.js"],"names":["app","require","sss_GameManager","BaseClass","extend","Init","JS_Name","subGameName","NetManager","ShareDefine","RegNetPack","toUpperCase","OnPack_EnterRoom","OnPack_AutoStart","OnPack_PlayerAddress","OnPack_PosContinueGame","OnPack_DissolveRoom","OnPack_StartVoteDissolve","OnPack_ChangePlayerNum","OnPack_ChangePlayerNumAgree","OnPack_ChangeRoomNum","OnPack_PosReadyChg","OnPack_PosLeave","OnPack_PosUpdate","OnPack_LostConnect","OnPack_PosDealVote","OnPack_EveryGameRecord","OnPack_LoginGetCurRoomID","OnPack_XiPai","OnPack_Gitf","OnPack_MqResponseBo","OnPack_ContinueRoomInfo","bIsAutoPlayIng","bGetRoomIDByUI","xiPaiList","OnReload","serverPack","ShowForm","event","code","result","data","clientConfig","GameServerIP","gameTypeUrl","gameServerIP","GameServerPort","gameServerPort","isReconnecting","SendGetRoomInfo","roomID","OnBeforeExitScene","Disconnect","UpdateAccessPoint","Connect","SetGetRoomIDByUI","bGet","SendChat","type","quickID","content","SendPack","OnEvent","SetPlayGame","gameType","custom","NowRoom","pos","OnPosContinueGame","console","log","ownnerForce","createPos","endSec","dissolveInfo","OnStartVoteDissolve","playerNum","OnStartChangePlaeryDissolve","isReady","GetRoomPosMgr","OnPosReadyChg","room","ownerID","selfPos","GetClientPos","OnPosLeave","UpdateOwnerID","posInfo","OnPosUpdate","OnInitRoomPosData","SetRoomProperty","Log","isLostConnect","isShowLeave","pid","RoomPosMgr","roomPosMgrInfo","GetRoomAllPlayerInfo","roomPosMgrInfoKeyList","Object","keys","count","length","i","posID","player","SetPlayerOfflineState","agreeDissolve","OnPosDealVote","ChangePlayerNumAgree","SetGameType","nowroom","SetGameRecord","playerAll","playerAllList","playerInfo","push","name","GetHeroProperty","cType","GetXiPaiList","RemoveOneXiPaiPlayer","splice","SendEnterRoom","roomKey","IsFristPlay","RoomMgr","state","GetEnterRoom","GetRoomProperty","IsAutoPlayIng","SetAutoPlayIng","bValue","isAuto","heroID","CloseForm","isCoinRoom","GetSceneType","CancelAutoPlay","key","sendPack","trusteeship","SendAutoStart","SendGetCurRoomID","SendContinueGame","SendQiePai","SendBaiPai","success","SendDissolveRoom","SendDissolveRoomAgree","SendDissolveRoomRefuse","SendChangePlayerAgree","SendChangePlayerRefuse","SendExitRoom","SendReady","posIndex","SendUnReady","SendKickPosIndex","SendXiPai","g_sss_GameManager","exports","GetModel"],"mappings":"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","file":"fjssz_GameManager.js","sourceRoot":"..\\..\\..\\..\\..\\assets\\script\\common","sourcesContent":["/*\r\n GameManager 游戏管理\r\n */\r\nvar app = require(\"fjssz_app\");\r\n\r\nvar sss_GameManager = app.BaseClass.extend({\r\n\r\n\tInit: function () {\r\n\t\tthis.JS_Name = app.subGameName + \"_GameManager\";\r\n\r\n\t\tthis.NetManager = app[app.subGameName + \"_NetManager\"]();\r\n\t\tthis.ShareDefine = app[app.subGameName + \"_ShareDefine\"]();\r\n\r\n\r\n\t\tthis.NetManager.RegNetPack(app.subGameName + \".C\" + app.subGameName.toUpperCase() + \"EnterRoom\", this.OnPack_EnterRoom, this);\r\n\t\tthis.NetManager.RegNetPack(\"S\" + app.subGameName.toUpperCase() + \"_Trusteeship\", this.OnPack_AutoStart, this);\r\n\t\tthis.NetManager.RegNetPack(\"S\" + app.subGameName.toUpperCase() + \"_Address\", this.OnPack_PlayerAddress, this);\r\n\t\t//2017.8.8  消息抽出来走公共\r\n\t\t//继续游戏\r\n\t\tthis.NetManager.RegNetPack(\"S\" + app.subGameName.toUpperCase() + \"_PosContinueGame\", this.OnPack_PosContinueGame, this);\r\n\t\t//解散房间\r\n\t\tthis.NetManager.RegNetPack(\"S\" + app.subGameName.toUpperCase() + \"_Dissolve\", this.OnPack_DissolveRoom, this);\r\n\t\t//解散投票\r\n\t\tthis.NetManager.RegNetPack(\"S\" + app.subGameName.toUpperCase() + \"_StartVoteDissolve\", this.OnPack_StartVoteDissolve, this);\r\n\r\n\r\n\t\t//修改人数投票\r\n\t\tthis.NetManager.RegNetPack(\"S\" + app.subGameName.toUpperCase() + \"_ChangePlayerNum\", this.OnPack_ChangePlayerNum, this);\r\n\t\t//修改人数投票同意\r\n\t\tthis.NetManager.RegNetPack(\"S\" + app.subGameName.toUpperCase() + \"_ChangePlayerNumAgree\", this.OnPack_ChangePlayerNumAgree, this);\r\n\t\t//房间修改人数\r\n\t\tthis.NetManager.RegNetPack(\"S\" + app.subGameName.toUpperCase() + \"_ChangeRoomNum\", this.OnPack_ChangeRoomNum, this);\r\n\r\n\t\t//玩家准备\r\n\t\tthis.NetManager.RegNetPack(\"S\" + app.subGameName.toUpperCase() + \"_PosReadyChg\", this.OnPack_PosReadyChg, this);\r\n\t\t//玩家离开\r\n\t\tthis.NetManager.RegNetPack(\"S\" + app.subGameName.toUpperCase() + \"_PosLeave\", this.OnPack_PosLeave, this);\r\n\t\t//玩家位置更新\r\n\t\tthis.NetManager.RegNetPack(\"S\" + app.subGameName.toUpperCase() + \"_PosUpdate\", this.OnPack_PosUpdate, this);\r\n\t\t//玩家掉线\r\n\t\tthis.NetManager.RegNetPack(\"S\" + app.subGameName.toUpperCase() + \"_LostConnect\", this.OnPack_LostConnect, this);\r\n\r\n\t\tthis.NetManager.RegNetPack(\"S\" + app.subGameName.toUpperCase() + \"_PosDealVote\", this.OnPack_PosDealVote, this);\r\n\t\t//所有对局记录\r\n\t\tthis.NetManager.RegNetPack(\"game.CPlayerSetRoomRecord\", this.OnPack_EveryGameRecord, this);\r\n\r\n\t\tthis.NetManager.RegNetPack(\"game.C1101GetRoomID\", this.OnPack_LoginGetCurRoomID, this);\r\n\t\t//洗牌\r\n\t\tthis.NetManager.RegNetPack(\"S\" + app.subGameName.toUpperCase() + \"_XiPai\", this.OnPack_XiPai, this);\r\n\t\t//赠送礼物\r\n\t\tthis.NetManager.RegNetPack(\"S\" + app.subGameName.toUpperCase() + \"_SendGift\", this.OnPack_Gitf, this);\r\n\r\n\t\tthis.NetManager.RegNetPack(\"MqResponseBo\",this.OnPack_MqResponseBo,this);\r\n\r\n\t\tthis.NetManager.RegNetPack(\"SRoom_ContinueRoomInfo\",this.OnPack_ContinueRoomInfo,this);\r\n\r\n\t\tthis.bIsAutoPlayIng = false;\r\n\r\n\t\tthis.bGetRoomIDByUI = false;\r\n\t\tthis.xiPaiList = [];\r\n\t\tthis.OnReload();\r\n\t},\r\n\r\n\tOnPack_ContinueRoomInfo: function (serverPack) {\r\n\t\tapp[app.subGameName + \"_FormManager\"]().ShowForm(app.subGameName + '_UIMessageJoin', serverPack);\r\n\t},\r\n\r\n\r\n\tOnPack_MqResponseBo: function (event) {\r\n\t\tlet code = event.result.code;\r\n\t\tif (code == 0) {\r\n\t\t\tlet serverPack = event.result.data;\r\n\t\t\tapp[app.subGameName + \"Client\"].clientConfig.GameServerIP = serverPack.gameTypeUrl.gameServerIP;\r\n\t\t\tapp[app.subGameName + \"Client\"].clientConfig.GameServerPort = serverPack.gameTypeUrl.gameServerPort;\r\n\t\t\tapp[app.subGameName + \"_NetWork\"]().isReconnecting = true;  //标记为正在重新连接，让发送消息堆积多发送队列\r\n\t\t\tapp[app.subGameName.toUpperCase() + \"RoomMgr\"]().SendGetRoomInfo(serverPack.roomID); //加入获取消息到队列\r\n\t\t\t//关闭游戏的UI\r\n\t\t\tapp[app.subGameName + \"_FormManager\"]().OnBeforeExitScene();\r\n\t\t\t//关闭游戏的UI\r\n\t\t\tapp[app.subGameName + \"_NetWork\"]().Disconnect(true);\t\t\t//断开连接\r\n\t\t\tapp[app.subGameName + \"_NetWork\"]().UpdateAccessPoint();   //更新连接节点\r\n\t\t\tapp[app.subGameName + \"_NetWork\"]().Connect();\t\t\t//发起重新连接服务器\r\n\t\t}\r\n\t},\r\n\r\n\tSetGetRoomIDByUI: function (bGet) {\r\n\t\tthis.bGetRoomIDByUI = bGet;\r\n\t},\r\n\t//发送聊天封包\r\n\tSendChat: function (type, quickID, roomID, content) {\r\n\t\tthis.NetManager.SendPack(app.subGameName + \".C\" + app.subGameName.toUpperCase() + \"Chat\", {\r\n\t\t\t\"type\": type,\r\n\t\t\t\"quickID\": quickID,\r\n\t\t\t\"targetID\": roomID,\r\n\t\t\t\"content\": content\r\n\t\t});\r\n\t},\r\n\t//切换账号\r\n\tOnReload: function () {\r\n\t},\r\n\r\n\t//------------封包函数------------------\r\n\tOnPack_PlayerAddress: function (serverPack) {\r\n\t\tapp[app.subGameName + \"Client\"].OnEvent(\"EVT_PlayerAddress\", serverPack);\r\n\t},\r\n\r\n\tSetPlayGame: function (serverPack) {\r\n\t\tlet gameType = serverPack['gameType'];\r\n\t\tlet custom = serverPack['custom'];\r\n\t},\r\n\tNowRoom: function () {\r\n\t\treturn app[app.subGameName.toUpperCase() + \"Room\"]();\r\n\t},\r\n\t//位置继续游戏\r\n\tOnPack_PosContinueGame: function (serverPack) {\r\n\t\tlet roomID = serverPack[\"roomID\"];\r\n\t\tlet pos = serverPack[\"pos\"];\r\n\t\tthis.NowRoom().OnPosContinueGame(pos);\r\n\t\tapp[app.subGameName + \"Client\"].OnEvent(app.subGameName.toUpperCase() + \"_PosContinueGame\", serverPack);\r\n\t\t//公共头像触发\r\n\t\tapp[app.subGameName + \"Client\"].OnEvent(\"PosContine\", serverPack);\r\n\t},\r\n\t//解散房间\r\n\tOnPack_DissolveRoom: function (serverPack) {\r\n\t\tconsole.log(\"解散房间\", serverPack);\r\n\t\tlet roomID = serverPack[\"roomID\"];\r\n\t\tlet ownnerForce = serverPack[\"ownnerForce\"];\r\n\t\tapp[app.subGameName + \"Client\"].OnEvent(app.subGameName.toUpperCase() + \"_DissolveRoom\", serverPack);\r\n\t},\r\n\t//接收到解散请求\r\n\tOnPack_StartVoteDissolve: function (serverPack) {\r\n\t\tconsole.log(\"接收到解散请求\", serverPack);\r\n\t\tlet roomID = serverPack[\"roomID\"];\r\n\t\tlet createPos = serverPack[\"createPos\"];\r\n\t\tlet endSec = serverPack[\"endSec\"];\r\n\t\tlet dissolveInfo = this.NowRoom().OnStartVoteDissolve(createPos, endSec);\r\n\t\tapp[app.subGameName + \"Client\"].OnEvent(app.subGameName.toUpperCase() + \"_StartVoteDissolve\", dissolveInfo);\r\n\t},\r\n\t//接收人数修改请求\r\n\tOnPack_ChangePlayerNum: function (serverPack) {\r\n\t\tlet roomID = serverPack[\"roomID\"];\r\n\t\tlet createPos = serverPack[\"createPos\"];\r\n\t\tlet endSec = serverPack[\"endSec\"];\r\n\t\tlet playerNum = serverPack.playerNum;\r\n\t\tlet dissolveInfo = this.NowRoom().OnStartChangePlaeryDissolve(createPos, playerNum, endSec);\r\n\t\tapp[app.subGameName + \"Client\"].OnEvent(app.subGameName.toUpperCase() + \"_ChangePlayerNum\", dissolveInfo);\r\n\t},\r\n\r\n\r\n\t//位置是否准备\r\n\tOnPack_PosReadyChg: function (serverPack) {\r\n\t\tlet roomID = serverPack[\"roomID\"];\r\n\t\tlet pos = serverPack[\"pos\"];\r\n\t\tlet isReady = serverPack[\"isReady\"];\r\n\t\tif (this.NowRoom().GetRoomPosMgr().OnPosReadyChg(pos, isReady)) {\r\n\t\t\tapp[app.subGameName + \"Client\"].OnEvent(app.subGameName.toUpperCase() + \"_PosReadyChg\", serverPack);\r\n\t\t}\r\n\t\telse {\r\n\t\t\t// this.Log(\"OnPack_PosReadyChg:\", serverPack);\r\n\t\t}\r\n\t},\r\n\t//位置离开房间\r\n\tOnPack_PosLeave: function (serverPack) {\r\n\t\tlet roomID = serverPack[\"roomID\"];\r\n\t\tlet pos = serverPack[\"pos\"];\r\n\t\tlet room = this.NowRoom();\r\n\t\tlet ownerID = serverPack[\"ownerID\"];\r\n\t\tlet selfPos = -1;\r\n\t\tif (room) {\r\n\t\t\tselfPos = room.GetRoomPosMgr().GetClientPos();\r\n\t\t\troom.OnPosLeave(pos);\r\n\t\t\tif (ownerID > 0) {\r\n\t\t\t\troom.UpdateOwnerID(ownerID);\r\n\t\t\t}\r\n\t\t}\r\n\t\tapp[app.subGameName + \"Client\"].OnEvent(app.subGameName.toUpperCase() + \"_PosLeave\", serverPack);\r\n\t\tif (pos == selfPos && !serverPack[\"beKick\"]) {\r\n\t\t\tapp[app.subGameName + \"Client\"].OnEvent(\"ExitRoomSuccess\", serverPack);\r\n\t\t}\r\n\t},\r\n\t//更新座位信息\r\n\tOnPack_PosUpdate: function (serverPack) {\r\n\t\tlet roomID = serverPack[\"roomID\"];\r\n\t\tlet pos = serverPack[\"pos\"];\r\n\t\tlet posInfo = serverPack[\"posInfo\"];\r\n\t\tthis.SetPlayGame(serverPack);\r\n\t\tif (this.NowRoom().GetRoomPosMgr().OnPosUpdate(pos, posInfo)) {\r\n\t\t\tthis.NowRoom().GetRoomPosMgr().OnInitRoomPosData(serverPack[\"posList\"]);\r\n\t\t\tthis.NowRoom().SetRoomProperty(\"posList\", serverPack[\"posList\"]);\r\n\t\t\tapp[app.subGameName + \"Client\"].OnEvent(app.subGameName.toUpperCase() + \"_PosUpdate\", serverPack);\r\n\t\t} else {\r\n\t\t\tthis.Log(\"OnPack_PosUpdate:\", serverPack);\r\n\t\t}\r\n\r\n\t},\r\n\t//有玩家掉线\r\n\tOnPack_LostConnect: function (serverPack) {\r\n\t\tlet isLostConnect = serverPack[\"isLostConnect\"];\r\n\t\tlet isShowLeave = serverPack[\"isShowLeave\"];\r\n\t\tlet pid = serverPack[\"pid\"];\r\n\t\tlet RoomPosMgr = this.NowRoom().GetRoomPosMgr();\r\n\t\tlet roomPosMgrInfo = RoomPosMgr.GetRoomAllPlayerInfo();\r\n\t\tlet roomPosMgrInfoKeyList = Object.keys(roomPosMgrInfo);\r\n\t\tlet count = roomPosMgrInfoKeyList.length;\r\n\t\tfor (let i = 0; i < count; i++) {\r\n\t\t\tlet posID = roomPosMgrInfoKeyList[i];\r\n\t\t\tlet player = roomPosMgrInfo[posID];\r\n\t\t\tif (pid == player[\"pid\"]) {\r\n\t\t\t\tRoomPosMgr.SetPlayerOfflineState(posID, isLostConnect, isShowLeave);\r\n\t\t\t\tbreak\r\n\t\t\t}\r\n\t\t}\r\n\t\tapp[app.subGameName + \"Client\"].OnEvent(\"PlayerOffline\", serverPack);\r\n\t},\r\n\t//位置更新解散\r\n\tOnPack_PosDealVote: function (serverPack) {\r\n\t\tlet roomID = serverPack[\"roomID\"];\r\n\t\tlet pos = serverPack[\"pos\"];\r\n\t\tlet agreeDissolve = serverPack[\"agreeDissolve\"];\r\n\t\tlet dissolveInfo = this.NowRoom().OnPosDealVote(pos, agreeDissolve);\r\n\t\tapp[app.subGameName + \"Client\"].OnEvent(\"PosDealVote\", dissolveInfo);\r\n\t},\r\n\r\n\r\n\t//位置更新解散\r\n\tOnPack_ChangePlayerNumAgree: function (serverPack) {\r\n\t\tlet roomID = serverPack[\"roomID\"];\r\n\t\tlet pos = serverPack[\"pos\"];\r\n\t\tlet agreeDissolve = serverPack[\"agreeChange\"];\r\n\t\tlet dissolveInfo = this.NowRoom().ChangePlayerNumAgree(pos, agreeDissolve);\r\n\t\tapp[app.subGameName + \"Client\"].OnEvent(\"PosChangePlayerDealVote\", dissolveInfo);\r\n\t},\r\n\r\n\tOnPack_ChangeRoomNum: function (serverPack) {\r\n\t\tthis.OnPack_EnterRoom(serverPack);\r\n\t},\r\n\r\n\t//房间key查找完成\r\n\tOnPack_EnterRoom: function (serverPack) {\r\n\t\tlet roomID = serverPack.roomID;\r\n\t\tapp[app.subGameName + \"Client\"].SetGameType(app.subGameName);\r\n\t\tapp[app.subGameName.toUpperCase() + \"RoomMgr\"]().SendGetRoomInfo(roomID);\r\n\t},\r\n\t//获取所有对局记录\r\n\tOnPack_EveryGameRecord: function (serverPack) {\r\n\t\tlet nowroom = this.NowRoom();\r\n\t\tif (nowroom) {\r\n\t\t\tnowroom.SetGameRecord(true);\r\n\t\t}\r\n\t\tapp[app.subGameName + \"Client\"].OnEvent(\"GameRecord\", serverPack);\r\n\t},\r\n\tOnPack_LoginGetCurRoomID: function (serverPack) {\r\n\t\tif (!this.bGetRoomIDByUI)\r\n\t\t\tapp[app.subGameName + \"Client\"].OnEvent(\"LoginGetCurRoomID\", serverPack);\r\n\t\telse\r\n\t\t\tapp[app.subGameName + \"Client\"].OnEvent(\"GetCurRoomID\", serverPack);\r\n\r\n\t\tthis.bGetRoomIDByUI = false;\r\n\t},\r\n\t//洗牌\r\n\tOnPack_XiPai: function (serverPack) {\r\n\t\tlet nowroom = this.NowRoom();\r\n\t\tlet playerAll = nowroom.GetRoomPosMgr().GetRoomAllPlayerInfo();\r\n\t\tlet playerAllList = Object.keys(playerAll);\r\n\t\tvar playerInfo = null;\r\n\t\tfor (var i = 0; i < playerAllList.length; i++) {\r\n\t\t\tplayerInfo = playerAll[playerAllList[i]];\r\n\t\t\tif (playerInfo.pid == serverPack.pid) {\r\n\t\t\t\tthis.xiPaiList.push(playerInfo.name);\r\n\t\t\t\t// app[app.subGameName + \"_SysNotifyManager\"]().ShowSysMsg('SSS_XIPAI_SUCCESS',[playerInfo.name]);\r\n\t\t\t\tif (app[app.subGameName + \"_HeroManager\"]().GetHeroProperty(\"pid\") == serverPack.pid) {\r\n\t\t\t\t\tapp[app.subGameName + \"Client\"].OnEvent(\"Event_XiPai\", serverPack);\r\n\t\t\t\t}\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\t\tlet cType = serverPack.cType;\r\n\t\tif ('PK' == cType) {\r\n\t\t\tapp[app.subGameName + \"_FormManager\"]().ShowForm('game/SSS/sss_UIXiPai');\r\n\t\t}\r\n\t\telse {\r\n\t\t\tapp[app.subGameName + \"_FormManager\"]().ShowForm('game/base/ui/majiang/UIMJXiPai');\r\n\t\t}\r\n\t},\r\n\tOnPack_Gitf: function (serverPack) {\r\n\t\tapp[app.subGameName + \"Client\"].OnEvent(\"GameGift\", serverPack);\r\n\t},\r\n\t//--------------获取接口------------------------\r\n\tGetXiPaiList: function () {\r\n\t\treturn this.xiPaiList;\r\n\t},\r\n\tRemoveOneXiPaiPlayer: function () {\r\n\t\tif (0 == this.xiPaiList.length)\r\n\t\t\treturn;\r\n\t\tthis.xiPaiList.splice(0, 1);\r\n\t},\r\n\t//---------------发包接口------------------------\r\n\t//进入房间\r\n\tSendEnterRoom: function (roomKey) {\r\n\t\tthis.NetManager.SendPack(app.subGameName + \".C\" + app.subGameName.toUpperCase() + \"EnterRoom\", {\r\n\t\t\t\"roomKey\": roomKey,\r\n\t\t\t\"posID\": -1\r\n\t\t});\r\n\t},\r\n\tIsFristPlay: function () {\r\n\t\tlet RoomMgr = app[app.subGameName.toUpperCase() + \"RoomMgr\"]();\r\n\t\tlet state = RoomMgr.GetEnterRoom().GetRoomProperty(\"state\");\r\n\t\treturn state != 0 ? true : false;\r\n\t},\r\n\r\n\tIsAutoPlayIng: function () {\r\n\t\treturn this.bIsAutoPlayIng;\r\n\t},\r\n\tSetAutoPlayIng: function (bValue) {\r\n\t\tthis.bIsAutoPlayIng = bValue;\r\n\t},\r\n\tOnPack_AutoStart: function (serverPack) {\r\n\t\tconsole.log(\"自动托管\", serverPack);\r\n\t\tapp[app.subGameName + \"Client\"].OnEvent('SPlayer_Trusteeship', serverPack);\r\n\t\tlet roomID = serverPack[\"roomID\"];\r\n\t\tlet pos = serverPack[\"pos\"];\r\n\t\tlet isAuto = serverPack[\"trusteeship\"];\r\n\t\tlet pid = serverPack[\"pid\"];\r\n\t\tlet heroID = app[app.subGameName + \"_HeroManager\"]().GetHeroProperty(\"pid\");\r\n\r\n\t\tlet RoomMgr = app[app.subGameName.toUpperCase() + \"RoomMgr\"]();\r\n\t\tlet RoomPosMgr = RoomMgr.GetEnterRoom().GetRoomPosMgr();\r\n\t\tif (pos == RoomPosMgr.GetClientPos() && heroID == pid) {\r\n\t\t\tif (!isAuto) {\r\n\t\t\t\tthis.bIsAutoPlayIng = false;\r\n\t\t\t\tapp[app.subGameName + \"_FormManager\"]().CloseForm(app.subGameName + \"_UIAutoPlay\");\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tif (this.ShareDefine.isCoinRoom && app[app.subGameName + \"_SceneManager\"]().GetSceneType() == app.subGameName + \"MainScene\") {\r\n\t\t\t\t\tapp[app.subGameName + \"_FormManager\"]().CloseForm(app.subGameName + \"_UIAutoPlay\");\r\n\t\t\t\t\tthis.bIsAutoPlayIng = false;\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\tthis.bIsAutoPlayIng = true;\r\n\t\t\t\t\tapp[app.subGameName + \"_FormManager\"]().ShowForm(app.subGameName + \"_UIAutoPlay\");\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\tCancelAutoPlay: function () {\r\n\t\tthis.bIsAutoPlayIng = false;\r\n\t\tlet RoomMgr = app[app.subGameName.toUpperCase() + \"RoomMgr\"]();\r\n\t\tlet room = RoomMgr.GetEnterRoom();\r\n\t\tlet roomID = room.GetRoomProperty(\"roomID\");\r\n\t\tlet key = room.GetRoomProperty(\"key\");\r\n\t\tlet heroID = app[app.subGameName + \"_HeroManager\"]().GetHeroProperty(\"pid\");\r\n\t\tlet sendPack = {\r\n\t\t\troomID: roomID,\r\n\t\t\ttrusteeship: false,\r\n\t\t\tkey: key,\r\n\t\t\tpid: heroID\r\n\t\t}\r\n\t\tapp[app.subGameName + \"_NetManager\"]().SendPack(app.subGameName + \".C\" + app.subGameName.toUpperCase() + \"Trusteeship\", sendPack);\r\n\t},\r\n\tSendAutoStart: function () {\r\n\t\tthis.bIsAutoPlayIng = true;\r\n\t\tlet RoomMgr = app[app.subGameName.toUpperCase() + \"RoomMgr\"]();\r\n\t\tlet room = RoomMgr.GetEnterRoom();\r\n\t\tlet roomID = room.GetRoomProperty(\"roomID\");\r\n\t\tlet key = room.GetRoomProperty(\"key\");\r\n\t\tlet heroID = app[app.subGameName + \"_HeroManager\"]().GetHeroProperty(\"pid\");\r\n\t\tlet sendPack = {\r\n\t\t\troomID: roomID,\r\n\t\t\ttrusteeship: true,\r\n\t\t\tkey: key,\r\n\t\t\tpid: heroID\r\n\t\t};\r\n\t\tapp[app.subGameName + \"_NetManager\"]().SendPack(app.subGameName + \".C\" + app.subGameName.toUpperCase() + \"Trusteeship\", sendPack);\r\n\t},\r\n\r\n\t//游戏公用消息\r\n\t//登录获取当前进入的房间ID\r\n\tSendGetCurRoomID: function () {\r\n\t\tthis.NetManager.SendPack(\"game.C1101GetRoomID\", {});\r\n\t},\r\n\t//发送继续游戏\r\n\tSendContinueGame: function (roomID) {\r\n\t\tthis.NetManager.SendPack(app.subGameName + \".C\" + app.subGameName.toUpperCase() + \"ContinueGame\", {\"roomID\": roomID});\r\n\t},\r\n\t//发送切牌\r\n\tSendQiePai: function (roomID) {\r\n\t\tthis.NetManager.SendPack(app.subGameName + \".C\" + app.subGameName.toUpperCase() + \"QiePai\", {\"roomID\": roomID});\r\n\t},\r\n\t//发送摆牌\r\n\tSendBaiPai: function (roomID,success) {\r\n\t\tthis.NetManager.SendPack(app.subGameName + \".C\" + app.subGameName.toUpperCase() + \"BaiPai\", {\"roomID\": roomID}, success);\r\n\t},\r\n\t//解散房间\r\n\tSendDissolveRoom: function (roomID) {\r\n\t\tthis.NetManager.SendPack(app.subGameName + \".C\" + app.subGameName.toUpperCase() + \"DissolveRoom\", {\"roomID\": roomID});\r\n\t},\r\n\t//发送同意解散房间\r\n\tSendDissolveRoomAgree: function (roomID) {\r\n\t\tthis.NetManager.SendPack(app.subGameName + \".C\" + app.subGameName.toUpperCase() + \"DissolveRoomAgree\", {\"roomID\": roomID});\r\n\t},\r\n\r\n\t//发送拒绝解散房间\r\n\tSendDissolveRoomRefuse: function (roomID) {\r\n\t\tthis.NetManager.SendPack(app.subGameName + \".C\" + app.subGameName.toUpperCase() + \"DissolveRoomRefuse\", {\"roomID\": roomID});\r\n\t},\r\n\r\n\r\n\t//发送同意修改人数\r\n\tSendChangePlayerAgree: function (roomID) {\r\n\t\tthis.NetManager.SendPack(app.subGameName + \".C\" + app.subGameName.toUpperCase() + \"ChangePlayerNumAgree\", {\r\n\t\t\t\"roomID\": roomID,\r\n\t\t\t\"agree\": 1\r\n\t\t});\r\n\t},\r\n\r\n\t//发送拒绝修改人数\r\n\tSendChangePlayerRefuse: function (roomID) {\r\n\t\tthis.NetManager.SendPack(app.subGameName + \".C\" + app.subGameName.toUpperCase() + \"ChangePlayerNumAgree\", {\r\n\t\t\t\"roomID\": roomID,\r\n\t\t\t\"agree\": 2\r\n\t\t});\r\n\t},\r\n\r\n\r\n\t//退出房间\r\n\tSendExitRoom: function (roomID, pos) {\r\n\t\tthis.NetManager.SendPack(app.subGameName + \".C\" + app.subGameName.toUpperCase() + \"ExitRoom\", {\r\n\t\t\t\"roomID\": roomID,\r\n\t\t\t\"posIndex\": pos\r\n\t\t});\r\n\t},\r\n\t//位置发送准备状态\r\n\tSendReady: function (roomID, posIndex) {\r\n\t\tthis.NetManager.SendPack(app.subGameName + \".C\" + app.subGameName.toUpperCase() + \"ReadyRoom\", {\r\n\t\t\t\"roomID\": roomID,\r\n\t\t\t\"posIndex\": posIndex\r\n\t\t});\r\n\t},\r\n\r\n\t//发送取消准备状态\r\n\tSendUnReady: function (roomID, posIndex) {\r\n\t\tthis.NetManager.SendPack(app.subGameName + \".C\" + app.subGameName.toUpperCase() + \"UnReadyRoom\", {\r\n\t\t\t\"roomID\": roomID,\r\n\t\t\t\"posIndex\": posIndex\r\n\t\t});\r\n\t},\r\n\r\n\t//房主T人\r\n\tSendKickPosIndex: function (roomID, posIndex) {\r\n\t\tthis.NetManager.SendPack(app.subGameName + \".C\" + app.subGameName.toUpperCase() + \"KickRoom\", {\r\n\t\t\t\"roomID\": roomID,\r\n\t\t\t\"posIndex\": posIndex\r\n\t\t});\r\n\t},\r\n\r\n\t//洗牌\r\n\tSendXiPai: function (roomID) {\r\n\t\tthis.NetManager.SendPack(app.subGameName + \".C\" + app.subGameName.toUpperCase() + \"RoomXiPai\", {\"roomID\": roomID});\r\n\t},\r\n});\r\n\r\n\r\nvar g_sss_GameManager = null;\r\n\r\n/**\r\n * 绑定模块外部方法\r\n */\r\nexports.GetModel = function () {\r\n\tif (!g_sss_GameManager) {\r\n\t\tg_sss_GameManager = new sss_GameManager();\r\n\t}\r\n\treturn g_sss_GameManager;\r\n}"]}