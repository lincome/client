{"version":3,"sources":["fjssz_HeroManager.js"],"names":["app","require","sss_HeroManager","BaseClass","extend","Init","JS_Name","subGameName","NetManager","ShareDefine","ComTool","RegNetPack","OnPack_HeroProperty","OnReload","dataInfo","heroID","InitLoginData","heroInfo","cc","sys","isNative","LocalDataManager","SetConfigProperty","OnEvent","serverPack","count","length","index","property","SetHeroProperty","value","hasOwnProperty","console","error","argDict","GetHeroID","GetHeroInfo","GetHeroProperty","g_sss_HeroManager","exports","GetModel"],"mappings":"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","file":"fjssz_HeroManager.js","sourceRoot":"..\\..\\..\\..\\..\\assets\\script\\common","sourcesContent":["/*\r\n    玩家个人数据管理器\r\n*/\r\nvar app = require(\"fjssz_app\");\r\n\r\nvar sss_HeroManager = app.BaseClass.extend({\r\n\r\n    Init:function(){\r\n    \tthis.JS_Name = app.subGameName + \"_HeroManager\";\r\n\r\n        this.NetManager = app[app.subGameName+\"_NetManager\"]();\r\n        this.ShareDefine = app[app.subGameName+\"_ShareDefine\"]();\r\n        this.ComTool = app[app.subGameName+\"_ComTool\"]();\r\n\r\n        this.NetManager.RegNetPack(\"playerchanged\", this.OnPack_HeroProperty, this);\r\n\r\n        this.OnReload();\r\n\r\n    \t// this.Log(\"Init\");\r\n    },\r\n\r\n    //切换账号\r\n    OnReload:function(){\r\n        this.dataInfo = {};\r\n        this.heroID = 0;\r\n    },\r\n\r\n\r\n    //登陆初始化数据\r\n    InitLoginData:function(heroID, heroInfo){\r\n        this.dataInfo = heroInfo;\r\n        this.heroID = heroID;\r\n        //记录用户活跃度\r\n        if(!cc.sys.isNative){\r\n            heroInfo['vipExp']=0;\r\n        }\r\n        app.LocalDataManager().SetConfigProperty(\"Account\", \"AccountActive\",heroInfo['vipExp']);\r\n        app[app.subGameName + \"Client\"].OnEvent(\"ReloadHeroData\",{});\r\n    },\r\n\r\n    //-------------------封包函数--------------------------\r\n    //属性变化\r\n    OnPack_HeroProperty:function(serverPack){\r\n\r\n\t    let count = serverPack.length;\r\n\t    for(let index=0; index<count; index++){\r\n\t\t    let dataInfo = serverPack[index];\r\n\t\t    let property = dataInfo[\"name\"];\r\n\t\t    this.SetHeroProperty(property, dataInfo[\"value\"]);\r\n\t    }\r\n    },\r\n\r\n    //----------------设置接口---------------------------\r\n    //设置英雄属性\r\n    SetHeroProperty:function(property, value){\r\n        if(!this.dataInfo.hasOwnProperty(property)){\r\n            console.error(\"SetHeroProperty(%s,%s) error\", property, value);\r\n            return false\r\n        }\r\n        this.dataInfo[property] = value;\r\n\r\n        let argDict = {\r\n            \"Property\":property,\r\n            \"Value\":value,\r\n        };\r\n        app[app.subGameName + \"Client\"].OnEvent(\"HeroProperty\", argDict);\r\n\r\n        return true\r\n    },\r\n\r\n    //----------------获取接口-----------------------------\r\n\r\n    //获取英雄ID\r\n    GetHeroID:function(){\r\n        return this.heroID;\r\n    },\r\n\r\n    GetHeroInfo:function(){\r\n        return this.dataInfo\r\n    },\r\n\r\n    //获取英雄属性值\r\n    GetHeroProperty:function(property){\r\n        if(!this.dataInfo.hasOwnProperty(property)){\r\n            console.error(\"GetHeroProperty(%s) error\", property);\r\n            return \r\n        }\r\n        return this.dataInfo[property];\r\n    },\r\n\r\n    //随机角色名\r\n    // GetRandHeroName:function(){\r\n    //     let familyKeyList = Object.keys(this.FamilyName);\r\n    //     let nameKeyList = Object.keys(this.Name);\r\n\r\n    //     let familyName = this.FamilyName[this.ComTool.ListChoice(familyKeyList)][\"FamilyName\"];\r\n    //     let name = this.Name[this.ComTool.ListChoice(nameKeyList)][\"Name\"];\r\n\r\n    //     return [familyName, name].join(\"\");\r\n    // },\r\n\r\n    //-------------发包接口------------------------\r\n});\r\n\r\n\r\nvar g_sss_HeroManager = null;\r\n\r\n/**\r\n * 绑定模块外部方法\r\n */\r\nexports.GetModel = function(){\r\n    if(!g_sss_HeroManager){\r\n        g_sss_HeroManager = new sss_HeroManager();\r\n    }\r\n    return g_sss_HeroManager;\r\n}"]}