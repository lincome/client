{"version":3,"sources":["pdk_UIMessage.js"],"names":["app","require","cc","Class","extends","subGameName","properties","LabelMessage","Label","LabelCancel","LabelSure","BtnCancel","Button","BtnSure","OnCreateInit","ShareDefine","msgInfoList","MaxMsgCount","confirmType","CancelPos","v2","SurePos","SingSurePos","SysNotifyManager","isShowingMsg","OnShow","eventType","msgID","msgArgList","content","length","ErrLog","push","ShowMsgInfo","node","setPosition","Log","tempList","shift","params","msgContent","string","Confirm","i18n","t","active","ConfirmYN","ConfirmBuyGoTo","ConfirmOK","OnClose","OnClick","btnName","eventData","AfterOnClick","CloseForm","ConfirmManager","OnConFirmResult"],"mappings":"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","file":"pdk_UIMessage.js","sourceRoot":"..\\..\\..\\..\\..\\assets\\script\\ui","sourcesContent":["/*\r\n    UIMessage 模态消息界面\r\n*/\r\n\r\nvar app = require(\"pdk_app\");\r\n\r\ncc.Class({\r\n    extends: require(app.subGameName + \"_BaseForm\"),\r\n\r\n    properties: {\r\n        LabelMessage:cc.Label,\r\n        LabelCancel:cc.Label,\r\n        LabelSure:cc.Label,\r\n        BtnCancel: cc.Button,\r\n        BtnSure:cc.Button,\r\n    },\r\n\r\n    //初始化\r\n    OnCreateInit:function(){\r\n        this.ShareDefine = app[app.subGameName + \"_ShareDefine\"]();\r\n        \r\n        this.msgInfoList = [];\r\n        this.MaxMsgCount = 1;\r\n\r\n        this.confirmType = 0;\r\n\r\n        this.CancelPos = cc.v2(-131,-130);\r\n        this.SurePos = cc.v2(131,-130);\r\n\r\n        //单个确定按钮坐标\r\n        this.SingSurePos = cc.v2(0, -130);\r\n\r\n        this.SysNotifyManager = app[app.subGameName + \"_SysNotifyManager\"]();\r\n\r\n        this.isShowingMsg = false;\r\n\r\n    },\r\n\r\n    //---------显示函数--------------------\r\n\r\n    OnShow:function(eventType, confirmType, msgID, msgArgList, content){\r\n\r\n\r\n        if(this.msgInfoList.length >= this.MaxMsgCount){\r\n            this.ErrLog(\"OnShow msgInfoListCount(%s) is max\", this.msgInfoList.length, msgID);\r\n        }\r\n        else{\r\n            this.msgInfoList.push([confirmType, msgID, msgArgList, content]);\r\n        }\r\n\r\n        //如果正在显示系统提示,则不调用更新接口\r\n        //if(!this.isShowingMsg){\r\n            this.ShowMsgInfo();\r\n        //}\r\n        this.node.setPosition(cc.v2(0,0));\r\n    },\r\n\r\n    ShowMsgInfo:function(){\r\n        if (!this.msgInfoList.length){\r\n            this.Log(\"msgInfoList is empty\");\r\n            return;\r\n        }\r\n\r\n        this.isShowingMsg = true;\r\n\r\n        let tempList = this.msgInfoList.shift();\r\n        this.confirmType = tempList[0];\r\n        let msgID = tempList[1];\r\n        let params = tempList[2];\r\n        let msgContent = tempList[3];\r\n\r\n\r\n        this.LabelMessage.string = msgContent;\r\n\r\n        //以下根据不同类型改变窗体、控件位置\r\n        //有确定、取消按钮\r\n        if(this.confirmType == this.ShareDefine.Confirm){\r\n\r\n\t        if(this.LabelCancel){\r\n\t\t        this.LabelCancel.string = app.i18n.t(\"Cancel\");\r\n\t        }\r\n            this.BtnCancel.node.setPosition(this.CancelPos);\r\n            this.BtnCancel.node.active = true;\r\n\r\n\t        if(this.LabelSure){\r\n\t\t        this.LabelSure.string = app.i18n.t(\"Sure\");\r\n\t        }\r\n            this.BtnSure.node.setPosition(this.SurePos);\r\n            this.BtnSure.node.active = true;\r\n\r\n        }\r\n        //有是、否按钮\r\n        else if(this.confirmType == this.ShareDefine.ConfirmYN){//有确定按钮\r\n\t        if(this.LabelCancel){\r\n\t\t        this.LabelCancel.string = app.i18n.t(\"No\");\r\n\t        }\r\n            this.BtnCancel.node.setPosition(this.CancelPos);\r\n            this.BtnCancel.node.active = true;\r\n\r\n\t        if(this.LabelSure){\r\n\t\t        this.LabelSure.string = app.i18n.t(\"Yes\");\r\n\t        }\r\n            this.BtnSure.node.setPosition(this.SurePos);\r\n            this.BtnSure.node.active = true;\r\n\r\n        }\r\n\r\n        //购买,前往\r\n        else if(this.confirmType == this.ShareDefine.ConfirmBuyGoTo){\r\n\t        if(this.LabelCancel){\r\n\t\t        this.LabelCancel.string = app.i18n.t(\"Buy\");\r\n\t        }\r\n            this.BtnCancel.node.setPosition(this.CancelPos);\r\n            this.BtnCancel.node.active = true;\r\n\r\n\t        if(this.LabelSure){\r\n\t\t        this.LabelSure.string = app.i18n.t(\"GoTo\");\r\n\t        }\r\n            this.BtnSure.node.setPosition(this.SurePos);\r\n            this.BtnSure.node.active = true;\r\n\r\n        }\r\n        //就一个确定, 需要设置控件坐标\r\n        else if(this.confirmType == this.ShareDefine.ConfirmOK){\r\n            this.BtnCancel.node.active = false;\r\n\t        if(this.LabelSure){\r\n\t\t        this.LabelSure.string = app.i18n.t(\"Sure\");\r\n\t        }\r\n            this.BtnSure.node.setPosition(this.SingSurePos);\r\n            this.BtnSure.node.active = true;\r\n\r\n        }\r\n\r\n        else{\r\n            this.isShowingMsg = false;\r\n            this.ErrLog(\"OnShow msgType(%s) error\", this.confirmType);\r\n            return;\r\n        }\r\n\r\n    },\r\n\r\n    OnClose:function(){\r\n        this.isShowingMsg = false;\r\n    },\r\n\r\n    //---------点击函数---------------------\r\n\r\n\tOnClick:function(btnName, eventData){\r\n\r\n\t\tif(btnName == \"btnSure\"){\r\n\t\t\tthis.AfterOnClick(\"Sure\");\r\n\t\t}\r\n\t\telse if(btnName == \"btnCancel\"){\r\n\t\t\tthis.AfterOnClick(\"Cancel\");\r\n\t\t}\r\n\t\telse{\r\n\t\t\tthis.ErrLog(\"OnClick:%s not find\", btnName);\r\n\t\t}\r\n\t},\r\n\r\n    /**\r\n     * 点击确定\r\n     */\r\n    AfterOnClick:function(eventType){\r\n\r\n        this.CloseForm();\r\n\r\n\t    this.ConfirmManager.OnConFirmResult(eventType);\r\n\r\n        // 如果还有消息则继续显示\r\n        if(this.msgInfoList.length){\r\n            this.ShowMsgInfo();\r\n        }\r\n    },\r\n\r\n});\r\n"]}