{"version":3,"sources":["LogicPDKRank.js"],"names":["app","require","LogicPDKRank","BaseClass","extend","Init","dunTypes","JS_Name","subGameName","toUpperCase","ComTool","ShareDefine","Define","HUA_LEN","RoomMgr","RoomPosMgr","RoomSet","NetManager","LogicPDKGame","SetPos","InitCount","lastShouCard","cardStateList","idx","length","state","Log","InitDunState","shouCardList","GetSetPosProperty","specialType","isSpecial","isSixteen","count","i","card","indexOf","roomID","GetEnterRoom","GetRoomProperty","SendGetRoomInfo","cc","log","GetIsSixteen","duiziCount","liangduiCount","santiaoCount","shunziCount","tonghuaCount","huluCount","zhadanCount","tonghuaShunCount","wutongCount","GetSpecialType","SetSpecialCard","GetDunLength","dun","getDunListByType","type","clearSelectedCards","OnEvent","SetCardSelected","cardIdx","cardType","pos","console","push","DeleteCardSelected","splice","CheckDaoShui","tempSelectCards","DaoShui","NotDaoShui","CheckCardBigOrSmall","AutoSetDun","downList","ShowSysMsg","ClearDun","SetDun","selectCardType","dunPos","downPos","pushDownCards","pokers","cardX16","trigger","ErrLog","ClearOneCard","CheckAllRanked","bAllRanked","CheckSelected","SendRankList","room","pid","GetHeroProperty","posIdx","GetClientPos","sendPack","first","second","third","SendPack","error","roomid","CheckDuiZi","duizis","GetDuiZi","duizi","CheckLiangDui","fristDui","scendDui","bRet","CheckSameValue","liangdui","concat","CheckSanTiao","santiaos","GetSanTiao","santiao","CheckShunzi","shunzis","GetShunzi","shunzi","CheckTonghua","tonghuas","GetTonghua","tonghua","CheckHulu","hulus","dui","j","san","hulu","CheckZhaDang","zhadangs","GetZhaDang","zhadan","CheckTongHuaShun","tonghuaShuns","GetTongHuaShunEx","tonghuashun","CheckWuTong","wutongs","GetWuTong","wutong","SetDunEx","catlist","g_LogicPDKRank","exports","GetModel"],"mappings":"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","file":"LogicPDKRank.js","sourceRoot":"..\\..\\..\\..\\..\\..\\..\\assets\\script\\game\\PDK\\GameLogic","sourcesContent":["var app = require(\"pdk_app\");\r\n\r\nvar LogicPDKRank = app.BaseClass.extend({\r\n\r\n  \r\n    Init:function(){\r\n        this.dunTypes = ['DOWN','SELECTED', 'DUN1', 'DUN2', 'DUN3']\r\n\r\n\r\n        this.JS_Name = \"Logic\"+app.subGameName.toUpperCase()+\"Rank\";\r\n\r\n        this.ComTool = app[app.subGameName + \"_ComTool\"]();\r\n        this.ShareDefine = app[app.subGameName + \"_ShareDefine\"]();\r\n        this.Define = app[app.subGameName.toUpperCase()+\"Define\"]();\r\n        this.HUA_LEN = 4;\r\n        this.RoomMgr = app[app.subGameName.toUpperCase()+\"RoomMgr\"]();\r\n        this.RoomPosMgr = app[app.subGameName.toUpperCase()+\"RoomPosMgr\"]();\r\n        this.RoomSet = app[app.subGameName.toUpperCase()+\"RoomSet\"]();\r\n        this.NetManager = app[app.subGameName + \"_NetManager\"]();\r\n        this.LogicPDKGame = app[\"Logic\"+app.subGameName.toUpperCase()+\"Game\"]();\r\n        this.SetPos = app[app.subGameName.toUpperCase()+\"SetPos\"]();\r\n\r\n        this.InitCount();\r\n        this.lastShouCard = [];\r\n\r\n        this.cardStateList = [];\r\n        for(let idx = 0; idx < this.dunTypes.length; idx++){\r\n            let state = this.dunTypes[idx];\r\n            this.cardStateList[state] = [];\r\n        }\r\n        this.Log(\"Init\");\r\n    },\r\n\r\n    InitDunState:function(){\r\n        let shouCardList = this.SetPos.GetSetPosProperty(\"shouCard\");\r\n        this.specialType = this.SetPos.GetSetPosProperty(\"special\");\r\n        this.isSpecial = false;\r\n\r\n        if(shouCardList.length > 13){\r\n            this.isSixteen = true;\r\n        }\r\n        else{\r\n            this.isSixteen = false;\r\n        }\r\n\r\n        //如果和上一把牌相同，重新获取getRoomInfo\r\n        if(this.lastShouCard.length){\r\n            let count = 0;\r\n            for(let i = 0; i < shouCardList.length; i++){\r\n                let card = shouCardList[i];\r\n                if(this.lastShouCard.indexOf(card) != -1){\r\n                    count++;\r\n                }\r\n            }\r\n            if(count == 13){\r\n                let roomID = this.RoomMgr.GetEnterRoom().GetRoomProperty(\"roomID\");\r\n                this.RoomMgr.SendGetRoomInfo(roomID);\r\n                this.lastShouCard = [];\r\n                return;\r\n            }\r\n        }\r\n        this.lastShouCard = shouCardList;\r\n\r\n        cc.log(\"LogicPDKRank 初始化\");\r\n        for(let idx = 0; idx < shouCardList.length; idx++){\r\n            this.cardStateList['DOWN'][idx] = shouCardList[idx];\r\n        }\r\n\r\n        this.cardStateList['DUN1'] = [];\r\n        this.cardStateList['DUN2'] = [];\r\n        this.cardStateList['DUN3'] = [];\r\n        this.cardStateList['SELECTED'] = [];\r\n\r\n        cc.log(\"LogicPDKRank 初始化完成\");\r\n\r\n        this.InitCount();\r\n    },\r\n\r\n    GetIsSixteen:function(){\r\n        return this.isSixteen;\r\n    },\r\n\r\n    InitCount:function(){\r\n        this.duiziCount = 0;\r\n        this.liangduiCount = 0;\r\n        this.santiaoCount = 0;\r\n        this.shunziCount = 0;\r\n        this.tonghuaCount = 0;\r\n        this.huluCount = 0;\r\n        this.zhadanCount = 0;\r\n        this.tonghuaCount = 0;\r\n        this.tonghuaShunCount = 0;\r\n        this.wutongCount = 0;\r\n    },\r\n\r\n    GetSpecialType:function() {\r\n        return this.specialType;\r\n    },\r\n\r\n    SetSpecialCard:function(){\r\n        this.isSpecial = true;\r\n    },\r\n\r\n    GetDunLength:function(dun){\r\n        return this.cardStateList[dun].length;\r\n    },\r\n\r\n    getDunListByType:function(type){\r\n        return this.cardStateList[type];\r\n    },\r\n\r\n    clearSelectedCards:function(){\r\n        if(this.cardStateList['SELECTED'].length){\r\n            this.cardStateList['SELECTED'] = [];\r\n            app[app.subGameName + \"Client\"].OnEvent(\"EVT_DUN_UPDATE\");\r\n        }\r\n    },\r\n\r\n    SetCardSelected:function(cardIdx){\r\n        //查询\r\n        let cardType = this.cardStateList[\"DOWN\"][cardIdx -1];\r\n        let pos = this.cardStateList['SELECTED'].indexOf(cardType)\r\n        if (pos){\r\n            console.log('CheckDuiZi this.cardStateList[SELECTED]', this.cardStateList['SELECTED']);  \r\n            this.cardStateList['SELECTED'].push(cardType);\r\n            app[app.subGameName + \"Client\"].OnEvent(\"EVT_DUN_UPDATE\");\r\n        }\r\n        else {\r\n            this.Log(\"can not find cardtype %d\", cardType);\r\n        }\r\n\r\n    },\r\n\r\n    DeleteCardSelected:function(cardIdx){\r\n\r\n        let cardType = this.cardStateList[\"DOWN\"][cardIdx -1];\r\n        let pos = this.cardStateList['SELECTED'].indexOf(cardType)\r\n        if (pos > -1){\r\n            this.cardStateList['SELECTED'].splice(pos, 1)\r\n            app[app.subGameName + \"Client\"].OnEvent(\"EVT_DUN_UPDATE\");\r\n        }\r\n    },\r\n\r\n    CheckDaoShui:function(dun){\r\n        var tempSelectCards = [];\r\n        let DaoShui = 0;//倒水\r\n        let NotDaoShui = 1;//没倒水\r\n        \r\n        for(var i=0;i<this.cardStateList[dun].length;i++)\r\n            tempSelectCards.push(this.cardStateList[dun][i]);\r\n\r\n        for(var i=0;i<this.cardStateList[\"SELECTED\"].length;i++){\r\n            tempSelectCards.push(this.cardStateList[\"SELECTED\"][i]);\r\n            if(dun == \"DUN1\" && i == 2)\r\n                break;\r\n            else if((dun == \"DUN2\" || dun == \"DUN3\") && i == 4)\r\n                break;\r\n        }\r\n\r\n        if(dun == \"DUN1\" && tempSelectCards.length != 3)\r\n            return NotDaoShui;\r\n        else if(dun == \"DUN1\" && tempSelectCards.length == 3){\r\n            if(this.cardStateList[\"DUN2\"].length != 5 && this.cardStateList[\"DUN3\"].length != 5)\r\n                return NotDaoShui;\r\n        }\r\n\r\n        if(dun == \"DUN2\" && tempSelectCards.length != 5)\r\n            return NotDaoShui;\r\n        else if(dun == \"DUN2\" && tempSelectCards.length == 5){\r\n            if(this.cardStateList[\"DUN3\"].length != 5 && this.cardStateList[\"DUN1\"].length != 3)\r\n                return NotDaoShui;\r\n        }\r\n\r\n        if(dun == \"DUN3\" && tempSelectCards.length != 5)\r\n            return NotDaoShui;\r\n\r\n        if (dun == \"DUN1\"){\r\n            if(this.cardStateList[\"DUN2\"].length == 0 && this.cardStateList[\"DUN3\"].length == 0)\r\n                return NotDaoShui;\r\n\r\n            if(this.cardStateList[\"DUN2\"].length != 0){\r\n                if(app[\"Logic\"+app.subGameName.toUpperCase()+\"Game\"]().CheckCardBigOrSmall(tempSelectCards,this.cardStateList[\"DUN2\"]) == 0)\r\n                    return DaoShui;\r\n            }\r\n            if(this.cardStateList[\"DUN3\"].length != 0){\r\n                if(app[\"Logic\"+app.subGameName.toUpperCase()+\"Game\"]().CheckCardBigOrSmall(tempSelectCards,this.cardStateList[\"DUN3\"]) == 0)\r\n                    return DaoShui;\r\n            }\r\n        }\r\n        else if(dun == \"DUN2\"){\r\n            if(this.cardStateList[\"DUN3\"].length == 0 && this.cardStateList[\"DUN1\"].length == 0)\r\n                return NotDaoShui;\r\n\r\n            if(this.cardStateList[\"DUN1\"].length != 0){\r\n                if(app[\"Logic\"+app.subGameName.toUpperCase()+\"Game\"]().CheckCardBigOrSmall(this.cardStateList[\"DUN1\"],tempSelectCards) == 0)\r\n                    return DaoShui;\r\n            }\r\n            if(this.cardStateList[\"DUN3\"].length != 0){\r\n                if(app[\"Logic\"+app.subGameName.toUpperCase()+\"Game\"]().CheckCardBigOrSmall(tempSelectCards,this.cardStateList[\"DUN3\"]) == 0)\r\n                    return DaoShui;\r\n            }\r\n        }\r\n        else if(dun == \"DUN3\"){\r\n            if(this.cardStateList[\"DUN1\"].length == 0 && this.cardStateList[\"DUN2\"].length == 0)\r\n                return NotDaoShui;\r\n\r\n            if(this.cardStateList[\"DUN1\"].length != 0){\r\n                if(app[\"Logic\"+app.subGameName.toUpperCase()+\"Game\"]().CheckCardBigOrSmall(this.cardStateList[\"DUN1\"],tempSelectCards) == 0)\r\n                    return DaoShui;\r\n            }\r\n            if(this.cardStateList[\"DUN2\"].length != 0){\r\n                if(app[\"Logic\"+app.subGameName.toUpperCase()+\"Game\"]().CheckCardBigOrSmall(this.cardStateList[\"DUN2\"],tempSelectCards) == 0)\r\n                    return DaoShui;\r\n            }\r\n        }\r\n        return NotDaoShui;\r\n    },\r\n    AutoSetDun:function (){\r\n\r\n        if(this.isSixteen){\r\n            return;\r\n        }\r\n        \r\n        if((this.cardStateList['DUN1'].length == 3 && this.cardStateList['DUN2'].length == 5) ||\r\n            (this.cardStateList['DUN1'].length == 3 && this.cardStateList['DUN3'].length == 5) ||\r\n            (this.cardStateList['DUN2'].length == 5 && this.cardStateList['DUN3'].length == 5)){\r\n\r\n            let downList = [];\r\n            downList = this.cardStateList['DOWN'];\r\n\r\n            this.cardStateList['DOWN'] = [];\r\n            this.clearSelectedCards();\r\n\r\n            if(this.cardStateList['DUN1'].length < 3){\r\n                for(let idx = 0; idx < downList.length; idx++){\r\n                    this.cardStateList['DUN1'].push(downList[idx]);\r\n                }\r\n            }\r\n            else if(this.cardStateList['DUN2'].length < 5){\r\n                for(let idx = 0; idx < downList.length; idx++){\r\n                    this.cardStateList['DUN2'].push(downList[idx]);\r\n                }\r\n            }\r\n            else if(this.cardStateList['DUN3'].length < 5){\r\n                for(let idx = 0; idx < downList.length; idx++){\r\n                    this.cardStateList['DUN3'].push(downList[idx]);\r\n                }\r\n            }\r\n\r\n\r\n            if(this.CheckDaoShui('DUN3') == 0){\r\n                app[app.subGameName + \"_SysNotifyManager\"]().ShowSysMsg(\"MSG_CARD_DAOSHUI\");\r\n                this.cardStateList['SELECTED'] = [];\r\n                this.ClearDun('DUN3',false);\r\n            }\r\n            if(this.CheckDaoShui('DUN2') == 0){\r\n                app[app.subGameName + \"_SysNotifyManager\"]().ShowSysMsg(\"MSG_CARD_DAOSHUI\");\r\n                this.cardStateList['SELECTED'] = [];\r\n                this.ClearDun('DUN2',false);\r\n            }\r\n            if(this.CheckDaoShui('DUN1') == 0){\r\n                app[app.subGameName + \"_SysNotifyManager\"]().ShowSysMsg(\"MSG_CARD_DAOSHUI\");\r\n                this.cardStateList['SELECTED'] = [];\r\n                this.ClearDun('DUN1',false);\r\n            }\r\n\r\n            app[app.subGameName + \"Client\"].OnEvent(\"EVT_DUN_UPDATE\");\r\n        }\r\n    },\r\n\r\n    SetDun:function(dun){\r\n        //未选中或墩位已满\r\n        if (this.cardStateList['SELECTED'] == []) {\r\n\r\n            return\r\n        }\r\n\r\n        if(this.CheckDaoShui(dun) == 0){\r\n            app[app.subGameName + \"_SysNotifyManager\"]().ShowSysMsg(\"MSG_CARD_DAOSHUI\");\r\n            this.cardStateList['SELECTED'] = [];\r\n            this.ClearDun(dun,true);\r\n            app[app.subGameName + \"Client\"].OnEvent(\"EVT_DUN_UPDATE\");\r\n            return;\r\n        }\r\n        \r\n        for (let i = 0; i < this.cardStateList['SELECTED'].length; i++) {\r\n\r\n            //选中的太多了\r\n            if (dun == \"DUN1\" && this.cardStateList[dun].length >= 3) continue;\r\n            if (dun == \"DUN2\" && this.cardStateList[dun].length >= 5) continue;\r\n            if (dun == \"DUN3\" && this.cardStateList[dun].length >= 5) continue;\r\n\r\n            let selectCardType = this.cardStateList['SELECTED'][i]\r\n            let dunPos = this.cardStateList[dun].indexOf(selectCardType);\r\n            let downPos = this.cardStateList[\"DOWN\"].indexOf(selectCardType);\r\n\r\n            if (dunPos == -1 && downPos > -1){\r\n                this.cardStateList['DOWN'].splice(downPos, 1)\r\n                this.cardStateList[dun].push(selectCardType);\r\n            }\r\n        };\r\n\r\n        this.cardStateList['SELECTED'] = [];\r\n        app[app.subGameName + \"Client\"].OnEvent(\"EVT_DUN_UPDATE\");\r\n    },\r\n\r\n    pushDownCards:function(pokers){\r\n        this.cardStateList['DOWN'] = [];\r\n\r\n        for(let idx = 0; idx < pokers.length; idx++){\r\n            let card = pokers[idx].cardX16;\r\n            this.cardStateList['DOWN'].push(card);\r\n        }\r\n\r\n        app[app.subGameName + \"Client\"].OnEvent(\"EVT_DUN_UPDATE\");\r\n    },\r\n\r\n    ClearDun:function(dun, trigger){\r\n        for (let i = 0; i < this.cardStateList[dun].length; i++) {\r\n            let cardType = this.cardStateList[dun][i];\r\n            let downPos = this.cardStateList[\"DOWN\"].indexOf(cardType);\r\n            if (-1 == downPos){\r\n                this.cardStateList['DOWN'].push(cardType);\r\n            }\r\n            else {\r\n                this.ErrLog(\"failed to clear because down has this cardType %s\", cardType);\r\n            }\r\n        };\r\n        this.cardStateList[dun] = [];\r\n        if(trigger){\r\n            app[app.subGameName + \"Client\"].OnEvent(\"EVT_DUN_UPDATE\");\r\n        }\r\n    },\r\n\r\n    ClearOneCard:function(dun,idx){\r\n        \r\n        //如果该位置上没牌\r\n        // console.log(\"SELECTED数组 + \", this.cardStateList['SELECTED']);\r\n        if(!this.cardStateList[dun][idx]) {\r\n            if(this.cardStateList['SELECTED'].length){\r\n                this.SetDun(dun);\r\n            }else{\r\n                return;\r\n            }\r\n           \r\n        }else{\r\n            let cardType = this.cardStateList[dun][idx];\r\n            let downPos = this.cardStateList[\"DOWN\"].indexOf(cardType);\r\n            if (-1 == downPos){\r\n                for(let i = 0; i<this.cardStateList[dun].length;i++){\r\n                    if(cardType == this.cardStateList[dun][i]){\r\n                        this.cardStateList[dun].splice(i,1);\r\n                    }\r\n                }\r\n                this.cardStateList['DOWN'].push(cardType);\r\n            }\r\n            else {\r\n                this.ErrLog(\"failed to clear because down has this cardType %s\", cardType);\r\n            }\r\n        }\r\n        \r\n        app[app.subGameName + \"Client\"].OnEvent(\"EVT_DUN_UPDATE\");\r\n    },\r\n\r\n    CheckAllRanked:function(){\r\n        let bAllRanked = true;\r\n        if(this.isSixteen){\r\n            if(this.cardStateList[\"DOWN\"].length > 3){\r\n                bAllRanked = false;\r\n            }\r\n        }\r\n        else{\r\n            if (this.cardStateList[\"DOWN\"].length > 0) {\r\n                bAllRanked = false;\r\n            }\r\n        }\r\n\r\n        return bAllRanked\r\n\r\n    },\r\n\r\n    CheckSelected:function(cardType){\r\n        // console.log(\"SELECTED数组 + \", this.cardStateList['SELECTED']);\r\n        let downPos = this.cardStateList[\"SELECTED\"].indexOf(cardType);\r\n        if (-1 == downPos){\r\n            return false;\r\n        }\r\n        return true;\r\n    },\r\n    SendRankList:function(dun){\r\n        let room = this.RoomMgr.GetEnterRoom();\r\n        let roomID = room.GetRoomProperty(\"roomID\");\r\n        let pid = app[app.subGameName + \"_HeroManager\"]().GetHeroProperty(\"pid\");\r\n        let posIdx = this.RoomPosMgr.GetClientPos();\r\n        \r\n        let sendPack = {\r\n            roomID: roomID, //房间id\r\n            pid :pid,    //玩家id\r\n            posIdx:posIdx,  //玩家位置\r\n            isSpecial:this.isSpecial,\r\n            dunPos: {\r\n                first:this.cardStateList[\"DUN1\"],\r\n                second:this.cardStateList[\"DUN2\"],\r\n                third:this.cardStateList[\"DUN3\"],\r\n            }\r\n        }\r\n        this.NetManager.SendPack(app.subGameName+\".C\"+app.subGameName.toUpperCase()+\"Ranked\", sendPack, function(){}, function(error){\r\n            let roomid = app[app.subGameName.toUpperCase()+\"RoomMgr\"]().GetEnterRoom().GetRoomProperty(\"roomID\");\r\n            app[app.subGameName.toUpperCase()+\"RoomMgr\"]().SendGetRoomInfo(roomid);\r\n        });\r\n        this.ClearDun('DUN1',true);\r\n        this.ClearDun('DUN2',true);\r\n        this.ClearDun('DUN3',true);\r\n        return true;\r\n    },\r\n\r\n    CheckDuiZi:function(){\r\n        this.cardStateList['SELECTED'] = [];\r\n        let downList = this.cardStateList['DOWN'];\r\n        let duizis = app[\"Logic\"+app.subGameName.toUpperCase()+\"Game\"]().GetDuiZi(downList);\r\n        \r\n        if (duizis.length > 0){\r\n            let duizi = [];\r\n\r\n            if(this.duiziCount >= duizis.length)\r\n                this.duiziCount = 0;\r\n\r\n            if(1 == duizis.length){\r\n                duizi = duizis[0];\r\n            }\r\n            else{\r\n                duizi = duizis[this.duiziCount];    \r\n            }\r\n            this.duiziCount++;\r\n        \r\n            this.cardStateList['SELECTED'] = duizi;\r\n            app[app.subGameName + \"Client\"].OnEvent(\"EVT_DUN_UPDATE\");\r\n        }\r\n    },\r\n\r\n    CheckLiangDui:function(){\r\n        this.cardStateList['SELECTED'] = [];\r\n        let downList = this.cardStateList['DOWN'];\r\n        let duizis = app[\"Logic\"+app.subGameName.toUpperCase()+\"Game\"]().GetDuiZi(downList);\r\n\r\n        if(this.liangduiCount >= duizis.length)\r\n                this.liangduiCount = 0; \r\n\r\n        if(duizis.length >= 2){\r\n            let fristDui = duizis[this.liangduiCount];\r\n            let scendDui = [];\r\n            for(let i = 0; i < duizis.length; i++){\r\n                scendDui = duizis[i];\r\n                let bRet = this.LogicPDKGame.CheckSameValue(fristDui, scendDui);\r\n                if(!bRet) break;\r\n            }\r\n\r\n            this.liangduiCount++;\r\n            if(this.liangduiCount >= duizis.length)\r\n                this.liangduiCount = 0;\r\n\r\n            let liangdui = fristDui.concat(scendDui);\r\n            this.cardStateList['SELECTED'] = liangdui;\r\n        }\r\n        if (this.cardStateList['SELECTED'].length < 4) {\r\n            //对子数量不足\r\n            console.log(\"this.cardStateList[SELECTED]\", this.cardStateList['SELECTED']);\r\n            app[app.subGameName + \"_SysNotifyManager\"]().ShowSysMsg(app.subGameName.toUpperCase()+\"_DUIZI_NOT_ENOUGH\");\r\n            return;\r\n        } \r\n        app[app.subGameName + \"Client\"].OnEvent(\"EVT_DUN_UPDATE\");\r\n\r\n    },\r\n \r\n    CheckSanTiao:function(){\r\n        this.cardStateList['SELECTED'] = [];\r\n        let downList = this.cardStateList['DOWN'];\r\n        let santiaos = app[\"Logic\"+app.subGameName.toUpperCase()+\"Game\"]().GetSanTiao(downList);\r\n\r\n        if (santiaos.length){\r\n             let santiao = [];\r\n            if(1 == santiaos.length){\r\n                santiao = santiaos[0];\r\n            }\r\n            else{\r\n                santiao = santiaos[this.santiaoCount];    \r\n            }\r\n            this.santiaoCount++;\r\n            \r\n            if(this.santiaoCount >= santiaos.length)\r\n                this.santiaoCount = 0;\r\n            this.cardStateList['SELECTED'] = santiao;\r\n        }\r\n        else {\r\n            app[app.subGameName + \"_SysNotifyManager\"]().ShowSysMsg(app.subGameName.toUpperCase()+\"_SANTIAO_NOT_ENOUGH\");\r\n        }\r\n        app[app.subGameName + \"Client\"].OnEvent(\"EVT_DUN_UPDATE\");\r\n\r\n    },\r\n\r\n    CheckShunzi:function(){\r\n\r\n        this.cardStateList['SELECTED'] = [];\r\n        let shunzis = [];\r\n        let downList = this.cardStateList['DOWN'];\r\n        shunzis = app[\"Logic\"+app.subGameName.toUpperCase()+\"Game\"]().GetShunzi(downList);\r\n\r\n        if (shunzis.length){\r\n           \r\n            let shunzi = [];\r\n\r\n            if(this.shunziCount >= shunzis.length)\r\n                this.shunziCount = 0;\r\n\r\n            if(1 == shunzis.length){\r\n                shunzi = shunzis[0];\r\n            }\r\n            else{\r\n                shunzi = shunzis[this.shunziCount];    \r\n            }\r\n            this.shunziCount++;\r\n\r\n            this.cardStateList['SELECTED'] = shunzi;\r\n\r\n            app[app.subGameName + \"Client\"].OnEvent(\"EVT_DUN_UPDATE\");\r\n        }\r\n        else {\r\n            app[app.subGameName + \"_SysNotifyManager\"]().ShowSysMsg(app.subGameName.toUpperCase()+\"_SHUNZI_NOT_ENOUGH\");\r\n            app[app.subGameName + \"Client\"].OnEvent(\"EVT_DUN_UPDATE\");\r\n        }\r\n    },\r\n\r\n    CheckTonghua:function(){\r\n        this.cardStateList['SELECTED'] = [];\r\n        let downList = this.cardStateList['DOWN'];\r\n        let tonghuas = app[\"Logic\"+app.subGameName.toUpperCase()+\"Game\"]().GetTonghua(downList);\r\n\r\n        if (tonghuas.length){\r\n            let tonghua = [];\r\n\r\n            if(this.tonghuaCount >= tonghuas.length)\r\n                this.tonghuaCount = 0;\r\n\r\n            if(1 == tonghuas.length){\r\n                tonghua = tonghuas[0];\r\n            }else{\r\n                tonghua = tonghuas[this.tonghuaCount];\r\n            }\r\n            this.tonghuaCount++;\r\n\r\n            this.cardStateList['SELECTED'] = tonghua;\r\n            app[app.subGameName + \"Client\"].OnEvent(\"EVT_DUN_UPDATE\");\r\n        }\r\n    },\r\n\r\n    CheckHulu:function(){\r\n        this.cardStateList['SELECTED'] = [];\r\n        let downList = this.cardStateList['DOWN'];\r\n        let duizis = app[\"Logic\"+app.subGameName.toUpperCase()+\"Game\"]().GetDuiZi(downList);\r\n        let santiaos = app[\"Logic\"+app.subGameName.toUpperCase()+\"Game\"]().GetSanTiao(downList);\r\n        let hulus = [];\r\n        for(let i = 0; i < duizis.length; i++){\r\n            let dui = duizis[i];\r\n            for(let j = 0; j < santiaos.length; j++){\r\n                let san = santiaos[j];\r\n                if(!this.LogicPDKGame.CheckSameValue(dui, san)){\r\n                    let hulu = dui.concat(san);\r\n                    hulus[hulus.length] = hulu;\r\n                }\r\n            }\r\n        }\r\n\r\n        this.huluCount++;\r\n\r\n        if(this.huluCount >= hulus.length)\r\n            this.huluCount = 0;\r\n\r\n        this.cardStateList['SELECTED'] = hulus[this.huluCount];\r\n        app[app.subGameName + \"Client\"].OnEvent(\"EVT_DUN_UPDATE\");\r\n    },\r\n \r\n    CheckZhaDang:function(){\r\n        this.cardStateList['SELECTED'] = [];\r\n        let downList = this.cardStateList['DOWN'];\r\n        let zhadangs = app[\"Logic\"+app.subGameName.toUpperCase()+\"Game\"]().GetZhaDang(downList);\r\n\r\n        if (zhadangs.length > 0){\r\n            let zhadan = [];\r\n\r\n            if(this.zhadanCount >= zhadangs.length)\r\n                this.zhadanCount = 0;\r\n\r\n            if(1 == zhadangs.length){\r\n                zhadan = zhadangs[0];\r\n            }\r\n            else{\r\n                zhadan = zhadangs[this.zhadanCount];    \r\n            }\r\n            this.zhadanCount++;\r\n            \r\n            this.cardStateList['SELECTED'] = zhadan;\r\n            app[app.subGameName + \"Client\"].OnEvent(\"EVT_DUN_UPDATE\");\r\n        }\r\n        else {\r\n            app[app.subGameName + \"_SysNotifyManager\"]().ShowSysMsg(app.subGameName.toUpperCase()+\"_ZHADAN_NOT_ENOUGH\");\r\n            app[app.subGameName + \"Client\"].OnEvent(\"EVT_DUN_UPDATE\");\r\n\r\n        }\r\n    },\r\n\r\n    CheckTongHuaShun:function(){\r\n        this.cardStateList['SELECTED'] = [];\r\n        let downList = this.cardStateList['DOWN'];\r\n        let tonghuaShuns = app[\"Logic\"+app.subGameName.toUpperCase()+\"Game\"]().GetTongHuaShunEx(downList);\r\n\r\n        if(tonghuaShuns.length){\r\n            let tonghuashun = [];\r\n\r\n            if(this.tonghuaShunCount  >= tonghuaShuns.length)\r\n                this.tonghuaShunCount = 0;\r\n\r\n            if(1 == tonghuaShuns.length ){\r\n                tonghuashun  = tonghuaShuns[0];\r\n            }else{\r\n                tonghuashun = tonghuaShuns[this.tonghuaShunCount];\r\n            }\r\n            this.tonghuaShunCount++;\r\n            \r\n            this.cardStateList['SELECTED'] = tonghuashun;\r\n            app[app.subGameName + \"Client\"].OnEvent(\"EVT_DUN_UPDATE\");\r\n        }\r\n        else{\r\n            app[app.subGameName + \"_SysNotifyManager\"]().ShowSysMsg(app.subGameName.toUpperCase()+\"_TONGHUASHUN_NOT_ENOUGH\"); \r\n            app[app.subGameName + \"Client\"].OnEvent(\"EVT_DUN_UPDATE\");\r\n        }\r\n    },\r\n\r\n    CheckWuTong:function(){\r\n        this.cardStateList['SELECTED'] = [];\r\n        let downList = this.cardStateList['DOWN'];\r\n        let wutongs = app[\"Logic\"+app.subGameName.toUpperCase()+\"Game\"]().GetWuTong(downList);\r\n\r\n        if(wutongs.length){\r\n            let wutong = [];\r\n\r\n            if(this.wutongCount >= wutongs.length)\r\n                this.wutongCount = 0;\r\n\r\n            if(1 == wutongs.length ){\r\n                wutong  = wutongs[0];\r\n            }else{\r\n                wutong = wutongs[this.wutongCount];\r\n            }\r\n            this.wutongCount++;\r\n            \r\n            this.cardStateList['SELECTED'] = wutong;\r\n            app[app.subGameName + \"Client\"].OnEvent(\"EVT_DUN_UPDATE\");\r\n        }\r\n        else{\r\n            //app[app.subGameName + \"_SysNotifyManager\"]().ShowSysMsg(app.subGameName.toUpperCase()+\"_TONGHUASHUN_NOT_ENOUGH\"); \r\n            //app[app.subGameName + \"Client\"].OnEvent(\"EVT_DUN_UPDATE\");\r\n            console.log('没有五同');\r\n        } \r\n    },   \r\n    SetDunEx:function(dun,catlist){\r\n        this.cardStateList['SELECTED']=catlist;\r\n        for (let i = 0; i < this.cardStateList['SELECTED'].length; i++) {\r\n\r\n            //选中的太多了\r\n            if (dun == \"DUN1\" && this.cardStateList[dun].length >= 3) continue;\r\n            if (dun == \"DUN2\" && this.cardStateList[dun].length >= 5) continue;\r\n            if (dun == \"DUN3\" && this.cardStateList[dun].length >= 5) continue;\r\n\r\n            let selectCardType = this.cardStateList['SELECTED'][i]\r\n            let dunPos = this.cardStateList[dun].indexOf(selectCardType);\r\n            let downPos = this.cardStateList[\"DOWN\"].indexOf(selectCardType);\r\n\r\n            if (dunPos == -1 && downPos > -1){\r\n                this.cardStateList['DOWN'].splice(downPos, 1)\r\n                this.cardStateList[dun].push(selectCardType);\r\n            }\r\n        };\r\n        this.cardStateList['SELECTED'] = [];\r\n        //app[app.subGameName + \"Client\"].OnEvent(\"EVT_DUN_UPDATE\");\r\n    },\r\n\r\n});\r\n\r\nvar g_LogicPDKRank = null;\r\n\r\n/**\r\n * 绑定模块外部方法\r\n */\r\nexports.GetModel = function(){\r\n    if(!g_LogicPDKRank){\r\n        g_LogicPDKRank = new LogicPDKRank();\r\n    }\r\n    return g_LogicPDKRank;\r\n\r\n}"]}