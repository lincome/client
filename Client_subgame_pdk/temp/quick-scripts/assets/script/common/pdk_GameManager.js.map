{"version":3,"sources":["pdk_GameManager.js"],"names":["app","require","pdk_GameManager","BaseClass","extend","Init","JS_Name","subGameName","NetManager","ShareDefine","RegNetPack","toUpperCase","OnPack_EnterRoom","OnPack_AutoStart","OnPack_PlayerAddress","OnPack_PosContinueGame","OnPack_DissolveRoom","OnPack_StartVoteDissolve","OnPack_ChangePlayerNum","OnPack_ChangePlayerNumAgree","OnPack_ChangeRoomNum","OnPack_PosReadyChg","OnPack_PosLeave","OnPack_PosUpdate","OnPack_LostConnect","OnPack_PosDealVote","OnPack_EveryGameRecord","OnPack_LoginGetCurRoomID","OnPack_XiPai","OnPack_Gitf","OnPack_MqResponseBo","OnPack_ContinueRoomInfo","bIsAutoPlayIng","bGetRoomIDByUI","xiPaiList","OnReload","serverPack","ShowForm","event","code","result","data","clientConfig","GameServerIP","gameTypeUrl","gameServerIP","GameServerPort","gameServerPort","isReconnecting","SendGetRoomInfo","roomID","CloseForm","Disconnect","UpdateAccessPoint","Connect","SetGetRoomIDByUI","bGet","SendChat","type","quickID","content","SendPack","OnEvent","SetPlayGame","gameType","custom","NowRoom","pos","OnPosContinueGame","ownnerForce","createPos","endSec","dissolveInfo","OnStartVoteDissolve","playerNum","OnStartChangePlaeryDissolve","isReady","GetRoomPosMgr","OnPosReadyChg","room","ownerID","selfPos","GetClientPos","OnPosLeave","UpdateOwnerID","posInfo","OnPosUpdate","Log","isLostConnect","isShowLeave","pid","RoomPosMgr","roomPosMgrInfo","GetRoomAllPlayerInfo","roomPosMgrInfoKeyList","Object","keys","count","length","i","posID","player","SetPlayerOfflineState","agreeDissolve","OnPosDealVote","ChangePlayerNumAgree","SetGameType","nowroom","SetGameRecord","playerAll","playerAllList","playerInfo","push","name","GetHeroProperty","cType","GetXiPaiList","RemoveOneXiPaiPlayer","splice","SendEnterRoom","roomKey","IsFristPlay","RoomMgr","state","GetEnterRoom","GetRoomProperty","IsAutoPlayIng","SetAutoPlayIng","bValue","isAuto","heroID","console","log","secTotal","isCoinRoom","GetSceneType","CancelAutoPlay","key","sendPack","trusteeship","SendAutoStart","SendGetCurRoomID","SendContinueGame","SendDissolveRoom","SendDissolveRoomAgree","SendDissolveRoomRefuse","SendChangePlayerAgree","SendChangePlayerRefuse","SendExitRoom","SendReady","posIndex","SendUnReady","SendKickPosIndex","SendXiPai","g_pdk_GameManager","exports","GetModel"],"mappings":"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","file":"pdk_GameManager.js","sourceRoot":"..\\..\\..\\..\\..\\assets\\script\\common","sourcesContent":["/*\r\n GameManager 游戏管理\r\n */\r\nvar app = require(\"pdk_app\");\r\n\r\nvar pdk_GameManager = app.BaseClass.extend({\r\n\r\n\tInit:function(){\r\n\t\tthis.JS_Name = app.subGameName + \"_GameManager\";\r\n\r\n\t\tthis.NetManager = app[app.subGameName + \"_NetManager\"]();\r\n\t\tthis.ShareDefine = app[app.subGameName + \"_ShareDefine\"]();\r\n\r\n\r\n\t\tthis.NetManager.RegNetPack(app.subGameName + \".C\" + app.subGameName.toUpperCase() + \"EnterRoom\", this.OnPack_EnterRoom, this);\r\n\t\tthis.NetManager.RegNetPack(\"S\" + app.subGameName.toUpperCase() + \"_Trusteeship\", this.OnPack_AutoStart, this);\r\n\t\tthis.NetManager.RegNetPack(\"S\" + app.subGameName.toUpperCase() + \"_Address\", this.OnPack_PlayerAddress, this);\r\n\t\t//2017.8.8  消息抽出来走公共\r\n\t\t//继续游戏\r\n\t\tthis.NetManager.RegNetPack(\"S\" + app.subGameName.toUpperCase() + \"_PosContinueGame\", this.OnPack_PosContinueGame, this); \r\n\t\t//解散房间\r\n\t\tthis.NetManager.RegNetPack(\"S\" + app.subGameName.toUpperCase() + \"_Dissolve\", this.OnPack_DissolveRoom, this); \r\n\t\t//解散投票\r\n\t\tthis.NetManager.RegNetPack(\"S\" + app.subGameName.toUpperCase() + \"_StartVoteDissolve\", this.OnPack_StartVoteDissolve, this);\r\n\r\n\r\n\t\t//修改人数投票\r\n\t\tthis.NetManager.RegNetPack(\"S\" + app.subGameName.toUpperCase() + \"_ChangePlayerNum\", this.OnPack_ChangePlayerNum, this);\r\n\t\t//修改人数投票同意\r\n\t\tthis.NetManager.RegNetPack(\"S\" + app.subGameName.toUpperCase() + \"_ChangePlayerNumAgree\", this.OnPack_ChangePlayerNumAgree, this); \r\n\t\t//房间修改人数\r\n\t\tthis.NetManager.RegNetPack(\"S\" + app.subGameName.toUpperCase() + \"_ChangeRoomNum\", this.OnPack_ChangeRoomNum, this); \r\n\r\n\t\t//玩家准备\r\n\t\tthis.NetManager.RegNetPack(\"S\" + app.subGameName.toUpperCase() + \"_PosReadyChg\", this.OnPack_PosReadyChg, this);\r\n\t\t//玩家离开\r\n\t\tthis.NetManager.RegNetPack(\"S\" + app.subGameName.toUpperCase() + \"_PosLeave\", this.OnPack_PosLeave, this); \r\n\t\t//玩家位置更新\r\n\t\tthis.NetManager.RegNetPack(\"S\" + app.subGameName.toUpperCase() + \"_PosUpdate\", this.OnPack_PosUpdate, this);  \r\n\t\t//玩家掉线\r\n\t\tthis.NetManager.RegNetPack(\"S\" + app.subGameName.toUpperCase() + \"_LostConnect\", this.OnPack_LostConnect, this);\r\n\r\n\t\tthis.NetManager.RegNetPack(\"S\" + app.subGameName.toUpperCase() + \"_PosDealVote\", this.OnPack_PosDealVote, this); \r\n\t\t//所有对局记录\r\n\t\tthis.NetManager.RegNetPack(\"game.CPlayerSetRoomRecord\", this.OnPack_EveryGameRecord, this);\r\n\r\n\t\tthis.NetManager.RegNetPack(\"game.C1101GetRoomID\", this.OnPack_LoginGetCurRoomID, this);\r\n\t\t//洗牌\r\n\t\tthis.NetManager.RegNetPack(\"S\" + app.subGameName.toUpperCase() + \"_XiPai\",this.OnPack_XiPai,this);\r\n\t\t//赠送礼物\r\n\t\tthis.NetManager.RegNetPack(\"S\" + app.subGameName.toUpperCase() + \"_SendGift\",this.OnPack_Gitf,this);\r\n\r\n\t\tthis.NetManager.RegNetPack(\"MqResponseBo\",this.OnPack_MqResponseBo,this);\r\n\r\n\t\tthis.NetManager.RegNetPack(\"SRoom_ContinueRoomInfo\",this.OnPack_ContinueRoomInfo,this);\r\n\t\t\r\n\t\tthis.bIsAutoPlayIng = false;\r\n\r\n\t\tthis.bGetRoomIDByUI = false;\r\n\t\tthis.xiPaiList = [];\r\n\t\tthis.OnReload();\r\n\t},\r\n\r\n\tOnPack_ContinueRoomInfo:function(serverPack){\r\n\t\tapp[app.subGameName + \"_FormManager\"]().ShowForm(app.subGameName + '_UIMessageJoin',serverPack);\r\n\t},\r\n\r\n\t\r\n\tOnPack_MqResponseBo:function(event){\r\n\t\tlet code=event.result.code;\r\n\t\tif(code==0){\r\n\t\t\tlet serverPack=event.result.data;\r\n            app[app.subGameName + \"Client\"].clientConfig.GameServerIP=serverPack.gameTypeUrl.gameServerIP;\r\n            app[app.subGameName + \"Client\"].clientConfig.GameServerPort=serverPack.gameTypeUrl.gameServerPort;\r\n            app[app.subGameName+\"_NetWork\"]().isReconnecting=true;  //标记为正在重新连接，让发送消息堆积多发送队列\r\n            app[app.subGameName.toUpperCase()+\"RoomMgr\"]().SendGetRoomInfo(serverPack.roomID); //加入获取消息到队列\r\n            //关闭游戏的UI\r\n            app[app.subGameName + \"_FormManager\"]().CloseForm(\"game/\"+app.subGameName.toUpperCase()+\"/UI\"+app.subGameName.toUpperCase()+\"_Play\");\r\n            app[app.subGameName + \"_FormManager\"]().CloseForm(\"game/\"+app.subGameName.toUpperCase()+\"/UI\"+app.subGameName.toUpperCase()+\"_LPPlay\");\r\n            app[app.subGameName + \"_FormManager\"]().CloseForm(\"game/\"+app.subGameName.toUpperCase()+\"/UI\"+app.subGameName.toUpperCase()+\"_SYPlay\");\r\n            app[app.subGameName + \"_FormManager\"]().CloseForm(app.subGameName+\"_UIPublic_Record\");\r\n            app[app.subGameName + \"_FormManager\"]().CloseForm(app.subGameName+\"_UILPPublic_Record\");\r\n            //关闭游戏的UI\r\n            app[app.subGameName+\"_NetWork\"]().Disconnect(true);\t\t\t//断开连接\r\n            app[app.subGameName+\"_NetWork\"]().UpdateAccessPoint();   //更新连接节点\r\n            app[app.subGameName+\"_NetWork\"]().Connect();\t\t\t//发起重新连接服务器\r\n    \t}\r\n\t},\r\n\r\n\r\n\tSetGetRoomIDByUI:function(bGet){\r\n\t\tthis.bGetRoomIDByUI = bGet;\r\n\t},\r\n\t//发送聊天封包\r\n\tSendChat:function (type, quickID, roomID, content) {\r\n\t\tthis.NetManager.SendPack(app.subGameName + \".C\" + app.subGameName.toUpperCase() + \"Chat\", {\"type\":type, \"quickID\":quickID, \"targetID\":roomID, \"content\":content});\r\n\t},\r\n\t//切换账号\r\n\tOnReload:function(){\r\n\t},\r\n\r\n\t//------------封包函数------------------\r\n\tOnPack_PlayerAddress:function(serverPack){\r\n\t\tapp[app.subGameName + \"Client\"].OnEvent(\"EVT_PlayerAddress\", serverPack);\r\n\t},\r\n\r\n\tSetPlayGame:function(serverPack){\r\n\t\tlet gameType = serverPack['gameType'];\r\n\t\tlet custom = serverPack['custom'];\r\n\t},\r\n\tNowRoom:function(){\r\n\t\treturn app[app.subGameName.toUpperCase()+\"Room\"]();\r\n\t},\r\n\t//位置继续游戏\r\n\tOnPack_PosContinueGame:function(serverPack){\r\n\t\tlet roomID = serverPack[\"roomID\"];\r\n\t\tlet pos = serverPack[\"pos\"];\r\n\t\tthis.NowRoom().OnPosContinueGame(pos);\r\n\t\tapp[app.subGameName + \"Client\"].OnEvent(app.subGameName.toUpperCase()+\"_PosContinueGame\", serverPack);\r\n\t\t//公共头像触发\r\n\t\tapp[app.subGameName + \"Client\"].OnEvent(\"PosContine\", serverPack);\r\n\t},\r\n\t//解散房间\r\n\tOnPack_DissolveRoom:function(serverPack){\r\n\t\tlet roomID = serverPack[\"roomID\"];\r\n\t\tlet ownnerForce = serverPack[\"ownnerForce\"];\r\n\t\tapp[app.subGameName + \"Client\"].OnEvent(app.subGameName.toUpperCase()+\"_DissolveRoom\", serverPack);\r\n\t},\r\n\t//接收到解散请求\r\n\tOnPack_StartVoteDissolve:function(serverPack){\r\n\t\tlet roomID = serverPack[\"roomID\"];\r\n\t\tlet createPos = serverPack[\"createPos\"];\r\n\t\tlet endSec = serverPack[\"endSec\"];\r\n\t\tlet dissolveInfo = this.NowRoom().OnStartVoteDissolve(createPos, endSec);\r\n\t\tapp[app.subGameName + \"Client\"].OnEvent(app.subGameName.toUpperCase()+\"_StartVoteDissolve\", dissolveInfo);\r\n\t},\r\n\t//接收人数修改请求\r\n\tOnPack_ChangePlayerNum:function(serverPack){\r\n\t\tlet roomID = serverPack[\"roomID\"];\r\n\t\tlet createPos = serverPack[\"createPos\"];\r\n\t\tlet endSec = serverPack[\"endSec\"];\r\n\t\tlet playerNum=serverPack.playerNum;\r\n\t\tlet dissolveInfo = this.NowRoom().OnStartChangePlaeryDissolve(createPos,playerNum,endSec);\r\n\t\tapp[app.subGameName + \"Client\"].OnEvent(app.subGameName.toUpperCase()+\"_ChangePlayerNum\", dissolveInfo);\r\n\t},\r\n\r\n\r\n\t//位置是否准备\r\n\tOnPack_PosReadyChg:function(serverPack){\r\n\t\tlet roomID = serverPack[\"roomID\"];\r\n\t\tlet pos = serverPack[\"pos\"];\r\n\t\tlet isReady = serverPack[\"isReady\"];\r\n\t\tif(this.NowRoom().GetRoomPosMgr().OnPosReadyChg(pos, isReady)){\r\n\t\t\tapp[app.subGameName + \"Client\"].OnEvent(app.subGameName.toUpperCase()+\"_PosReadyChg\", serverPack);\r\n\t\t}\r\n\t\telse{\r\n\t\t\t// this.Log(\"OnPack_PosReadyChg:\", serverPack);\r\n\t\t}\r\n\t},\r\n\t//位置离开房间\r\n\tOnPack_PosLeave:function(serverPack){\r\n\t\tlet roomID = serverPack[\"roomID\"];\r\n\t\tlet pos = serverPack[\"pos\"];\r\n\t\tlet room = this.NowRoom();\r\n\t\tlet ownerID=serverPack[\"ownerID\"];\r\n\t\tlet selfPos = -1;\r\n\t\tif(room){\r\n\t\t\tselfPos = room.GetRoomPosMgr().GetClientPos();\r\n\t\t\troom.OnPosLeave(pos);\r\n\t\t\tif(ownerID>0){\r\n\t\t\t\troom.UpdateOwnerID(ownerID);\r\n\t\t\t}\r\n\t\t}\r\n\t\tapp[app.subGameName + \"Client\"].OnEvent(app.subGameName.toUpperCase()+\"_PosLeave\", serverPack);\r\n\t\tif(pos == selfPos && !serverPack[\"beKick\"]){\r\n            app[app.subGameName + \"Client\"].OnEvent('ExitRoomSuccess', serverPack);\r\n        }\r\n\t},\r\n\t//更新座位信息\r\n\tOnPack_PosUpdate:function(serverPack){\r\n\t\tlet roomID = serverPack[\"roomID\"];\r\n\t\tlet pos = serverPack[\"pos\"];\r\n\t\tlet posInfo = serverPack[\"posInfo\"];\r\n\t\tthis.SetPlayGame(serverPack);\r\n\t\tif(this.NowRoom().GetRoomPosMgr().OnPosUpdate(pos, posInfo)){\r\n\t\t\tapp[app.subGameName + \"Client\"].OnEvent(app.subGameName.toUpperCase()+\"_PosUpdate\", serverPack);\r\n\t\t}\r\n\t\telse{\r\n\t\t\tthis.Log(\"OnPack_PosUpdate:\", serverPack);\r\n\t\t}\r\n\r\n\t},\r\n\t//有玩家掉线\r\n    OnPack_LostConnect:function (serverPack) {\r\n\t\tlet isLostConnect = serverPack[\"isLostConnect\"];\r\n\t\tlet isShowLeave = serverPack[\"isShowLeave\"];\r\n\t\tlet pid = serverPack[\"pid\"];\r\n\t\tlet RoomPosMgr = this.NowRoom().GetRoomPosMgr();\r\n\t\tlet roomPosMgrInfo = RoomPosMgr.GetRoomAllPlayerInfo();\r\n\t\tlet roomPosMgrInfoKeyList = Object.keys(roomPosMgrInfo);\r\n\t\tlet count = roomPosMgrInfoKeyList.length;\r\n\t\tfor(let i = 0; i < count; i++){\r\n\t\t\tlet posID = roomPosMgrInfoKeyList[i];\r\n\t\t\tlet player = roomPosMgrInfo[posID];\r\n\t\t\tif(pid == player[\"pid\"]){\r\n                RoomPosMgr.SetPlayerOfflineState(posID, isLostConnect, isShowLeave);\r\n\t\t\t\tbreak\r\n\t\t\t}\r\n\t\t}\r\n        app[app.subGameName + \"Client\"].OnEvent(\"PlayerOffline\", serverPack);\r\n    },\r\n    //位置更新解散\r\n\tOnPack_PosDealVote:function(serverPack){\r\n\t\tlet roomID = serverPack[\"roomID\"];\r\n\t\tlet pos = serverPack[\"pos\"];\r\n\t\tlet agreeDissolve = serverPack[\"agreeDissolve\"];\r\n\t\tlet dissolveInfo = this.NowRoom().OnPosDealVote(pos, agreeDissolve);\r\n\t\tapp[app.subGameName + \"Client\"].OnEvent(\"PosDealVote\", dissolveInfo);\r\n\t},\r\n\r\n\r\n\t //位置更新解散\r\n\tOnPack_ChangePlayerNumAgree:function(serverPack){\r\n\t\tlet roomID = serverPack[\"roomID\"];\r\n\t\tlet pos = serverPack[\"pos\"];\r\n\t\tlet agreeDissolve = serverPack[\"agreeChange\"];\r\n\t\tlet dissolveInfo = this.NowRoom().ChangePlayerNumAgree(pos, agreeDissolve);\r\n\t\tapp[app.subGameName + \"Client\"].OnEvent(\"PosChangePlayerDealVote\", dissolveInfo);\r\n\t},\r\n\r\n\tOnPack_ChangeRoomNum:function(serverPack){\r\n\t\tapp[app.subGameName + \"_FormManager\"]().CloseForm(app.subGameName + \"_UIMessage03\");\r\n\t\tthis.OnPack_EnterRoom(serverPack);\r\n\t},\r\n\r\n\t//房间key查找完成\r\n\tOnPack_EnterRoom:function(serverPack){\r\n\t\tlet roomID = serverPack.roomID;\r\n\t    app[app.subGameName + \"Client\"].SetGameType(app.subGameName);\r\n\t\tapp[app.subGameName.toUpperCase()+\"RoomMgr\"]().SendGetRoomInfo(roomID);\r\n\t},\r\n\t//获取所有对局记录\r\n    OnPack_EveryGameRecord:function(serverPack){\r\n    \tlet nowroom=this.NowRoom();\r\n    \tif(nowroom){\r\n    \t\tnowroom.SetGameRecord(true);\r\n    \t}\r\n        app[app.subGameName + \"Client\"].OnEvent(\"GameRecord\", serverPack);\r\n    },\r\n    OnPack_LoginGetCurRoomID:function(serverPack){\r\n    \tif(!this.bGetRoomIDByUI)\r\n    \t\tapp[app.subGameName + \"Client\"].OnEvent(\"LoginGetCurRoomID\", serverPack);\r\n    \telse\r\n    \t\tapp[app.subGameName + \"Client\"].OnEvent(\"GetCurRoomID\", serverPack);\r\n\r\n    \tthis.bGetRoomIDByUI = false;\r\n    },\r\n    //洗牌\r\n    OnPack_XiPai:function(serverPack){\r\n\t\tlet nowroom=this.NowRoom();\r\n\t\tlet playerAll = nowroom.GetRoomPosMgr().GetRoomAllPlayerInfo();\r\n\t\tlet playerAllList= Object.keys(playerAll);\r\n        var playerInfo = null;\r\n        for(var i=0;i<playerAllList.length;i++){\r\n\t\t\tplayerInfo = playerAll[playerAllList[i]];\r\n\t\t\tif(playerInfo.pid == serverPack.pid){\r\n\t\t\t\tthis.xiPaiList.push(playerInfo.name);\r\n\t\t\t\t// app[app.subGameName + \"_SysNotifyManager\"]().ShowSysMsg(app.subGameName.toUpperCase()+'_XIPAI_SUCCESS',[playerInfo.name]);\r\n\t\t\t\tif(app[app.subGameName + \"_HeroManager\"]().GetHeroProperty(\"pid\") == serverPack.pid){\r\n\t\t\t\t\tapp[app.subGameName + \"Client\"].OnEvent(\"Event_XiPai\", serverPack);\r\n\t\t\t\t}\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\t\tlet cType = serverPack.cType;\r\n\t\tif('PK' == cType){\t\r\n\t\t\tapp[app.subGameName + \"_FormManager\"]().ShowForm('game/'+app.subGameName.toUpperCase()+'/'+app.subGameName+'_UIXiPai');\r\n\t\t}\r\n\t\telse{\r\n\t\t\tapp[app.subGameName + \"_FormManager\"]().ShowForm('game/base/ui/majiang/UIMJXiPai');\r\n\t\t}\r\n\t},\r\n\tOnPack_Gitf:function(serverPack){\r\n\t\tapp[app.subGameName + \"Client\"].OnEvent(\"GameGift\", serverPack);\r\n\t},\r\n\t//--------------获取接口------------------------\r\n\tGetXiPaiList:function(){\r\n\t\treturn this.xiPaiList;\r\n\t},\r\n\tRemoveOneXiPaiPlayer:function(){\r\n\t\tif(0==this.xiPaiList.length)\r\n\t\t\treturn;\r\n\t\tthis.xiPaiList.splice(0,1);\r\n\t},\r\n\t//---------------发包接口------------------------\r\n\t//进入房间\r\n\tSendEnterRoom:function(roomKey){\r\n\t\tthis.NetManager.SendPack(app.subGameName + \".C\" + app.subGameName.toUpperCase() + \"EnterRoom\", {\"roomKey\":roomKey,\"posID\":-1});\r\n\t},\r\n\tIsFristPlay:function(){\r\n\t\tlet RoomMgr = app[app.subGameName.toUpperCase() + \"RoomMgr\"]();\r\n\t\tlet state = RoomMgr.GetEnterRoom().GetRoomProperty(\"state\");\r\n\t\treturn state != 0 ? true : false;\r\n\t},\r\n\t\r\n\tIsAutoPlayIng:function(){\r\n\t\treturn this.bIsAutoPlayIng;\r\n\t},\r\n\tSetAutoPlayIng:function(bValue){\r\n\t\tthis.bIsAutoPlayIng = bValue;\r\n\t},\r\n\tOnPack_AutoStart:function(serverPack){\r\n\t\tapp[app.subGameName + \"Client\"].OnEvent('SPlayer_Trusteeship', serverPack);\r\n        let roomID = serverPack[\"roomID\"];\r\n        let pos = serverPack[\"pos\"];\r\n        let isAuto = serverPack[\"trusteeship\"];\r\n        let pid = serverPack[\"pid\"];\r\n        let heroID = app[app.subGameName + \"_HeroManager\"]().GetHeroProperty(\"pid\");\r\n        console.log(\"===============托管时间=================\", serverPack.secTotal + \"秒\");\r\n\r\n        let RoomMgr = app[app.subGameName.toUpperCase()+\"RoomMgr\"]();\r\n        let RoomPosMgr = RoomMgr.GetEnterRoom().GetRoomPosMgr();\r\n        if(pos == RoomPosMgr.GetClientPos() && heroID == pid){\r\n            if(!isAuto){\r\n                this.bIsAutoPlayIng = false;\r\n                app[app.subGameName + \"_FormManager\"]().CloseForm(app.subGameName + \"_UIAutoPlay\");\r\n            }\r\n            else{\r\n            \tif(this.ShareDefine.isCoinRoom && app[app.subGameName + \"_SceneManager\"]().GetSceneType() == app.subGameName + \"MainScene\"){\r\n                \tapp[app.subGameName + \"_FormManager\"]().CloseForm(app.subGameName + \"_UIAutoPlay\");\r\n                \tthis.bIsAutoPlayIng = false;\r\n            \t}\r\n            \telse{\r\n            \t\tthis.bIsAutoPlayIng = true;\r\n            \t\tapp[app.subGameName + \"_FormManager\"]().ShowForm(app.subGameName + \"_UIAutoPlay\", serverPack.secTotal);\r\n            \t}\r\n            }\r\n        }\r\n    },\r\n\tCancelAutoPlay:function(){\r\n\t\tthis.bIsAutoPlayIng = false;\r\n        let RoomMgr = app[app.subGameName.toUpperCase()+\"RoomMgr\"]();\r\n        let room = RoomMgr.GetEnterRoom();\r\n        let roomID = room.GetRoomProperty(\"roomID\");\r\n        let key = room.GetRoomProperty(\"key\");\r\n        let heroID = app[app.subGameName + \"_HeroManager\"]().GetHeroProperty(\"pid\");\r\n        let sendPack = {\r\n            roomID: roomID,\r\n            trusteeship :false,\r\n            key:key,\r\n            pid:heroID\r\n        }\r\n        app[app.subGameName + \"_NetManager\"]().SendPack(app.subGameName + \".C\" + app.subGameName.toUpperCase() + \"Trusteeship\", sendPack);\r\n\t},\r\n\tSendAutoStart:function(){\r\n\t\tthis.bIsAutoPlayIng = true;\r\n        let RoomMgr = app[app.subGameName.toUpperCase()+\"RoomMgr\"]();\r\n        let room = RoomMgr.GetEnterRoom();\r\n        let roomID = room.GetRoomProperty(\"roomID\");\r\n        let key = room.GetRoomProperty(\"key\");\r\n        let heroID = app[app.subGameName + \"_HeroManager\"]().GetHeroProperty(\"pid\");\r\n        let sendPack = {\r\n            roomID: roomID,\r\n            trusteeship :true,\r\n            key:key,\r\n            pid:heroID\r\n        }\r\n        app[app.subGameName + \"_NetManager\"]().SendPack(app.subGameName + \".C\" + app.subGameName.toUpperCase() + \"Trusteeship\", sendPack);\r\n    },\r\n\r\n    //游戏公用消息\r\n    //登录获取当前进入的房间ID\r\n\tSendGetCurRoomID:function(){\r\n\t\tthis.NetManager.SendPack(\"game.C1101GetRoomID\", {});\r\n\t},\r\n    //发送继续游戏\r\n\tSendContinueGame:function(roomID){\r\n\t\tthis.NetManager.SendPack(app.subGameName + \".C\" + app.subGameName.toUpperCase() + \"ContinueGame\", {\"roomID\":roomID});\r\n\t},\r\n\t//解散房间\r\n\tSendDissolveRoom:function(roomID){\r\n\t\tthis.NetManager.SendPack(app.subGameName + \".C\" + app.subGameName.toUpperCase() + \"DissolveRoom\", {\"roomID\":roomID});\r\n\t},\r\n\t//发送同意解散房间\r\n\tSendDissolveRoomAgree:function(roomID){\r\n\t\tthis.NetManager.SendPack(app.subGameName + \".C\" + app.subGameName.toUpperCase() + \"DissolveRoomAgree\", {\"roomID\":roomID});\r\n\t},\r\n\r\n\t//发送拒绝解散房间\r\n\tSendDissolveRoomRefuse:function(roomID){\r\n\t\tthis.NetManager.SendPack(app.subGameName + \".C\" + app.subGameName.toUpperCase() + \"DissolveRoomRefuse\", {\"roomID\":roomID});\r\n\t},\r\n\r\n\r\n\t//发送同意修改人数\r\n\tSendChangePlayerAgree:function(roomID){\r\n\t\tthis.NetManager.SendPack(app.subGameName + \".C\" + app.subGameName.toUpperCase() + \"ChangePlayerNumAgree\", {\"roomID\":roomID,\"agree\":1});\r\n\t},\r\n\r\n\t//发送拒绝修改人数\r\n\tSendChangePlayerRefuse:function(roomID){\r\n\t\tthis.NetManager.SendPack(app.subGameName + \".C\" + app.subGameName.toUpperCase() + \"ChangePlayerNumAgree\", {\"roomID\":roomID,\"agree\":2});\r\n\t},\r\n\r\n\r\n\t//退出房间\r\n\tSendExitRoom:function(roomID, pos){\r\n\t\tthis.NetManager.SendPack(app.subGameName + \".C\" + app.subGameName.toUpperCase() + \"ExitRoom\", {\"roomID\":roomID, \"posIndex\":pos});\r\n\t},\r\n\t//位置发送准备状态\r\n\tSendReady:function(roomID, posIndex){\r\n\t\tthis.NetManager.SendPack(app.subGameName + \".C\" + app.subGameName.toUpperCase() + \"ReadyRoom\", {\"roomID\":roomID, \"posIndex\":posIndex});\r\n\t},\r\n\r\n\t//发送取消准备状态\r\n\tSendUnReady:function(roomID, posIndex){\r\n\t\tthis.NetManager.SendPack(app.subGameName + \".C\" + app.subGameName.toUpperCase() + \"UnReadyRoom\", {\"roomID\":roomID, \"posIndex\":posIndex});\r\n\t},\r\n\r\n\t//房主T人\r\n    SendKickPosIndex:function(roomID, posIndex){\r\n\t\tthis.NetManager.SendPack(app.subGameName + \".C\" + app.subGameName.toUpperCase() + \"KickRoom\", {\"roomID\":roomID, \"posIndex\":posIndex});\r\n\t},\r\n\r\n\t//洗牌\r\n\tSendXiPai:function(roomID){\r\n\t\tthis.NetManager.SendPack(app.subGameName + \".C\" + app.subGameName.toUpperCase() + \"RoomXiPai\", {\"roomID\":roomID});\r\n\t},\r\n});\r\n\r\n\r\nvar g_pdk_GameManager = null;\r\n\r\n/**\r\n * 绑定模块外部方法\r\n */\r\nexports.GetModel = function(){\r\n\tif(!g_pdk_GameManager){\r\n\t\tg_pdk_GameManager = new pdk_GameManager();\r\n\t}\r\n\treturn g_pdk_GameManager;\r\n}"]}