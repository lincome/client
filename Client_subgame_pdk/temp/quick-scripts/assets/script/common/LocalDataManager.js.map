{"version":3,"sources":["LocalDataManager.js"],"names":["app","require","LocalDataManager","BaseClass","extend","Init","JS_Name","linkServer","InitDataDict","PlayerInitData","InitConfig","OnReload","configName","optionData","option","HaveConfigProperty","SetConfigProperty","PlayerLogin","heroID","toString","playerDataDict","GetConfigProperty","ErrLog","property","hasOwnProperty","value","canUse","cc","sys","localStorage","CanUse","configInfo","getItem","JSON","parse","setItem","stringify","SetPlayerConfigProperty","serverDataDict","GetPlayerConfigProperty","HavePlayerConfigProperty","Remove","removeItem","g_LocalDataManager","exports","GetModel"],"mappings":";;;;;;AAAA;;;AAGA,IAAIA,MAAMC,QAAQ,SAAR,CAAV;;AAEA,IAAIC,mBAAmBF,IAAIG,SAAJ,CAAcC,MAAd,CAAqB;;AAExCC,OAAK,gBAAU;AACX,OAAKC,OAAL,GAAe,kBAAf;;AAEA;AACA,OAAKC,UAAL,GAAkB,UAAlB;;AAEH;AACA,OAAKC,YAAL,GAAoB;AACd,iBAAa;AACT,qBAAgB,WADP;AAET,qBAAgB,gBAFP;AAGT,iBAAY,CAHH;AAIT,eAAU,CAJD;AAKT,kBAAa,CALJ;AAMT,gBAAW,CANF;AAOT,kBAAa,CAPJ;AAQT,mBAAc,CARL;AAST,mBAAc,EATL;AAUZ,gBAAW,CAVC;AAWZ,eAAU,CAXE;AAYZ,eAAU,CAZE;AAaZ,gBAAW,CAbC;AAcZ,kBAAa,CAdD;AAeZ,YAAO,CAAC,CAfI;AAgBZ,oBAAe;AAhBH,IADC;AAmBd,cAAU;AACP,mBAAc,EADP;AAEP,mBAAc,EAFP;AAGP,qBAAgB,CAHT;AAIP,mBAAc,CAJP;AAKP,uBAAkB,EALX;AAMP,iBAAY,CANL;AAOP,YAAO;AAPA,IAnBI;AA4BC,gBAAY;AACX,sBAAiB,EADN;AAEX,yBAAoB,EAFT;AAGX,uBAAkB,EAHP;AAIX,sBAAiB,EAJN;AAKX,qBAAgB;AALL;AA5Bb,GAApB;;AAqCA;AACA,OAAKC,cAAL,GAAsB;AAChB,kBAAc,EADE;AAEhB,gBAAY;AAFI,GAAtB;AAIH;;AAEM,OAAKC,UAAL;;AAEA;AACH,EAxDuC;;AA0DxC;AACAC,WAAS,oBAAU,CAClB,CA5DuC;;AA8DxC;;;AAGAD,aAAW,sBAAU;;AAEpB,OAAI,IAAIE,UAAR,IAAsB,KAAKJ,YAA3B,EAAwC;AACvC,OAAIK,aAAa,KAAKL,YAAL,CAAkBI,UAAlB,CAAjB;AACA,QAAI,IAAIE,MAAR,IAAkBD,UAAlB,EAA6B;AAC5B,QAAI,KAAKE,kBAAL,CAAwBH,UAAxB,EAAoCE,MAApC,CAAJ,EAAgD;AAC/C;AACA;AACD,SAAKE,iBAAL,CAAuBJ,UAAvB,EAAmCE,MAAnC,EAA2CD,WAAWC,MAAX,CAA3C;AACA;AACD;AACD,EA5EuC;;AA8ExC;;;AAGAG,cAAY,qBAASC,MAAT,EAAgB;;AAE3BA,WAASA,OAAOC,QAAP,EAAT;;AAEA;AACG,MAAI,CAAC,KAAKJ,kBAAL,CAAwBG,MAAxB,EAAgC,KAAKX,UAArC,CAAL,EAAsD;AAClD,QAAKS,iBAAL,CAAuBE,MAAvB,EAA+B,KAAKX,UAApC,EAAgD,EAAhD;AACH;;AAED,MAAIa,iBAAiB,KAAKC,iBAAL,CAAuBH,MAAvB,EAA+B,KAAKX,UAApC,CAArB;AACA;AACA,MAAG,CAACa,cAAJ,EAAmB;AAClB,QAAKE,MAAL,CAAY,sBAAZ,EAAoCJ,MAApC;AACG;AACH;;AAEJ,OAAI,IAAIK,QAAR,IAAoB,KAAKd,cAAzB,EAAwC;AACvC,OAAG,CAACW,eAAeI,cAAf,CAA8BD,QAA9B,CAAJ,EAA4C;AAC3CH,mBAAeG,QAAf,IAA2B,KAAKd,cAAL,CAAoBc,QAApB,CAA3B;AACA;AACD;AACE,OAAKP,iBAAL,CAAuBE,MAAvB,EAA+B,KAAKX,UAApC,EAAgDa,cAAhD;AAEH,EAxGuC;;AA2GxC;AACA;;;;;;AAMAJ,oBAAkB,2BAASJ,UAAT,EAAqBE,MAArB,EAA6BW,KAA7B,EAAmC;;AAEpD,MAAIC,SAASC,GAAGC,GAAH,CAAOC,YAAP,CAAoBC,MAAjC;;AAEA,MAAIC,aAAa,EAAjB;AACA,MAAGL,MAAH,EAAU;AACTK,gBAAaJ,GAAGC,GAAH,CAAOC,YAAP,CAAoBG,OAApB,CAA4BpB,UAA5B,CAAb;AACA,OAAImB,UAAJ,EAAe;AACdA,iBAAaE,KAAKC,KAAL,CAAWH,UAAX,CAAb;AACA;AACD;AAHA,QAII;AACHA,kBAAa,EAAb;AACA;;AAEDA,cAAWjB,MAAX,IAAqBW,KAArB;;AAEA;AACAE,MAAGC,GAAH,CAAOC,YAAP,CAAoBM,OAApB,CAA4BvB,UAA5B,EAAwCqB,KAAKG,SAAL,CAAeL,UAAf,CAAxC;AACA,GAdD,MAeI;AACHA,gBAAa,KAAKvB,YAAL,CAAkBI,UAAlB,CAAb;AACA,OAAG,CAACmB,UAAJ,EAAe;AACd,SAAKT,MAAL,CAAY,gCAAZ,EAA8CV,UAA9C;AACA,WAAO,KAAP;AACA;AACDmB,cAAWjB,MAAX,IAAqBW,KAArB;AACA;;AAGE,SAAO,IAAP;AACH,EAjJuC;;AAmJxC;;;;;AAKAY,0BAAwB,iCAASnB,MAAT,EAAiBJ,MAAjB,EAAyBW,KAAzB,EAA+B;AACtDP,WAASA,OAAOC,QAAP,EAAT;;AAEA,MAAIO,SAASC,GAAGC,GAAH,CAAOC,YAAP,CAAoBC,MAAjC;AACA,MAAGJ,MAAH,EAAU;;AAET,OAAIK,aAAaJ,GAAGC,GAAH,CAAOC,YAAP,CAAoBG,OAApB,CAA4Bd,MAA5B,CAAjB;AACA,OAAIa,UAAJ,EAAe;AACdA,iBAAaE,KAAKC,KAAL,CAAWH,UAAX,CAAb;AACA,IAFD,MAGI;AACHA,iBAAa,EAAb;AACA;;AAED;AACA,OAAG,CAACA,WAAWP,cAAX,CAA0B,KAAKjB,UAA/B,CAAJ,EAA+C;AAC9CwB,eAAW,KAAKxB,UAAhB,IAA8B,EAA9B;AACA;;AAED,OAAI+B,iBAAiBP,WAAW,KAAKxB,UAAhB,CAArB;AACA+B,kBAAexB,MAAf,IAAyBW,KAAzB;;AAEA;AACAE,MAAGC,GAAH,CAAOC,YAAP,CAAoBM,OAApB,CAA4BjB,MAA5B,EAAoCe,KAAKG,SAAL,CAAeL,UAAf,CAApC;AACA,GApBD,MAqBI;AACH,QAAKtB,cAAL,CAAoBK,MAApB,IAA8BW,KAA9B;AACA;;AAEE,SAAO,IAAP;AAEH,EAvLuC;;AAyLxC;AACA;;;;;AAKAJ,oBAAkB,2BAAST,UAAT,EAAqBE,MAArB,EAA4B;AAC7CF,eAAaA,WAAWO,QAAX,EAAb;;AAEA,MAAIO,SAASC,GAAGC,GAAH,CAAOC,YAAP,CAAoBC,MAAjC;;AAEG,MAAIC,aAAa,EAAjB;AACN,MAAGL,MAAH,EAAU;AACTK,gBAAaJ,GAAGC,GAAH,CAAOC,YAAP,CAAoBG,OAApB,CAA4BpB,UAA5B,CAAb;AACA,OAAImB,UAAJ,EAAe;AACdA,iBAAaE,KAAKC,KAAL,CAAWH,UAAX,CAAb;AACA;AACD;AACD;AANA,OAOO;AACNA,iBAAa,KAAKvB,YAAL,CAAkBI,UAAlB,CAAb;AACA,SAAKU,MAAL,CAAY,6DAAZ,EAA2EV,UAA3E,EAAuFE,MAAvF;AACA;;AAEE,MAAG,CAACiB,UAAJ,EAAe;AACd,QAAKT,MAAL,CAAY,0BAAZ,EAAwCV,UAAxC,EAAoDE,MAApD;AACA;AACA;;AAEE,MAAI,CAACiB,WAAWP,cAAX,CAA0BV,MAA1B,CAAL,EAAuC;AACnC,QAAKQ,MAAL,CAAY,gDAAZ,EAA8DR,MAA9D;AACA;AACH;;AAED,SAAOiB,WAAWjB,MAAX,CAAP;AACH,EA5NuC;;AA8NxC;;;;;AAKAyB,0BAAwB,iCAASrB,MAAT,EAAiBJ,MAAjB,EAAwB;;AAE5CI,WAASA,OAAOC,QAAP,EAAT;AACH,MAAIO,SAASC,GAAGC,GAAH,CAAOC,YAAP,CAAoBC,MAAjC;AACA,MAAIQ,iBAAiB,EAArB;;AAEA,MAAGZ,MAAH,EAAU;AACT,OAAIK,aAAaJ,GAAGC,GAAH,CAAOC,YAAP,CAAoBG,OAApB,CAA4Bd,MAA5B,CAAjB;AACA,OAAIa,UAAJ,EAAe;AACdA,iBAAaE,KAAKC,KAAL,CAAWH,UAAX,CAAb;AACA,QAAI,CAACA,WAAWP,cAAX,CAA0B,KAAKjB,UAA/B,CAAL,EAAgD;AAC/C,UAAKe,MAAL,CAAY,8DAAZ,EAA4EJ,MAA5E,EAAoF,KAAKX,UAAzF;AACA;AACA;AACD+B,qBAAiBP,WAAW,KAAKxB,UAAhB,CAAjB;AACA;AACD,GAVD,MAWI;AACH+B,oBAAiB,KAAK7B,cAAtB;AACA,QAAKa,MAAL,CAAY,+DAAZ,EAA6EJ,MAA7E,EAAqFJ,MAArF;AACA;;AAEE,MAAG,CAACwB,eAAed,cAAf,CAA8BV,MAA9B,CAAJ,EAA0C;AACtC,QAAKQ,MAAL,CAAY,4CAAZ,EAA0DJ,MAA1D,EAAkE,KAAKX,UAAvE,EAAmFO,MAAnF;AACA;AACH;;AAED,SAAOwB,eAAexB,MAAf,CAAP;AACH,EA/PuC;;AAiQxC;AACA;;;;;AAKAC,qBAAmB,4BAASH,UAAT,EAAqBE,MAArB,EAA4B;;AAE3C,MAAIiB,aAAaJ,GAAGC,GAAH,CAAOC,YAAP,CAAoBG,OAApB,CAA4BpB,UAA5B,CAAjB;AACA,MAAI,CAACmB,UAAL,EAAgB;AACZ,UAAO,KAAP;AACH;AACDA,eAAaE,KAAKC,KAAL,CAAWH,UAAX,CAAb;AACA,MAAI,CAACA,WAAWP,cAAX,CAA0BV,MAA1B,CAAL,EAAuC;AACnC,UAAO,KAAP;AACH;AACD,SAAO,IAAP;AACH,EAlRuC;;AAoRxC0B,2BAAyB,kCAAStB,MAAT,EAAiBJ,MAAjB,EAAwB;;AAE7CI,WAASA,OAAOC,QAAP,EAAT;AACA,MAAIY,aAAaJ,GAAGC,GAAH,CAAOC,YAAP,CAAoBG,OAApB,CAA4Bd,MAA5B,CAAjB;AACA,MAAI,CAACa,UAAL,EAAgB;AACZ,UAAO,KAAP;AACH;AACDA,eAAaE,KAAKC,KAAL,CAAWH,UAAX,CAAb;AACA,MAAI,CAACA,WAAWP,cAAX,CAA0B,KAAKjB,UAA/B,CAAL,EAAgD;AAC5C,UAAO,KAAP;AACH;AACD,MAAI+B,iBAAiBP,WAAW,KAAKxB,UAAhB,CAArB;;AAEA,SAAO+B,eAAed,cAAf,CAA8BV,MAA9B,CAAP;AACH,EAlSuC;;AAoSxC;AACA;;;;;AAKA2B,SAAO,gBAAS7B,UAAT,EAAoB;AACvBe,KAAGC,GAAH,CAAOC,YAAP,CAAoBa,UAApB,CAA+B9B,UAA/B;AACH;;AA5SuC,CAArB,CAAvB;;AAiTA,IAAI+B,qBAAqB,IAAzB;;AAEA;;;AAGAC,QAAQC,QAAR,GAAmB,YAAU;AACzB,KAAG,CAACF,kBAAJ,EAAuB;AACnBA,uBAAqB,IAAIzC,gBAAJ,EAArB;AACH;AACD,QAAOyC,kBAAP;AACH,CALD","file":"LocalDataManager.js","sourceRoot":"..\\..\\..\\..\\..\\assets\\script\\common","sourcesContent":["/*\r\n    本地数据库管理器\r\n*/\r\nvar app = require(\"pdk_app\");\r\n\r\nvar LocalDataManager = app.BaseClass.extend({\r\n\r\n    Init:function(){\r\n        this.JS_Name = \"LocalDataManager\";\r\n\r\n        //暂时只有一个区\r\n        this.linkServer = \"Server01\";\r\n\r\n\t    //通用属性初始化字典\r\n\t    this.InitDataDict = {\r\n\t\t\t\t\t\t\t    \"SysSetting\":{\r\n\t\t\t\t\t\t\t    \t\t\t\t\"MainBackMusic\":'MainScene',\r\n\t\t\t\t\t\t\t    \t\t\t\t\"GameBackMusic\":'gameBackGround',\r\n\t\t\t\t\t\t\t\t\t\t\t    \"BackMusic\":1,\r\n\t\t\t\t\t\t\t\t\t\t\t    \"SpSound\":1,\r\n\t\t\t\t\t\t\t\t\t\t\t    \"BackVolume\":1,\r\n\t\t\t\t\t\t\t\t\t\t\t    \"SpVolume\":1,\r\n\t\t\t\t\t\t\t\t\t\t\t    \"IsShowChat\":1,\r\n\t\t\t\t\t\t\t\t\t\t\t    \"IsPlayVideo\":1,\r\n\t\t\t\t\t\t\t\t\t\t\t    \"TuiGuangUrl\":'',\r\n\t\t\t\t\t\t\t\t\t\t\t\t\"Language\":1,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\"IsAudio\":1,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\"QianDao\":0,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\"is3DShow\":0,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\"pdk_GameBg\":4,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\"Date\":-1,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\"LastGameType\":'',\r\n\t\t\t\t\t\t\t\t\t\t    },\r\n\t\t\t\t\t\t\t    \"Account\":{\r\n\t\t\t\t\t\t\t\t\t\t    \"AccountDict\":{},\r\n\t\t\t\t\t\t\t\t\t\t    \"AccountList\":[],\r\n\t\t\t\t\t\t\t\t\t\t    \"AccountActive\":0,\r\n\t\t\t\t\t\t\t\t\t\t    \"AccessPoint\":0,\r\n\t\t\t\t\t\t\t\t\t\t    \"AccessTokenInfo\":{},\r\n\t\t\t\t\t\t\t\t\t\t    \"AccountID\":0,\r\n\t\t\t\t\t\t\t\t\t\t    \"uuid\":0,\r\n\t\t\t\t\t\t\t\t\t    },\r\n\t\t                        \"DebugInfo\":{\r\n\t\t\t                        \"GateServerInfo\":{},\r\n\t\t\t                        \"AccountServerInfo\":{},\r\n\t\t\t                        \"OrderServerInfo\":{},\r\n\t\t\t                        \"GameServerInfo\":{},\r\n\t\t\t                        \"ResServerInfo\":{},\r\n\t\t                        },\r\n\t\t\t\t\t\t    };\r\n\r\n\t    //玩家个人属性初始化字典\r\n\t    this.PlayerInitData = {\r\n\t\t\t\t\t\t\t    \"EventIDList\":[],\r\n\t\t\t\t\t\t\t    \"OrderDict\":{},\r\n\t\t\t\t\t\t    };\r\n\t\t//创建房间字典\t\t\t\t    \r\n\r\n        this.InitConfig();\r\n\r\n        // this.Log(\"Init\");\r\n    },\r\n\r\n    //切换账号\r\n    OnReload:function(){\r\n    },\r\n\r\n    /**\r\n     * 初始化配置\r\n     */\r\n    InitConfig:function(){\r\n\r\n\t    for(var configName in this.InitDataDict){\r\n\t\t    var optionData = this.InitDataDict[configName];\r\n\t\t    for(var option in optionData){\r\n\t\t\t    if (this.HaveConfigProperty(configName, option)){\r\n\t\t\t\t    continue\r\n\t\t\t    }\r\n\t\t\t    this.SetConfigProperty(configName, option, optionData[option]);\r\n\t\t    }\r\n\t    }\r\n    },\r\n\r\n    /**\r\n     * 初始化配置\r\n     */\r\n    PlayerLogin:function(heroID){\r\n\r\n    \theroID = heroID.toString();\r\n\r\n    \t//初始化\r\n        if (!this.HaveConfigProperty(heroID, this.linkServer)){\r\n            this.SetConfigProperty(heroID, this.linkServer, {});\r\n        }\r\n\r\n        let playerDataDict = this.GetConfigProperty(heroID, this.linkServer);\r\n        //初始化失败\r\n        if(!playerDataDict){\r\n        \tthis.ErrLog(\"PlayerLogin(%s) fail\", heroID);\r\n            return\r\n        }\r\n\r\n\t    for(var property in this.PlayerInitData){\r\n\t\t    if(!playerDataDict.hasOwnProperty(property)){\r\n\t\t\t    playerDataDict[property] = this.PlayerInitData[property];\r\n\t\t    }\r\n\t    }\r\n        this.SetConfigProperty(heroID, this.linkServer, playerDataDict);\r\n\r\n    },\r\n\r\n\r\n    //--------------------------获取接口----------------------------------\r\n    /**\r\n     * 获取配置值\r\n     * @param configName\r\n     * @param option\r\n     * @param value\r\n     */\r\n    SetConfigProperty:function(configName, option, value){\r\n\r\n\t    let canUse = cc.sys.localStorage.CanUse;\r\n\r\n\t    let configInfo = {};\r\n\t    if(canUse){\r\n\t\t    configInfo = cc.sys.localStorage.getItem(configName)\r\n\t\t    if (configInfo){\r\n\t\t\t    configInfo = JSON.parse(configInfo);\r\n\t\t    }\r\n\t\t    //如果没有初始化\r\n\t\t    else{\r\n\t\t\t    configInfo = {};\r\n\t\t    }\r\n\r\n\t\t    configInfo[option] = value;\r\n\r\n\t\t    //如果多开客户端，会出现数据不能被保存，因为底层只接受一个数据连接请求\r\n\t\t    cc.sys.localStorage.setItem(configName, JSON.stringify(configInfo));\r\n\t    }\r\n\t    else{\r\n\t\t    configInfo = this.InitDataDict[configName];\r\n\t\t    if(!configInfo){\r\n\t\t\t    this.ErrLog(\"SetConfigProperty not find(%s)\", configName);\r\n\t\t\t    return false\r\n\t\t    }\r\n\t\t    configInfo[option] = value;\r\n\t    }\r\n\r\n\r\n        return true;\r\n    },\r\n\r\n    /**\r\n     * 获取玩家登录服务器本地数据\r\n     * @param configName\r\n     * @param option\r\n     */\r\n    SetPlayerConfigProperty:function(heroID, option, value){\r\n\t    heroID = heroID.toString();\r\n\r\n\t    let canUse = cc.sys.localStorage.CanUse;\r\n\t    if(canUse){\r\n\r\n\t\t    let configInfo = cc.sys.localStorage.getItem(heroID)\r\n\t\t    if (configInfo){\r\n\t\t\t    configInfo = JSON.parse(configInfo);\r\n\t\t    }\r\n\t\t    else{\r\n\t\t\t    configInfo = {};\r\n\t\t    }\r\n\r\n\t\t    //如果没有服务器数据,则初始化\r\n\t\t    if(!configInfo.hasOwnProperty(this.linkServer)){\r\n\t\t\t    configInfo[this.linkServer] = {};\r\n\t\t    }\r\n\r\n\t\t    let serverDataDict = configInfo[this.linkServer];\r\n\t\t    serverDataDict[option] = value;\r\n\r\n\t\t    //如果多开客户端，会出现数据不能被保存，因为底层只接受一个数据连接请求\r\n\t\t    cc.sys.localStorage.setItem(heroID, JSON.stringify(configInfo));\r\n\t    }\r\n\t    else{\r\n\t\t    this.PlayerInitData[option] = value;\r\n\t    }\r\n\r\n        return true;\r\n\r\n    },\r\n\r\n    //--------------------------设置接口----------------------------------\r\n    /**\r\n     * 设置配置值\r\n     * @param configName\r\n     * @param option\r\n     */\r\n    GetConfigProperty:function(configName, option){\r\n\t    configName = configName.toString();\r\n\r\n\t    let canUse = cc.sys.localStorage.CanUse;\r\n\r\n        let configInfo = {};\r\n\t\tif(canUse){\r\n\t\t\tconfigInfo = cc.sys.localStorage.getItem(configName);\r\n\t\t\tif (configInfo){\r\n\t\t\t\tconfigInfo = JSON.parse(configInfo);\r\n\t\t\t}\r\n\t\t}\r\n\t\t//可能运行环境没有支持localStorage,则取默认字典数据\r\n\t    else{\r\n\t\t\tconfigInfo = this.InitDataDict[configName];\r\n\t\t\tthis.ErrLog(\"GetConfigProperty fail, configName:%s option:%s is not find\", configName, option);\r\n\t\t}\r\n\r\n\t    if(!configInfo){\r\n\t\t    this.ErrLog(\"GetConfigProperty(%s,%s)\", configName, option);\r\n\t\t    return\r\n\t    }\r\n\r\n        if (!configInfo.hasOwnProperty(option)){\r\n            this.ErrLog(\"GetConfigProperty fail, not find the option:%s\", option);\r\n            return;\r\n        }\r\n\r\n        return configInfo[option]\r\n    },\r\n\r\n    /**\r\n     * 获取玩家登录服务器本地数据\r\n     * @param configName\r\n     * @param option\r\n     */\r\n    GetPlayerConfigProperty:function(heroID, option){\r\n\r\n        heroID = heroID.toString();\r\n\t    let canUse = cc.sys.localStorage.CanUse;\r\n\t    let serverDataDict = {};\r\n\r\n\t    if(canUse){\r\n\t\t    let configInfo = cc.sys.localStorage.getItem(heroID)\r\n\t\t    if (configInfo){\r\n\t\t\t    configInfo = JSON.parse(configInfo);\r\n\t\t\t    if (!configInfo.hasOwnProperty(this.linkServer)){\r\n\t\t\t\t    this.ErrLog(\"GetPlayerConfigProperty(%s) fail, not find the linkServer:%s\", heroID, this.linkServer);\r\n\t\t\t\t    return;\r\n\t\t\t    }\r\n\t\t\t    serverDataDict = configInfo[this.linkServer]\r\n\t\t    }\r\n\t    }\r\n\t    else{\r\n\t\t    serverDataDict = this.PlayerInitData;\r\n\t\t    this.ErrLog(\"GetPlayerConfigProperty fail, heroID:%s option:%s is not find\", heroID, option);\r\n\t    }\r\n\r\n        if(!serverDataDict.hasOwnProperty(option)){\r\n            this.ErrLog(\"GetPlayerConfigProperty(%s,%s) not find %s\", heroID, this.linkServer, option);\r\n            return\r\n        }\r\n\r\n        return serverDataDict[option];\r\n    },\r\n\r\n    //--------------------------判断接口----------------------------------\r\n    /**\r\n     * 判断是否存在配置值\r\n     * @param configName\r\n     * @param option\r\n     */\r\n    HaveConfigProperty:function(configName, option){\r\n\r\n        let configInfo = cc.sys.localStorage.getItem(configName)\r\n        if (!configInfo){\r\n            return false;\r\n        }\r\n        configInfo = JSON.parse(configInfo);\r\n        if (!configInfo.hasOwnProperty(option)){\r\n            return false;\r\n        }\r\n        return true;\r\n    },\r\n\r\n    HavePlayerConfigProperty:function(heroID, option){\r\n\r\n        heroID = heroID.toString();\r\n        let configInfo = cc.sys.localStorage.getItem(heroID)\r\n        if (!configInfo){\r\n            return false;\r\n        }\r\n        configInfo = JSON.parse(configInfo);\r\n        if (!configInfo.hasOwnProperty(this.linkServer)){\r\n            return false;\r\n        }\r\n        let serverDataDict = configInfo[this.linkServer];\r\n\r\n        return serverDataDict.hasOwnProperty(option);\r\n    },\r\n\r\n    //--------------------------操作接口----------------------------------\r\n    /**\r\n     * 删除配置值\r\n     * @param configName\r\n     * @param option\r\n     */\r\n    Remove:function(configName){\r\n        cc.sys.localStorage.removeItem(configName);\r\n    },\r\n\r\n});\r\n\r\n\r\nvar g_LocalDataManager = null;\r\n\r\n/**\r\n * 绑定模块外部方法\r\n */\r\nexports.GetModel = function(){\r\n    if(!g_LocalDataManager){\r\n        g_LocalDataManager = new LocalDataManager();\r\n    }\r\n    return g_LocalDataManager;\r\n}"]}