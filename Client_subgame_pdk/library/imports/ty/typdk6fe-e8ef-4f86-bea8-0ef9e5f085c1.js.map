{"version":3,"sources":["..\\..\\..\\..\\assets\\script/assets\\script\\pdk_ClientManager.js"],"names":["app","require","subGameName","pdk_ClientManager","cc","Class","extends","properties","globalEffect","Node","reConnectTip","onLoad","console","log","JS_Name","logSecond","isWriteLog","sys","isNative","game","addPersistRootNode","node","StartTimer","schedule","OnTimer","systemEvent","on","SystemEvent","EventType","KEY_DOWN","OnKeyDown","ShareDefineModel","GetModel","pdk_ShareDefine","ComToolModel","pdk_ComTool","ControlManagerModel","pdk_ControlManager","localStorage","setItem","testData","getItem","CanUse","removeItem","ErrLog","LocalDataManagerModel","LocalDataManager","NativeManagerModel","NativeManager","clientState","State_Prepare","nextTick","lastHearTime","LostHearTime","isFaXinTiao","isFirstLogin","debugModel","lastReConnectTime","reConnectUseTime","bStartReConnect","reConnectLable","getChildByName","getComponent","Label","startUpInfo","clientConfig","gameType","InitLaunchParameter","isAllReadyRelogin","InitDebug","isDebug","IsDevelopment","debugPrefab","debugNode","instantiate","OnCreate","error","stack","para","CallToNative","href","window","location","index","indexOf","substr","paraList","length","split","count","paraInfo","paraDataList","OnPack_LuckDrawReceive","serverPack","OnEvent","OnPack_HeartBeat","Date","getTime","bBeatFlag","SendPack","SpeedTest","bind","yanci","OnPack_BaseLogin","HeroAccountManager","accountID","GetAccountProperty","nickName","headImageUrl","sex","InitLoginData","NetManager","InitConnectAccountID","GetHeroID","OnPack_RoleTest","SetAccountProperty","OnPack_OnHeroLogin","heroID","State_Logined","State_LoginPackFail","ShowSysMsg","OnPack_PlayerInfo","OnEvent_InitPlayerFamily","event","SendGetCurRoomID","SetGameType","typeStr","OnEvent_LoginGetCurRoomID","roomID","allSwitchGameData","switchGameData","push","JSON","parse","isShowVideo","i","action","FormManager","ShowForm","fromName","LoadScene","practiceId","roomKey","that","toUpperCase","OnStartEnterGame","SendGetRoomInfo","OnEvent_ConnectSuccess","bIsReconnect","OnPack_GetGameStatus","isPlayingGame","SceneManager","sceneType","GetSceneType","ExitGame","OnEvent_ReloadHeroData","eventName","OnPack_Kickout","kickOutType","LogOutGame","OnPack_Online","onlineHour","OnNativeNotify","eventType","eventDataString","dataDict","OnNativeNotifyWXLogin","OnNativeNotifyWXShare","OnNativeNotifyWXPay","OnDownLoadEvent","OnGetLocationCallBack","update","dt","passSecond","State_WaitLogin","curTime","isConnectIng","Disconnect","StartReConnect","ReConnectByTipSureBtn","string","StopTimer","unschedule","OnEventHide","curRunGame","OnEventShow","scheduleOnce","OnInitClientData","clientPath","appVersion","State_InitSuccess","OnInitClientFinish","allTableDataDict","RefreshClientConfig","debug","CheckDebugSign","InitModel","InitTable","InitManager","dump","e","LoadLogin","ClientLoginProcess","SendRequestWeChatSDKIntSign","dbGameServerInfo","GetConfigProperty","dbAccountServerInfo","dbOrderServerInfo","dbResServerInfo","gameServerIP","gameServerPort","accountServerIP","accountServerPort","orderServerIP","orderServerPort","resServerIP","resServerPort","accountType","orderType","AccountSDKTypeNameDict","hasOwnProperty","SDKType_Company","OrderSDKTypeNameDict","OrderType_Company","ddmchannel","ddmmp","SDKType_WeChat","OrderType_Wechat","modelName","NeedCreateList","SysDataManager","allTableNameList","Object","keys","tableName","tableInfo","OnLoadTableEnd","startUrl","origin","SetH5ClientStartUrl","RegNetPack","OnEvent_SPlayerContinue","RegEvent","InitSDKParameter","argDict","emit","userName","shortPlayer","name","paymentRoomCardType","func","target","UnRegTargetEvent","off","targetOff","keyCode","KEY","back","msgID","ConfirmManager","SetWaitForConfirmForm","OnConFirm","ShowConfirm","Confirm","clickType","backArgList","end","IsClientLoginOK","SetClientState","code","SetConfigProperty","GetSceneComponent","WarnLog","OnTopEvent","ClearClientData","OnReload","debugSign","argKeyList","sort","keyCount","signString","keyName","join","sign","MD5","hex_md5","GetDebugModel","MultiPoint","serverIP","GetClientConfigProperty","AccessPoint","AccountActive","myCityID","CityPoints","CityPointsList","GetClientConfig","mt","key","InArray","property","GetStartUpProperty","GetGlobalEffectNode","effectName","effectNode","removeFromParent","PushGlobalEffectNode","addChild","GetIsFirstLogin","SetFirstLogin","active","CloseReConnectTip","RemoveClientManager","loadFormDict","showFormDict","createingFormDict","formWndShowInfo","defaultFormNameList","ReleaseAllRes","removePersistRootNode","baseForm","_eventFuncDict","destroy","isInGame","isOutRoom","EVENT_HIDE","EVENT_SHOW","roomMgr","clubId","unionId","stringify","curRunHall","StopAllSound","gamePath","jsb","fileUtils","getWritablePath","module","exports"],"mappings":"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","file":"pdk_ClientManager.js","sourceRoot":"..\\..\\..\\..\\assets\\script","sourcesContent":["/*\r\n    客户端初始化管理类(该组件节点不会被释放)\r\n*/\r\n\r\nvar app = require(\"pdk_app\");\r\nrequire(app.subGameName + \"_NativeNotify\");\r\nvar pdk_ClientManager = cc.Class({\r\n\r\n    extends: require(app.subGameName + \"_BaseComponent\"),\r\n\r\n    properties: {\r\n    \tglobalEffect:cc.Node,\r\n\t    reConnectTip:cc.Node,\r\n    },\r\n    // 加载JS主入口\r\n    onLoad: function () {\r\n    \tconsole.log(app.subGameName + \" ----- ClientManager onLoad-----\");\r\n        this.JS_Name = app.subGameName + \"_ClientManager\";\r\n\r\n\t    this.logSecond = 0;\r\n\t    //是否需要写log\r\n\t    this.isWriteLog = cc.sys.isNative;\r\n\r\n        //保证客户端管理器不被释放\r\n        cc.game.addPersistRootNode(this.node);\r\n\r\n        this.StartTimer();\r\n\r\n        this.schedule(this.OnTimer, 0.1);\r\n\r\n        cc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN, this.OnKeyDown, this);\r\n\r\n        //把Client存放到App上\r\n        app[app.subGameName + \"Client\"] = this;\r\n\r\n\t\t//枚举管理器\r\n\t    let ShareDefineModel = require(app.subGameName + \"_ShareDefine\").GetModel;\r\n\t    app[app.subGameName + \"_ShareDefine\"] = ShareDefineModel;\r\n        this.pdk_ShareDefine = ShareDefineModel();\r\n\r\n\t    //工具模块\r\n\t    let ComToolModel = require(app.subGameName + \"_ComTool\").GetModel;\r\n\t    app[app.subGameName + \"_ComTool\"] = ComToolModel;\r\n\t    this.pdk_ComTool = ComToolModel();\r\n\r\n\t    //加载控制器\r\n\t    let ControlManagerModel = require(app.subGameName + \"_ControlManager\").GetModel;\r\n\t    app[app.subGameName + \"_ControlManager\"] = ControlManagerModel;\r\n\t    this.pdk_ControlManager = ControlManagerModel();\r\n\r\n\t    //检测是否可以使用localStorage,有的浏览器没有\r\n\t    var localStorage = cc.sys.localStorage;\r\n\t    localStorage.setItem(\"testStorage\", \"1\");\r\n\t    var testData = localStorage.getItem(\"testStorage\");\r\n\t    if(testData){\r\n\t\t    cc.sys.localStorage.CanUse  = 1;\r\n\t\t    localStorage.removeItem(\"testStorage\");\r\n\t    }\r\n\t    else{\r\n\t\t    cc.sys.localStorage.CanUse  = 0;\r\n\t\t    this.ErrLog(\"cant use sys.localStorage\");\r\n\t    }\r\n\r\n\t    //本地数据管理器\r\n\t    let LocalDataManagerModel = require(\"LocalDataManager\").GetModel;\r\n\t    app[\"LocalDataManager\"] = LocalDataManagerModel;\r\n\t    this.LocalDataManager = LocalDataManagerModel();\r\n\r\n\t    //js调用native平台接口管理器(启动需要获取客户端app启动携带参数)\r\n\t    let NativeManagerModel = require(app.subGameName + \"_NativeManager\").GetModel;\r\n\t    app[app.subGameName + \"_NativeManager\"] = NativeManagerModel;\r\n\t    this.NativeManager = NativeManagerModel();\r\n\r\n        //客户端初始化\r\n        this.clientState = this.pdk_ShareDefine.State_Prepare;\r\n\r\n        //定时器下次执行时间\r\n        this.nextTick = 0;\r\n\r\n        //心跳\r\n        this.lastHearTime = 0;\r\n        this.LostHearTime = 0;\r\n        this.isFaXinTiao=false;\r\n\t    this.isFirstLogin = true;\r\n\r\n\t    this.debugModel = null;\r\n\r\n\t    //重连计时\r\n\t    this.lastReConnectTime = 0;\r\n\t    this.reConnectUseTime = 0;\r\n\t    this.bStartReConnect = false;\r\n\t    this.reConnectLable = this.reConnectTip.getChildByName('sp_info').getChildByName('lb_info').getComponent(cc.Label);\r\n\t    /*{\r\n\t\t    //分享携带的roomkey\r\n\t\t\t\"shareRoomKey\":\"\",\r\n\t    }*/\r\n\t    //启动携带参数\r\n\t    this.startUpInfo = {};\r\n\r\n\t    //客户端配置字典\r\n\t    this.clientConfig = {};\r\n\r\n\t    this.gameType = -1;\r\n\r\n        this.InitLaunchParameter();\r\n        \r\n        //this.loadapkpro = 0.0f;\r\n        //\r\n        this.isAllReadyRelogin = false;\r\n    },\r\n\r\n\t//debug初始化\r\n\tInitDebug:function(isDebug){\r\n\r\n\t\tif(isDebug){\r\n\t\t\t// this.LogManager.IsOpenLog(true);\r\n\t\t\tthis.pdk_ShareDefine.IsDevelopment = 1;\r\n\t\t\ttry{\r\n\t\t\t\tif(this.debugPrefab && !this.debugModel){\r\n\t\t\t\t\tlet debugNode = cc.instantiate(this.debugPrefab);\r\n\t\t\t\t\tthis.debugModel = debugNode.getComponent(\"DebugLayer\");\r\n\t\t\t\t\tthis.debugModel.OnCreate()\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tcatch (error){\r\n\t\t\t\tthis.ErrLog(\"create debug error:%s\", error.stack);\r\n\t\t\t\tthis.debugModel = null;\r\n\t\t\t}\r\n\t\t}\r\n\t\telse{\r\n\t\t\t// this.LogManager.IsOpenLog(false);\r\n\t\t\tthis.pdk_ShareDefine.IsDevelopment = 0;\r\n\t\t}\r\n\r\n\t},\r\n\r\n    //启动参数\r\n    InitLaunchParameter:function(){\r\n\t    let para = \"\";\r\n\r\n\t    //如果是native版本获取应用启动携带参数\r\n        if(cc.sys.isNative){\r\n\t        para = app[app.subGameName + \"_NativeManager\"]().CallToNative(\"GetQuery\", [], \"String\");\r\n\t        if(!para){\r\n\t\t        para = \"\";\r\n\t        }\r\n        }\r\n        //如果是H5版本\r\n\t    else{\r\n\t        //浏览器信息\r\n\t        //let navigator = window.navigator;\r\n\t        //let userAgent = navigator.userAgent;\r\n\t        let href  = window.location.href;\r\n\t        let index = href.indexOf(\"?\");\r\n\t        if(index > -1){\r\n\t\t        //\"?ddmchannel=dangle&ddmgameid=p1&appId=50059&cpToken=6aacddfec66b4ba2a1728b235d2c5716\"\r\n\t\t        para = href.substr(index + 1);\r\n\t        }\r\n        }\r\n\r\n\t    let paraList = [];\r\n\t    if(para.length){\r\n\t\t    paraList = para.split(\"&\");\r\n\t    }\r\n        let count = paraList.length;\r\n\r\n        for(let index=0; index<count; index++){\r\n            let paraInfo = paraList[index];\r\n            let paraDataList = paraInfo.split(\"=\");\r\n            if(paraDataList.length != 2){\r\n                this.ErrLog(\"InitLaunchParameter paraInfo:%s error\", paraInfo);\r\n                continue\r\n            }\r\n            this.startUpInfo[paraDataList[0]] = paraDataList[1];\r\n        }\r\n    },\r\n\r\n    //-----------------封包函数-------------------------\r\n    OnPack_LuckDrawReceive:function(serverPack){\r\n    \tthis.OnEvent(\"OnChouJiangLingQu\", serverPack);\r\n    },\r\n    //心跳包\r\n    OnPack_HeartBeat: function(serverPack) {\r\n        this.lastHearTime = new Date().getTime();\r\n        this.LostHearTime = new Date().getTime();\r\n        if (serverPack.bBeatFlag) {\r\n        \tapp[app.subGameName + \"_NetManager\"]().SendPack(\"heartBeat.CHeartBeatHandler\", {\"strBeatMessage\":\"\",\"lBeatTime\":this.lastHearTime,\"bBeatFlag\":true},this.SpeedTest.bind(this),this.SpeedTest.bind(this));\r\n        }\r\n    },\r\n    //网速检测\r\n    SpeedTest:function(serverPack){\r\n    \tthis.isFaXinTiao=false;\r\n    \tlet yanci=new Date().getTime()-this.lastHearTime;\r\n    \tthis.OnEvent(\"EvtSpeedTest\", {\"yanci\":yanci});\r\n    },\r\n\t//1:账号登录成功\r\n\tOnPack_BaseLogin:function(serverPack){\r\n\t\tconsole.log(\"账号登录成功\");\r\n\t\tlet HeroAccountManager = app[app.subGameName + \"_HeroAccountManager\"]();\r\n\t\tlet accountID = HeroAccountManager.GetAccountProperty(\"AccountID\");\r\n\t\tlet nickName = HeroAccountManager.GetAccountProperty(\"NickName\");\r\n\t\tlet headImageUrl = HeroAccountManager.GetAccountProperty(\"HeadImageUrl\");\r\n\t\tlet sex = HeroAccountManager.GetAccountProperty(\"Sex\");\r\n\r\n\t\tapp[app.subGameName + \"_ServerTimeManager\"]().InitLoginData(serverPack);\r\n\r\n\t\tlet NetManager = app[app.subGameName + \"_NetManager\"]();\r\n\r\n\t\t//连接已经建立,初始化连接的玩家账号ID\r\n\t\tNetManager.InitConnectAccountID(accountID);\r\n\r\n\t\t//如果客户端已经有玩家数据了,为重连回包,不需要发送登录封包,只需要同步一次玩家属性,因为有可能变化了属性\r\n\t\tif(app[app.subGameName + \"_HeroManager\"]().GetHeroID()){\r\n\t\t\tconsole.log(\"玩家数据已经存在\");\r\n\t\t\tNetManager.SendPack(\"base.C1005PlayerInfo\", {});\r\n\t\t}\r\n\t\telse{\r\n\t\t\tif(serverPack[\"isNeedCreateRole\"]){\r\n\t\t\t\tconsole.log(\"创建新角色\");\r\n\t\t\t\tNetManager.SendPack(\"base.C1001CreateRole\", {\"nickName\":nickName, \"sex\":sex, \"headImageUrl\":headImageUrl, \"accountID\":accountID});\r\n\t\t\t}\r\n\t\t\telse{\r\n\t\t\t\tconsole.log(\"登录已有账号\");\r\n\t\t\t\tNetManager.SendPack(\"base.C1006RoleLogin\", {\"accountID\":accountID});\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t},\r\n\t//服务端随机下发一个游客账号，直接登录就可以\r\n\tOnPack_RoleTest:function(serverPack){\r\n\t\tapp[app.subGameName + \"_HeroAccountManager\"]().SetAccountProperty(\"reloginSign\", serverPack[\"sign\"]);\r\n\t\tapp[app.subGameName + \"_NetManager\"]().SendPack(\"base.C1006RoleLogin\", {\"accountID\":serverPack[\"accountID\"]});\r\n\t},\r\n\r\n    //2:玩家登陆初始化\r\n    OnPack_OnHeroLogin:function(serverPack){\r\n\r\n        try{\r\n        \tif (this.isAllReadyRelogin) {\r\n\t\t\t\tconsole.log(\"已经初始化玩家数据，重复初始化导致报错...\");\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tthis.isAllReadyRelogin = true;\r\n\t        let heroID = serverPack[\"pid\"];\r\n\t        this.gameType = serverPack[\"currentGameType\"];\r\n\t        \r\n            app[app.subGameName + \"_HeroManager\"]().InitLoginData(heroID, serverPack);\r\n            app[app.subGameName + \"_ServerTimeManager\"]().InitLoginData(serverPack);\r\n            app[app.subGameName + \"_HeroAccountManager\"]().SetAccountProperty(\"AccountID\", serverPack[\"accountID\"]);\r\n            this.clientState = this.pdk_ShareDefine.State_Logined;\r\n        }\r\n        catch(error){\r\n            this.ErrLog(\"OnPack_OnHeroLogin(%s):%s\", serverPack, error.stack);\r\n            this.clientState = this.pdk_ShareDefine.State_LoginPackFail;\r\n            app[app.subGameName + \"_SysNotifyManager\"]().ShowSysMsg(\"Code_Login_PackFail\");\r\n        }\r\n    },\r\n\r\n\tOnPack_PlayerInfo:function(serverPack){\r\n\t\ttry{\r\n\t\t\tlet heroID = serverPack[\"pid\"];\r\n\t\t\tapp[app.subGameName + \"_HeroManager\"]().InitLoginData(heroID, serverPack);\r\n\t\t}\r\n\t\tcatch(error){\r\n\t\t\tthis.ErrLog(\"OnPack_PlayerInfo(%s):%s\", serverPack, error.stack);\r\n\t\t}\r\n\t},\r\n\r\n\t//3:请求玩家工会数据\r\n\tOnEvent_InitPlayerFamily:function(event){\r\n\t\t//请求玩家进入的房间ID\r\n\t\tapp[app.subGameName + \"_GameManager\"]().SendGetCurRoomID();\r\n\t},\r\n\tSetGameType:function(typeStr){\r\n\t\tif(app.subGameName == typeStr)\r\n\t\t\tthis.gameType = 40;\r\n\t\telse\r\n\t\t\tthis.gameType = -1;\r\n\t},\r\n\t//4:登录获取玩家当前参与的房间ID\r\n\tOnEvent_LoginGetCurRoomID:function(event){\r\n\t\tlet serverPack = event;\r\n\t\tlet roomID = serverPack.roomID;\r\n\t\tconsole.log(\"登录获取玩家当前参与的房间ID:\" + roomID);\r\n\t\t//返回大厅检测下是否有需要处理的数据\r\n        let allSwitchGameData = [];\r\n        let switchGameData = cc.sys.localStorage.getItem(\"switchGameData\");\r\n        if (switchGameData != \"\") {\r\n            allSwitchGameData.push(JSON.parse(switchGameData));\r\n        }\r\n        let isShowVideo = false;\r\n        for (let i = 0; i < allSwitchGameData.length; i++) {\r\n        \tif (!allSwitchGameData[i]) continue;\r\n            console.log(\"allSwitchGameData[i].action\");\r\n            let action = allSwitchGameData[i].action;\r\n            switch(action){\r\n                case 'showForm':\r\n                    this.FormManager.ShowForm(allSwitchGameData[i].fromName);\r\n                    break;\r\n                case 'showVideo':\r\n                \tisShowVideo = true;\r\n                    app[app.subGameName + \"_SceneManager\"]().LoadScene(app.subGameName + \"VideoScene\");\r\n                    break;\r\n                default:\r\n                    console.log('未知动作: ' + action);\r\n                    break;\r\n            }\r\n        }\r\n        if (isShowVideo) {\r\n        \t//正在播放回放\r\n        \treturn;\r\n        }\r\n\r\n\t\tif('practiceId' in serverPack)\r\n\t\t\tapp[app.subGameName + \"_ShareDefine\"]().practiceId = serverPack.practiceId;\r\n\t\tif(roomID == 0){\r\n\t\t\t//如果启动参数传递房间号，则尝试进入房间\r\n\t\t\tif(this.startUpInfo['room_id']){\r\n\t\t\t\tlet roomKey=this.startUpInfo['room_id'];\r\n\t\t\t\tlet that = this;\r\n\t\t\t\tapp[app.subGameName + \"_NetManager\"]().SendPack(app.subGameName + \".C\" + app.subGameName.toUpperCase() + \"EnterRoom\", {\"roomKey\":roomKey,\"posID\":-1}, function(){}, function(event){\r\n                \tthat.OnStartEnterGame(\"enterMain\");\r\n            \t});\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tthis.OnStartEnterGame(\"enterMain\");\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tlet that = this;\r\n\t\t//进入房间\r\n\t\tapp[app.subGameName.toUpperCase()+\"RoomMgr\"]().SendGetRoomInfo(roomID, function(){\r\n\t\t\tthat.OnStartEnterGame(\"enterRoom\");\r\n\t\t});\r\n\t},\r\n\tOnEvent_ConnectSuccess:function(event){\r\n\t\tlet serverPack = event;\r\n\t\tlet bIsReconnect = serverPack['IsReconnecting'];\r\n\t\tif(bIsReconnect){\r\n\t\t\tapp[app.subGameName + \"_NetManager\"]().SendPack(\"game.CGetGameStatus\", {});\r\n\t\t}\r\n\t},\r\n\t//断线重连状态同步\r\n\tOnPack_GetGameStatus:function(serverPack){\r\n\t\tlet isPlayingGame = serverPack['isPlayingGame'];\r\n\t\tthis.gameType = serverPack['gameType'];\r\n\t\tlet roomID=serverPack['roomID'];\r\n\t\tif(isPlayingGame){//游戏中\r\n\t\t\tlet event = {};\r\n\t\t\tevent = {};\r\n\t\t\tevent.roomID = roomID;\r\n\t\t\tthis.OnEvent_LoginGetCurRoomID(event);\r\n\t\t}\r\n\t\telse{//跳转大厅\r\n\t\t\tlet SceneManager = app[app.subGameName + \"_SceneManager\"]();\r\n        \tlet sceneType = SceneManager.GetSceneType();\r\n\t        //如果已经在登录场景则不切换\r\n\t        if('mainScene' != sceneType)\r\n\t\t\t\tthis.ExitGame();\r\n\t\t}\r\n\t},\r\n\tOnEvent_ReloadHeroData:function(event){\r\n\t\tif (cc.sys.isNative) {\r\n\t\t\tapp[app.subGameName + \"_NetManager\"]().SendPack(\"game.C1101GetRoomID\", {});\r\n\t\t}else{\r\n\t\t\tthis.ExitGame();\r\n\t\t}\r\n\t},\r\n\t//开始进入游戏\r\n\tOnStartEnterGame:function(eventName){\r\n\t\tthis.clientState = this.pdk_ShareDefine.State_Logined;\r\n\r\n\t\tif(eventName == \"enterMain\"){\r\n\t\t\t//进入主场景\r\n\t\t\tconsole.log(\"进入主场景\");\r\n\t\t\tthis.ExitGame();\r\n\t\t}\r\n\r\n\t\tthis.OnEvent(\"PlayerLoginOK\", {});\r\n\t},\r\n\r\n\t//被ti\r\n\tOnPack_Kickout:function(serverPack){\r\n\t\tlet kickOutType = serverPack[\"type\"];\r\n\r\n\t\tif(kickOutType == 2){\r\n\t\t\tthis.LogOutGame(-1);\r\n\t\t}\r\n\t\telse{\r\n\t\t\tthis.ErrLog(\"OnPack_Kickout kickOutType:%s not find\", kickOutType);\r\n\t\t}\r\n\t},\r\n\r\n    //提醒玩家在线时长\r\n    OnPack_Online:function(serverPack){\r\n         app[app.subGameName + \"_SysNotifyManager\"]().ShowSysMsg(\"MSG_TIME_ONLINE\",[serverPack.onlineHour]);\r\n    },\r\n\r\n\t//-----------------回调函数-------------------------\r\n\r\n\r\n\t//native平台回调\r\n\tOnNativeNotify:function(eventType, eventDataString){\r\n        try {\r\n            let dataDict = JSON.parse(eventDataString);\r\n            if (eventType == \"wechat\") { //微信登录\r\n\t            app[app.subGameName + \"_WeChatAppManager\"]().OnNativeNotifyWXLogin(dataDict);\r\n            }else if (eventType == \"wechatShare\") {  //微信分享\r\n                app[app.subGameName + \"_WeChatAppManager\"]().OnNativeNotifyWXShare(dataDict);\r\n            }else if (eventType == \"wechatPay\") { //微信支付\r\n                app[app.subGameName + \"_WeChatAppManager\"]().OnNativeNotifyWXPay(dataDict);\r\n            }else if (eventType == \"onBatteryLevel\") { //电量回掉\r\n                this.OnEvent(\"EvtBatteryLevel\",{\"Level\": dataDict[\"Level\"], \"status\":dataDict[\"status\"]});\r\n            }else if (eventType == \"apkProess\") { //下载apk进度\r\n                this.OnEvent(\"LoadApkProess\", {\"progress\": dataDict[\"proess\"]});\r\n            }else if (eventType == \"download\") { //下载\r\n            \tapp[app.subGameName + \"_DownLoadMgr\"]().OnDownLoadEvent(dataDict);\r\n            }else if (eventType == \"palyAudioFinsh\") { //播放完成\r\n            \tthis.OnEvent(\"palyAudioFinsh\", {});\r\n            }else if (eventType == \"AudioError\") {//录音失败\r\n            \tthis.OnEvent(\"AudioError\", {});\r\n\t\t\t}else if (eventType == \"AudioStopError\") {//录音失败\r\n            \tthis.OnEvent(\"AudioStopError\", {});\r\n            }else if (eventType == \"MedioRecordError\") {//播放失败\r\n            \tthis.OnEvent(\"MedioRecordError\", {});\r\n            }else if (eventType == \"wellPrepared\") {//准备录音\r\n            \tthis.OnEvent(\"wellPrepared\", {});\r\n            }else if (eventType == \"RecordAudioFinsh\") { //录音完成\r\n            \tthis.OnEvent(\"RECORDAUDIOFINSH\", {});\r\n            }else if (eventType == \"GETLOCATION\") { //获取定位\r\n            \tapp[app.subGameName + \"_LocationOnStartMgr\"]().OnGetLocationCallBack(dataDict);\r\n            }else if (eventType == \"copyText\") { //获取定位\r\n            \tthis.OnEvent(\"OnCopyTextNtf\", dataDict);\r\n            }else if (eventType == \"DDShare\") {\r\n            \tthis.OnEvent(\"OnDDShare\", dataDict);\r\n            }else if (eventType == \"XLShare\") {\r\n            \tthis.OnEvent(\"OnXLShare\", dataDict);\r\n            }else{\r\n\t            this.ErrLog(\"OnNativeNotify not find eventType:%s\", eventType);\r\n            }\r\n        }\r\n        catch(error) {\r\n            if(eventType=='wechatShare'){\r\n        \t\t//还是给分享成功回调\r\n            \tapp[app.subGameName + \"_WeChatAppManager\"]().OnNativeNotifyWXShare({\"ErrCode\":0});\r\n        \t}else{\r\n            \tthis.ErrLog(\"OnNativeNotify(%s,%s) error(%s), error.stack:%s\", eventType, eventDataString, error, error.stack);\r\n        \t}\r\n        }\r\n\t},\r\n\r\n\r\n    // 每帧回掉\r\n    update: function (dt) {\t\r\n\r\n\t\t//if(this.clientState < this.pdk_ShareDefine.State_WaitLogin){\r\n\t\t//\treturn\r\n\t\t//}\r\n\t\t//\r\n\t\t//let nowTick = new Date().getTime();\r\n\t\t//\r\n\t\t//if(nowTick >= this.nextTick){\r\n\t\t//\tthis.nextTick = nowTick + 1000;\r\n\t\t//}\r\n    },\r\n\r\n    //100毫秒回掉\r\n    OnTimer:function(passSecond){\r\n\t\ttry {\r\n\t\t    if(this.isWriteLog){\r\n\t\t\t    this.logSecond += passSecond;\r\n\t\t\t    //500毫秒输出一次log\r\n\t\t\t    if(this.logSecond >= 0.5){\r\n\t\t\t\t    // this.LogManager.OutPutLog();\r\n\t\t\t\t    this.logSecond = 0\r\n\t\t\t    }\r\n\t\t    }\r\n            if (this.clientState < this.pdk_ShareDefine.State_WaitLogin) {\r\n                return\r\n            }\r\n\r\n            app[app.subGameName + \"_SceneManager\"]().OnTimer(passSecond);\r\n\r\n            //完整登录才能调用\r\n            if (this.clientState == this.pdk_ShareDefine.State_Logined){\r\n            \tlet curTime = new Date().getTime();\r\n\r\n            \tif(this.lastHearTime && curTime > this.lastHearTime + 23000){\r\n            \t\tthis.ErrLog('NetWork Disconnect By Heart');\r\n            \t\tthis.lastHearTime = 0;\r\n            \t\tif(app[app.subGameName + \"_NetWork\"]().isConnectIng)//ios的可能websoket不会主动断开\r\n            \t\t\tapp[app.subGameName + \"_NetManager\"]().Disconnect();\r\n\r\n            \t\tif(!this.bStartReConnect){\r\n            \t\t\tthis.StartReConnect();\r\n            \t\t\tapp[app.subGameName + \"_NetWork\"]().ReConnectByTipSureBtn();\r\n            \t\t}\r\n            \t}\r\n            \tif(this.bStartReConnect){\r\n            \t\tif(this.lastReConnectTime && curTime > this.lastReConnectTime + 1000){\r\n\t            \t\tthis.lastReConnectTime = curTime;\r\n\t            \t\tthis.reConnectUseTime++;\r\n\t            \t\tthis.reConnectLable.string = '连接失败,重新加载中(' + this.reConnectUseTime + '秒)'+'...';\r\n\t            \t}\r\n            \t}\r\n            }\r\n        }\r\n        catch(error){\r\n            this.ErrLog(\"OnTimer:%s\", error.stack);\r\n        }\r\n    },\r\n\r\n    StartTimer:function(){\r\n    \tthis.schedule(this.OnTimer, 1);\r\n    },\r\n    StopTimer:function(){\r\n    \tthis.unschedule(this.OnTimer);\r\n    },\r\n\r\n    OnEventHide:function(){\r\n    \tlet curRunGame = cc.sys.localStorage.getItem(\"curRunGame\");\r\n    \tif (curRunGame != app.subGameName) {\r\n    \t\tconsole.log(\"当前游戏在 \" + curRunGame + \",无需监听OnEventHide事件\");\r\n    \t\treturn\r\n    \t}\r\n    \tthis.StopTimer();\r\n        if(this.clientState < this.pdk_ShareDefine.State_WaitLogin){\r\n            return\r\n        }\r\n\r\n        try{\r\n            app[app.subGameName + \"_SceneManager\"]().OnEventHide();\r\n        }\r\n        catch(error){\r\n\t\t    this.ErrLog(\"OnEventHide error:%s\", error.stack);\r\n        }\r\n    },\r\n\r\n    OnEventShow:function(){\r\n    \tlet curRunGame = cc.sys.localStorage.getItem(\"curRunGame\");\r\n    \tif (curRunGame != app.subGameName) {\r\n    \t\tconsole.log(\"当前游戏在 \" + curRunGame + \",无需监听OnEventShow事件\");\r\n    \t\treturn;\r\n    \t}\r\n    \tthis.StopTimer();\r\n        if(this.clientState < this.pdk_ShareDefine.State_WaitLogin){\r\n            return\r\n        }\r\n\t    try{\r\n\t    \tlet curTime = new Date().getTime();\r\n\t    \tconsole.log(\"LostHearTime == \" + this.LostHearTime + \",curTime == \" + curTime);\r\n\t        if(this.LostHearTime && curTime > this.LostHearTime + 55000){\r\n\t        \tthis.lastHearTime = 0;\r\n\t        \t// console.log(\"后台切回来大厅 3\");\r\n\t        \tif(app[app.subGameName+\"_NetWork\"]().isConnectIng){//ios的可能websoket不会主动断开\r\n\t        \t\tconsole.log(\"后台切回来，先断开连接\");\r\n\t        \t\tapp[app.subGameName+\"_NetManager\"]().Disconnect();\r\n\t        \t}\r\n\t        \tif(!this.bStartReConnect){\r\n\t        \t\tconsole.log(\"后台切回来，发起断线重连\");\r\n\t        \t\tthis.StartReConnect();\r\n\t        \t\tapp[app.subGameName+\"_NetWork\"].ReConnectByTipSureBtn();\r\n\t        \t}\r\n\t        }\r\n\t\t    app[app.subGameName + \"_SceneManager\"]().OnEventShow(this.bStartReConnect);\r\n\t\t    this.scheduleOnce(function(){\r\n\t    \t\tthis.StartTimer();\r\n\t    \t},2);\r\n\t    }\r\n\t    catch(error){\r\n\t\t    this.ErrLog(\"OnEventShow error:%s\", error.stack);\r\n\t    }\r\n    },\r\n\r\n\t//初始化客户端访问路径和app版本号\r\n\tOnInitClientData:function(clientPath, appVersion){\r\n\t\tthis.clientState = this.pdk_ShareDefine.State_InitSuccess;\r\n\t},\r\n\r\n    //客户端初始化成功回调\r\n    OnInitClientFinish:function(allTableDataDict, clientConfig){\r\n\t\ttry{\r\n\t\t\tthis.clientConfig = clientConfig;\r\n\r\n\t\t\tconsole.log(\"ClietManage clientConfig:\",this.clientConfig);\r\n\t\t\tthis.RefreshClientConfig();\r\n\r\n\t\t\tif(this.debugModel){\r\n\t\t\t\tthis.debugModel.OnInitClientFinish();\r\n\t\t\t}\r\n\t\t\telse{\r\n\t\t\t\tlet debug = this.clientConfig[\"debug\"];\r\n\r\n\t\t\t\t//如果服务器下发debug\r\n\t\t\t\tif(debug && this.CheckDebugSign(debug)){\r\n\t\t\t\t\tthis.InitDebug(true);\r\n\t\t\t\t\tthis.debugModel.OnInitClientFinish();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tif(this.clientState != this.pdk_ShareDefine.State_InitSuccess){\r\n\t\t\t\tconsole.log(\"OnInitClientFinish 初始化异常\");\r\n\t\t\t\treturn\r\n\t\t\t}\r\n\r\n\t\t\tif(!this.InitModel()){\r\n\t\t\t\tconsole.log(\"OnInitClientFinish InitModel fail\");\r\n\t\t\t\treturn\r\n\t\t\t}\r\n\r\n\t\t\tif(!this.InitTable(allTableDataDict)){\r\n\t\t\t\tconsole.log(\"OnInitClientFinish InitTable fail\");\r\n\t\t\t\treturn\r\n\t\t\t}\r\n\r\n\t\t\t//初始化客户端所有管理器\r\n\t\t\tif(!this.InitManager()){\r\n\t\t\t\tconsole.log(\"OnInitClientFinish InitManager fail\");\r\n\t\t\t\treturn\r\n\t\t\t}\r\n\r\n\t\t\t//强制CG一次,否则内存一直会占用不释放\r\n\t\t\t// cc.sys.garbageCollect();\r\n\r\n\t\t\t//输出运行环境信息\r\n\t\t\tcc.sys.dump();\r\n\r\n        }\r\n\t\tcatch (e) {\r\n\t\t\tthis.ErrLog(\"InitUpdateFinish:%s\", e.stack);\r\n\t\t}\r\n    },\r\n\t\r\n\tLoadLogin:function(){\r\n\t\tthis.ClientLoginProcess();\r\n        app[app.subGameName + \"_WeChatManager\"]().SendRequestWeChatSDKIntSign();\r\n\t},\r\n\r\n\t//刷新客户端启动配置字典\r\n\tRefreshClientConfig:function(){\r\n\t\tconsole.log(\"ClientManageer this.clientConfig:\",this.clientConfig);\r\n\t\tlet dbGameServerInfo = this.LocalDataManager.GetConfigProperty(\"DebugInfo\", \"GameServerInfo\");\r\n\t\tlet dbAccountServerInfo = this.LocalDataManager.GetConfigProperty(\"DebugInfo\", \"AccountServerInfo\");\r\n\t\tlet dbOrderServerInfo = this.LocalDataManager.GetConfigProperty(\"DebugInfo\", \"OrderServerInfo\");\r\n\t\tlet dbResServerInfo = this.LocalDataManager.GetConfigProperty(\"DebugInfo\", \"ResServerInfo\");\r\n\r\n\t\tif(dbGameServerInfo){\r\n\t\t\tlet gameServerIP = dbGameServerInfo[\"GameServerIP\"];\r\n\t\t\tlet gameServerPort = dbGameServerInfo[\"GameServerPort\"];\r\n\r\n\t\t\tif(gameServerIP && gameServerPort){\r\n\t\t\t\tthis.clientConfig[\"GameServerIP\"] = gameServerIP;\r\n\t\t\t\tthis.clientConfig[\"GameServerPort\"] = gameServerPort;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif(dbAccountServerInfo){\r\n\t\t\tlet accountServerIP = dbAccountServerInfo[\"AccountServerIP\"];\r\n\t\t\tlet accountServerPort = dbAccountServerInfo[\"AccountServerPort\"];\r\n\r\n\t\t\tif(accountServerIP && accountServerPort){\r\n\t\t\t\tthis.clientConfig[\"AccountServerIP\"] = accountServerIP;\r\n\t\t\t\tthis.clientConfig[\"AccountServerPort\"] = accountServerPort;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif(dbOrderServerInfo){\r\n\t\t\tlet orderServerIP = dbOrderServerInfo[\"OrderServerIP\"];\r\n\t\t\tlet orderServerPort = dbOrderServerInfo[\"OrderServerPort\"];\r\n\r\n\t\t\tif(orderServerIP && orderServerPort){\r\n\t\t\t\tthis.clientConfig[\"OrderServerIP\"] = orderServerIP;\r\n\t\t\t\tthis.clientConfig[\"OrderServerPort\"] = orderServerPort;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif(dbResServerInfo){\r\n\t\t\tlet resServerIP = dbResServerInfo[\"ResServerIP\"];\r\n\t\t\tlet resServerPort = dbResServerInfo[\"ResServerPort\"];\r\n\r\n\t\t\tif(resServerIP && resServerPort){\r\n\t\t\t\tthis.clientConfig[\"ResServerIP\"] = resServerIP;\r\n\t\t\t\tthis.clientConfig[\"ResServerPort\"] = resServerPort;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t//如果是H5连接启动,使用的账号和支付方式，需要重置一次\r\n\t\t//H5使用的账号授权SDK和支付SDK 又配置的连接携带的参数决定,不是由配置决定\r\n\t\t//公众号标示也有启动参数决定,不是由配置决定\r\n\t\tconsole.log(\"RefreshClientConfig cc.sys.isNative\",cc.sys.isNative);\r\n\t\tif(cc.sys.isNative){\r\n\t\t\t//判断使用SDK授权,支付SDK,枚举是否存在\r\n\t\t\tlet accountType = this.clientConfig[\"AccountType\"];\r\n\t\t\tlet orderType = this.clientConfig[\"OrderType\"];\r\n\t\t\tif(!this.pdk_ShareDefine.AccountSDKTypeNameDict.hasOwnProperty(accountType)){\r\n\t\t\t\tconsole.log(\"AccountSDKTypeNameDict not find :%s\", accountType);\r\n\t\t\t\tthis.clientConfig[\"AccountType\"] = this.pdk_ShareDefine.SDKType_Company;\r\n\t\t\t}\r\n\r\n\t\t\tif(!this.pdk_ShareDefine.OrderSDKTypeNameDict.hasOwnProperty(orderType)){\r\n\t\t\t\tconsole.log(\"OrderSDKTypeNameDict not find :%s\", orderType);\r\n\t\t\t\tthis.clientConfig[\"OrderType\"] = this.pdk_ShareDefine.OrderType_Company;\r\n\t\t\t}\r\n\t\t}\r\n\t\telse{\r\n\r\n\t\t\tlet ddmchannel = this.startUpInfo[\"ddmchannel\"];\r\n\t\t\tlet ddmmp = this.startUpInfo[\"ddmmp\"];\r\n\r\n\t\t\tthis.clientConfig[\"Channel\"] = ddmchannel;\r\n\r\n\t\t\tif(ddmchannel == \"website\"){\r\n\t\t\t\tthis.clientConfig[\"AccountType\"] = this.pdk_ShareDefine.SDKType_Company;\r\n\t\t\t\tthis.clientConfig[\"OrderType\"] = this.pdk_ShareDefine.OrderType_Company;\r\n\t\t\t\tthis.clientConfig[\"MPID\"] = \"\";\r\n\t\t\t}\r\n\t\t\telse if(ddmchannel == \"wechat\"){\r\n\t\t\t\tthis.clientConfig[\"AccountType\"] = this.pdk_ShareDefine.SDKType_WeChat;\r\n\t\t\t\tthis.clientConfig[\"OrderType\"] = this.pdk_ShareDefine.OrderType_Wechat;\r\n\t\t\t\tthis.clientConfig[\"MPID\"] = ddmmp;\r\n\t\t\t}\r\n\t\t\t//可能是本机调试启动\r\n\t\t\telse if(!this.startUpInfo.hasOwnProperty(\"ddmchannel\")){\r\n\t\t\t\tconsole.log(\"webdebug ddmchannel:%s \", ddmchannel);\r\n\t\t\t\tthis.clientConfig[\"AccountType\"] = this.pdk_ShareDefine.SDKType_Company;\r\n\t\t\t\tthis.clientConfig[\"OrderType\"] = this.pdk_ShareDefine.OrderType_Company;\r\n\t\t\t\tthis.clientConfig[\"MPID\"] = \"\";\r\n\t\t\t}\r\n\t\t\telse{\r\n\t\t\t\tthis.ErrLog(\"ddmchannel:%s error\", ddmchannel);\r\n\t\t\t\tthis.clientConfig[\"AccountType\"] = this.pdk_ShareDefine.SDKType_Company;\r\n\t\t\t\tthis.clientConfig[\"OrderType\"] = this.pdk_ShareDefine.OrderType_Company;\r\n\t\t\t\tthis.clientConfig[\"MPID\"] = \"\";\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t},\r\n\r\n\t//初始化模块\r\n\tInitModel:function(){\r\n\t\tlet modelName = \"\";\r\n\t\ttry{\r\n\t\t\tlet NeedCreateList = app.NeedCreateList;\r\n\t\t\tlet count = NeedCreateList.length;\r\n\t\t\tfor(let index=0; index<count; index++){\r\n\t\t\t\tmodelName = NeedCreateList[index];\r\n\t\t\t\t//设置所有单例引用接口到app\r\n\t\t\t\tapp[modelName] = require(modelName).GetModel;\r\n\t\t\t}\r\n\t\t}\r\n\t\tcatch(error){\r\n\t\t\tthis.ErrLog(\"OnLoad require(%s) error:%s\", modelName, error.stack);\r\n\t\t\treturn false\r\n\t\t}\r\n\r\n\t\treturn true;\r\n\t},\r\n\r\n\t//初始化表数据\r\n\tInitTable:function(allTableDataDict){\r\n\r\n\t\tlet SysDataManager = app[app.subGameName + \"_SysDataManager\"]();\r\n\r\n\t\tlet allTableNameList = Object.keys(allTableDataDict);\r\n\t\tlet count = allTableNameList.length;\r\n\t\tfor(let index=0; index<count; index++){\r\n\t\t\tlet tableName = allTableNameList[index];\r\n\t\t\tlet tableInfo = allTableDataDict[tableName];\r\n\t\t\tSysDataManager.OnLoadTableEnd(tableName, tableInfo[\"KeyNameList\"], tableInfo[\"Data\"]);\r\n\t\t}\r\n\r\n\t\treturn true\r\n\t},\r\n\r\n\t//初始化管理器\r\n\tInitManager:function(){\r\n\r\n\t\t//实例化所有单例管理器\r\n\t\tlet NeedCreateList = app.NeedCreateList;\r\n\t\tlet count = NeedCreateList.length;\r\n\r\n\t\tlet modelName = \"\";\r\n\t\ttry{\r\n\t\t\tfor(let index=0; index<count; index++){\r\n\t\t\t\tconsole.log(app.subGameName + \" InitManager\",modelName)\r\n\t\t\t\tmodelName = NeedCreateList[index];\r\n\t\t\t\trequire(modelName).GetModel()\r\n\t\t\t}\r\n\t\t}\r\n\t\tcatch(error){\r\n\t\t\tthis.ErrLog(\"InitManager(%s) error:%s\", modelName, error.stack);\r\n\t\t\treturn false\r\n\t\t}\r\n\t\t//追加调试全局入口\r\n\t\tif(window){\r\n\t\t\twindow[\"pdk_app\"] = app;\r\n\t\t}\r\n\r\n\t\tlet NetManager = app[app.subGameName + \"_NetManager\"]();\r\n\t\tlet startUrl = \"\";\r\n\t\t//初始化资源服务器地址\r\n\t\tif(window.location){\r\n\t\t\tstartUrl = window.location.origin;\r\n\t\t}\r\n\t\tNetManager.SetH5ClientStartUrl(startUrl);\r\n\r\n\t\t//封包注册\r\n\t\t//封包事件注册\r\n\t\t\r\n        //心跳\r\n\t\tNetManager.RegNetPack(\"SPlayerHeartBeat\", this.OnPack_HeartBeat, this);\r\n\t\tNetManager.RegNetPack(\"base.C1111RoleReLogin\", this.OnPack_RoleTest, this);\r\n\t\tNetManager.RegNetPack(\"base.C1004Login\", this.OnPack_BaseLogin, this);\r\n\t\tNetManager.RegNetPack(\"base.C1006RoleLogin\", this.OnPack_OnHeroLogin, this);\r\n\t\tNetManager.RegNetPack(\"base.C1001CreateRole\", this.OnPack_OnHeroLogin, this);\r\n\t\tNetManager.RegNetPack(\"base.C1005PlayerInfo\", this.OnPack_PlayerInfo, this);\r\n\t\tNetManager.RegNetPack(\"kickout\", this.OnPack_Kickout, this);  \r\n        NetManager.RegNetPack(\"SPlayer_OnlineTime\", this.OnPack_Online, this);\r\n        //断线重连状态\r\n        NetManager.RegNetPack(\"game.CGetGameStatus\", this.OnPack_GetGameStatus, this);\r\n        //玩家点击继续\r\n\t\tNetManager.RegNetPack(\"SPlayer_Continue\", this.OnEvent_SPlayerContinue, this);\r\n\t\t//抽奖奖品领取通知\r\n\t\tNetManager.RegNetPack(\"SPlayer_LuckDrawReceive\",this.OnPack_LuckDrawReceive,this);\r\n\r\n\t\tthis.RegEvent(\"InitPlayerFamily\", this.OnEvent_InitPlayerFamily, this);\r\n\t\tthis.RegEvent(\"LoginGetCurRoomID\", this.OnEvent_LoginGetCurRoomID, this);\r\n\t\t//链接服务器成功并且重新初始化玩家数据\r\n\t\tapp[app.subGameName + \"Client\"].RegEvent(\"ReloadHeroData\", this.OnEvent_ReloadHeroData, this);\r\n\t\t//断线重连成功通知\r\n\t\tapp[app.subGameName + \"Client\"].RegEvent(app.subGameName + \"_ConnectSuccess\", this.OnEvent_ConnectSuccess, this);\r\n\t\t//初始化管理器完成调用一次sdk初始化接口(h5游戏客户端需要初始化携带的sdk参数:token)\r\n\t\tconsole.log(\"InitManager this.startUpInfo:\",this.startUpInfo);\r\n\t\tapp[app.subGameName + \"_SDKManager\"]().InitSDKParameter(this.startUpInfo);\r\n\r\n\t\treturn true;\r\n\r\n\t},\r\n\r\n\t//---------------------客户端事件分发接口-----------------------------\r\n    //客户端封包事件\r\n    OnEvent:function(eventName, argDict){\r\n        // if(argDict){\r\n    \t   // console.log(\"客户端事件分发 OnEvent:\" + eventName + \",\" + argDict);\r\n        // }\r\n        // else{\r\n        //     console.log(\"客户端事件分发 OnEvent:\" + eventName);\r\n        // }\r\n        if (!this.node) {\r\n        \tconsole.log(\"this.node is undefine\");\r\n         \treturn;\r\n        }\r\n        try{\r\n        \tlet curRunGame = cc.sys.localStorage.getItem(\"curRunGame\");\r\n        \tif (curRunGame != app.subGameName) {\r\n        \t\tconsole.log(\"当前游戏在 \" + curRunGame + \",无需分发事件\");\r\n        \t\treturn;\r\n        \t}\r\n            this.node.emit(eventName, argDict);\r\n        }\r\n        catch(error){\r\n            this.ErrLog(\"子游戏事件分发 OnEvent:%s\", error.stack);\r\n        }\r\n    },\r\n    OnEvent_SPlayerContinue:function(serverPack){\r\n    \tlet roomKey=serverPack.roomKey;\r\n    \tlet userName=serverPack.shortPlayer.name;\r\n    \tlet paymentRoomCardType=serverPack.paymentRoomCardType;\r\n    \tapp[app.subGameName + \"_FormManager\"]().ShowForm('UIJoinMessage',roomKey,userName,paymentRoomCardType);\r\n\t},\r\n\t\r\n    //注册封包事件\r\n    RegEvent:function(eventName, func, target){\r\n        if(!func || !target){\r\n            this.ErrLog(\"eventName:%s error\", eventName);\r\n            return\r\n        }\r\n        this.node.on(eventName, func, target);\r\n    },\r\n\r\n    //取消注册封包事件\r\n    UnRegTargetEvent:function(target, eventName=\"\", func=\"\"){\r\n    \tif (!this.node) {\r\n    \t\t//节点已经被销毁了\r\n    \t\treturn;\r\n    \t}\r\n    \t//如果有制定注销事件\r\n    \tif(eventName && func){\r\n    \t\tthis.node.off(eventName, func, target);\r\n    \t}\r\n    \telse{\r\n    \t\tthis.node.targetOff(target);\r\n    \t}\r\n    },\r\n\r\n    //键盘按下\r\n    OnKeyDown:function(event){\r\n        let keyCode = event.keyCode;\r\n        switch(keyCode){\r\n        \tcase cc.KEY.back:\r\n        \t{\r\n        \t\tlet msgID = \"MSG_EXIT_GAME\";\r\n\t\t        let ConfirmManager = app[app.subGameName + \"_ConfirmManager\"]();\r\n\t\t        ConfirmManager.SetWaitForConfirmForm(this.OnConFirm.bind(this), msgID, []);\r\n\t        \tConfirmManager.ShowConfirm(this.pdk_ShareDefine.Confirm, msgID, []);\r\n        \t\tbreak;\r\n        \t}\r\n        }\r\n        this.OnEvent(\"OnKeyDown\", {\"KeyCode\":keyCode});\r\n    },\r\n    OnConFirm:function(clickType, msgID, backArgList){\r\n        if('Sure' == clickType){\r\n\t    \tif('MSG_EXIT_GAME' == msgID)\r\n\t\t        cc.game.end();\r\n\t    }\r\n    },\r\n    //----------------逻辑函数----------------------\r\n\t//客户端是否登录封包完成\r\n\tIsClientLoginOK:function(){\r\n\t\treturn this.clientState == this.pdk_ShareDefine.State_Logined;\r\n\t},\r\n\r\n    SetClientState:function(clientState){\r\n        this.clientState = clientState;\r\n    },\r\n\r\n\t//退出游戏到登录界面\r\n\tLogOutGame:function(code = 0){\r\n\t\tconsole.log('LogOutGame');\r\n\t\tif(-1 == code){\r\n\t\t\t\r\n\t\t}else if(-2 == code){\r\n\t\t\tapp[app.subGameName + \"_SysNotifyManager\"]().ShowSysMsg(\"Kick_ByServer\");\r\n\t\t}\r\n\t\t\r\n\t\tapp.LocalDataManager().SetConfigProperty(\"Account\", \"AccessTokenInfo\", {});\r\n\t\tthis.ClientLoginProcess();\r\n\t},\r\n\r\n\t/**\r\n\t * 退到客户端登录场景,客户端初始化s\r\n\t */\r\n\tClientLoginProcess:function(){\r\n\r\n        let SceneManager = app[app.subGameName + \"_SceneManager\"]();\r\n\r\n        let sceneType = SceneManager.GetSceneType();\r\n\r\n        //如果已经在登录场景则不切换\r\n        if(sceneType == app.subGameName+\"LoginScene\"){\r\n        \tif(!SceneManager.GetSceneComponent()){\r\n\t            this.WarnLog(\"ClientLoginProcess not sceneName\");\r\n\t            return\r\n\t        }\r\n            SceneManager.GetSceneComponent().OnTopEvent(\"Close\");\r\n        }\r\n\t\t//如果不在登录场景，则切换到登录场景，\r\n        else{\r\n\t\t\tif (!cc.sys.isNative){\r\n\t\t\t\tthis.ClearClientData();\r\n            \tSceneManager.LoadScene(app.subGameName + \"LoginScene\");\r\n\t\t\t}\r\n\t\t\telse{\r\n\t\t\t\tthis.ExitGame();\r\n\t\t\t}\r\n        }\r\n\r\n\t},\r\n\r\n    //清理管理器数据\r\n    ClearClientData:function(){\r\n    \tapp.LocalDataManager().OnReload();\r\n    \t//----客户端基础管理器---\r\n    \tapp[app.subGameName + \"_NetManager\"]().OnReload();\r\n\t\tapp[app.subGameName + \"_SceneManager\"]().OnReload();\r\n\t    app[app.subGameName + \"_SDKManager\"]().OnReload();\r\n\r\n\t    //----数据管理器-------\r\n        app[app.subGameName + \"_HeroManager\"]().OnReload();\r\n\r\n\t    app[app.subGameName + \"_GameManager\"]().OnReload();\r\n\r\n\r\n\t\tthis.clientState = this.pdk_ShareDefine.State_WaitLogin;\r\n    },\r\n\r\n\r\n\t//检测Debug签名\r\n\tCheckDebugSign:function(debugSign){\r\n\t\t//生成签名\r\n\t\tlet argDict = {\r\n\t\t\t\"gameID\":\"p7\",\r\n\t\t\t\"gameType\":\"h5\",\r\n\t\t\t\"nonceStr\":\"18320c805fb57d88805d3918cdd1b2a3\",\r\n\t\t};\r\n\t\tlet argKeyList = Object.keys(argDict);\r\n\t\targKeyList.sort();\r\n\t\tlet keyCount = argKeyList.length;\r\n\t\tlet signString = \"\";\r\n\t\tfor(let index=0; index<keyCount; index++){\r\n\t\t\tlet keyName = argKeyList[index];\r\n\t\t\tsignString += [keyName,\"=\", argDict[keyName],\"&\"].join(\"\");\r\n\t\t}\r\n\t\tsignString += \"ddmh5.com\";\r\n\t\tlet sign = app.MD5.hex_md5(signString);\r\n\t\tif(sign == debugSign){\r\n\t\t\treturn true\r\n\t\t}\r\n\t\treturn false\r\n\t},\r\n\r\n    //--------------全局缓存---------------\r\n\r\n\t//获取全局缓存的bebug节点\r\n\tGetDebugModel:function(){\r\n\t\treturn this.debugModel;\r\n\t},\r\n\tMultiPoint:function(serverIP){\r\n        if(serverIP==\"\"){\r\n            return \"\";\r\n        }\r\n        if(app[app.subGameName + \"Client\"].GetClientConfigProperty(\"IsGaoFang\")==0){\r\n            //不接入高防\r\n            return serverIP;\r\n        }\r\n        let AccessPoint=app.LocalDataManager().GetConfigProperty(\"Account\", \"AccessPoint\");\r\n        if(AccessPoint>0){\r\n            if(AccessPoint==1){\r\n                return 'line1.'+serverIP;\r\n            }else if(AccessPoint==2){\r\n                return 'line2.'+serverIP;\r\n            }else if(AccessPoint==3){\r\n                return 'line3.'+serverIP;\r\n            }\r\n        }\r\n\r\n        let AccountActive = app.LocalDataManager().GetConfigProperty(\"Account\", \"AccountActive\");\r\n        //如果该城市有独立节点，则调用本城市自己的节点\r\n        let myCityID = cc.sys.localStorage.getItem(\"myCityID\");\r\n        if(myCityID){\r\n            let CityPoints=app[app.subGameName + \"Client\"].GetClientConfigProperty(\"CityPoints\");\r\n            if(CityPoints){\r\n                let CityPointsList=CityPoints.split(',');\r\n                if(CityPointsList.indexOf(myCityID)>-1){\r\n                    //用户选择的城市有配置独立的节点\r\n                    if(AccountActive>10){\r\n                        return 'h'+myCityID+'.'+serverIP; //活跃用户\r\n                    }else{\r\n                        return 'c'+myCityID+'.'+serverIP; //普通用户\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        if(AccountActive>100){\r\n            serverIP='a100.'+serverIP;\r\n        }else if(AccountActive>50){\r\n            serverIP='i50.'+serverIP;\r\n        }else if(AccountActive>10){\r\n            serverIP='x10.'+serverIP;\r\n        }\r\n\r\n\r\n        return serverIP;\r\n    },\r\n\t//获取客户端启动配置\r\n\tGetClientConfig:function(){\r\n\t\tlet clientConfig=[];\r\n\t\tlet mt=[\"GateServerIP\",\"GameServerIP\",\"AccountServerIP\",\"OrderServerIP\",\"ResServerIP\"];\r\n\t\tfor(var key in this.clientConfig){\r\n\t\t\tif(mt.InArray(key)){\r\n\t\t\t\tclientConfig[key]=this.MultiPoint(this.clientConfig[key]);\r\n\t\t\t}else{\r\n\t\t\t\tclientConfig[key]=this.clientConfig[key];\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn clientConfig;\r\n\t},\r\n\r\n\t//获取客户端启动配置属性值\r\n\tGetClientConfigProperty:function(property){\r\n\t\tlet mt=[\"GateServerIP\",\"GameServerIP\",\"AccountServerIP\",\"OrderServerIP\",\"ResServerIP\"];\r\n\t\tif(this.clientConfig.hasOwnProperty(property)){\r\n\t\t\tif(mt.InArray(property)){\r\n\t\t\t\treturn this.MultiPoint(this.clientConfig[property]);\r\n\t\t\t}else{\r\n\t\t\t\treturn this.clientConfig[property];\r\n\t\t\t}\r\n\t\t}\r\n\t\telse{\r\n\t\t\tthis.ErrLog(\"GetClientConfigProperty not find :%s\", property);\r\n\t\t\treturn 0\r\n\t\t}\r\n\t},\r\n\r\n\t//获取启动属性值\r\n\tGetStartUpProperty:function(property){\r\n\t\tif(!this.startUpInfo.hasOwnProperty(property)){\r\n\t\t\treturn\r\n\t\t}\r\n\t\treturn this.startUpInfo[property];\r\n\t},\r\n\r\n    GetGlobalEffectNode:function(effectName){\r\n        let effectNode = this.node.getChildByName('globalEffect').getChildByName(effectName);\r\n        if(!effectNode){\r\n            this.ErrLog(\"GetGlobalEffectNode(%s) not find\", effectName);\r\n            return\r\n        }\r\n        effectNode.removeFromParent(false);\r\n        return effectNode\r\n    },\r\n   \r\n    PushGlobalEffectNode:function(effectNode){\r\n        effectNode.removeFromParent(false);\r\n        this.node.getChildByName('globalEffect').addChild(effectNode);\r\n    },\r\n\r\n\tGetIsFirstLogin:function(){\r\n\t\treturn this.isFirstLogin\r\n\t},\r\n\r\n\tSetFirstLogin:function(){\r\n\t\tthis.isFirstLogin = false;\r\n\t},\r\n\r\n\tStartReConnect:function(){\r\n    \tif(this.bStartReConnect)\r\n    \t\treturn;\r\n    \tthis.bStartReConnect = true;\r\n    \tthis.reConnectUseTime = 0;\r\n    \tthis.reConnectLable.string = '连接失败,重新加载中(1秒)...';\r\n    \tthis.lastReConnectTime = new Date().getTime();\r\n    \tthis.reConnectTip.active = true;\r\n    },\r\n    CloseReConnectTip:function(){\r\n    \tthis.bStartReConnect = false;\r\n    \tthis.lastReConnectTime = 0;\r\n    \tthis.reConnectUseTime = 0;\r\n    \tthis.reConnectLable.string = '';\r\n    \tthis.reConnectTip.active = false;\r\n    },\r\n\r\n\t//取消常驻节点，以便重新加载游戏\r\n\tRemoveClientManager:function(){\r\n\t\t//清理已经加载的界面\r\n        app[app.subGameName + \"_FormManager\"]().loadFormDict = {};\r\n        app[app.subGameName + \"_FormManager\"]().showFormDict = {};\r\n        app[app.subGameName + \"_FormManager\"]().createingFormDict = {};\r\n        app[app.subGameName + \"_FormManager\"]().formWndShowInfo = {};\r\n        app[app.subGameName + \"_FormManager\"]().defaultFormNameList = [];\r\n        //释放已经加载的资源\r\n        this.pdk_ControlManager.ReleaseAllRes();\r\n\t\tcc.game.removePersistRootNode(this.node);\r\n        //清除注册事件\r\n        this.UnRegTargetEvent(this);\r\n        let baseForm = require(app.subGameName + \"_BaseForm\");\r\n\t\tbaseForm._eventFuncDict = {};\r\n\t\tthis.destroy();\r\n\t\tthis.node.destroy();\r\n\t},\r\n\t\r\n\tisInGame:function(){\r\n\t\tlet curRunGame = cc.sys.localStorage.getItem(\"curRunGame\");\r\n        if (curRunGame!= app.subGameName) {\r\n        \treturn false;\r\n        }\r\n        return true;\r\n\t},\r\n\tExitGame:function(switchGameData = null,isOutRoom='1'){\r\n        cc.game.off(cc.game.EVENT_HIDE);\r\n        cc.game.off(cc.game.EVENT_SHOW);\r\n        if (!cc.sys.isNative){\r\n            app[app.subGameName + \"_SceneManager\"]().LoadScene(app.subGameName + \"MainScene\");\r\n            return;\r\n        }\r\n         //联盟/亲友圈房间返回联盟/亲友圈房间列表\r\n        let roomMgr =app[app.subGameName.toUpperCase()+\"RoomMgr\"]();\r\n        if (roomMgr) {\r\n        \tif (roomMgr.clubId > 0 || roomMgr.unionId > 0) {\r\n        \t\tswitchGameData = {action:\"openClub\"};\r\n        \t}\r\n        }\r\n        if (switchGameData != null) {\r\n        \t// let testData = {action:\"showForm\", fromName:\"UIStore\"};\r\n        \tcc.sys.localStorage.setItem(\"isOutRoom\",isOutRoom);\r\n        \tcc.sys.localStorage.setItem(\"switchGameData\", JSON.stringify(switchGameData));\r\n        }\r\n        //如果是游戏切换需要释放内存，重新加载\r\n        this.RemoveClientManager();\r\n        let curRunHall = cc.sys.localStorage.getItem(\"curRunHall\");\r\n        app[app.subGameName + \"_NetManager\"]().SendPack(\"base.C1110UUID\", {\"gameName\":\"hall\"}, function(event){\r\n                app.LocalDataManager().SetConfigProperty(\"Account\", \"uuid\", event);\r\n                //停止场景音乐\r\n                app[app.subGameName+\"_SoundManager\"]().StopAllSound();\r\n                //主动断开socket连接，服务端会将玩家踢出\r\n\t            if(app[app.subGameName + \"_NetWork\"]().isConnectIng){\r\n\t\t\t\t\tconsole.log(\"获取uuid成功，断开连接\");\r\n\t\t\t\t\tapp[app.subGameName + \"_NetManager\"]().Disconnect(true);\r\n\t\t\t\t}\r\n                let gamePath = (jsb.fileUtils ? jsb.fileUtils.getWritablePath() : '/') + \"ALLGame/\"+app.subGameName;\r\n                window.require(gamePath + \"/src/hall.js\");\r\n            }, function(error){\r\n                console.log(\"获取uuid失败\");\r\n        });\r\n    },\r\n});\r\n\r\nmodule.exports = pdk_ClientManager;"]}