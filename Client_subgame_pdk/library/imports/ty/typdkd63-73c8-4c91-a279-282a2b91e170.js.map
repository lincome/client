{"version":3,"sources":["..\\..\\..\\..\\..\\assets\\script\\net/assets\\script\\net\\pdk_NetManager.js"],"names":["app","require","emitter","pdk_NetManager","BaseClass","extend","Init","JS_Name","subGameName","ShareDefine","SysDataManager","NetWork","httpRequest","ComTool","NewSysMsg","GetTableDict","H5ClientStartUrl","InitServerAddress","InitHttpPack","RegNetPack","OnPack_GMPack","RetryTime","OnReload","InitConnectAccountID","accountID","InitConnectInfo","clientConfig","GetClientConfig","AccountServerUrl","join","OrderServerUrl","ResServerUrl","gateServerInfo","SysLog","SetGateServerAddress","gateServerIP","gateServerPort","ErrLog","LocalDataManager","GetConfigProperty","OnEvent","SetServerAddress","gameServerIP","gameServerPort","dbGameServerInfo","SetConfigProperty","RefreshClientConfig","SetAccountAddress","accountServerIP","serverServerPort","dbAccountServerInfo","SetResAddress","resServerIP","dbResServerInfo","SetOrderAddress","orderServerIP","dbOrderServerInfo","SetH5ClientStartUrl","h5ClientStartUrl","sendHttpPackDict","packReceiveServerTypeDict","ClientHttpPackDict","packHeadName","headNameList","split","length","headInt","Math","floor","hasOwnProperty","InitConnectServer","InitWebSocket","OnWebSocketEvent","bind","OnConnectSuccess","GetUrlStr","dataDict","urlSendStr","key","substring","GetHttpSendPack","head","GetHttpSendPackUrl","serverType","url","console","log","GetH5ClientStartUrl","GetResServerHttpAddress","SendReConnect","eventName","sendPack","RequestReConnect","SendPack","callback","errorCallback","Request","SendPackOnly","NotifyPack","Notify","func","target","toLocaleLowerCase","valueType","Object","prototype","toString","call","slice","on","UnRegNetPack","off","UnAllRegNetPack","removeAllListeners","isReconnecting","arg","ReConnect","ShowSysMsg","OnReceive","OnCodeError","OnGMReceive","OnConFirm","clickType","msgID","backArgList","ShowForm","CloseForm","routeName","receivePack","emit","error","stack","JSON","stringify","code","resultInfo","codeMsg","ErrorSysMsg","InOtherRoomPlay","ExitGame","ResetRoomInfo","roomID","toUpperCase","GetEnterRoomID","SendGetRoomInfo","Maintain","finishttime","GetDateYearMonthDayHourMinuteString","ErrorNotRoomCard","desc","GetSysMsgContentByMsgID","SetWaitForConfirmForm","ConfirmBuyGoTo","ErrorMaxRoom","NotMagic","ErrorNotQuanCard","GetFormComponentByFormName","OnClick","errorMsg","IsDevelopment","NoShowSysMsgCodeList","InArray","argDict","RegHttpNetPack","UnRegHttpNetPack","SendHttpPack","serverUrl","Head","argString","NetLog","SendHttpRequest","OnReceiveHttpPack","httpResText","parse","OnConnectHttpFail","readyState","status","UpdateAccessPoint","AccountServerUrlHttps","Disconnect","byLogout","SendGMPack","cmdString","serverPack","g_pdk_NetManager","exports","GetModel"],"mappings":"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","file":"pdk_NetManager.js","sourceRoot":"..\\..\\..\\..\\..\\assets\\script\\net","sourcesContent":["/*\r\n    网络通信管理器\r\n*/\r\nvar app = require(\"pdk_app\");\r\nvar emitter = require('pdk_emitter');\r\n\r\nvar pdk_NetManager = app.BaseClass.extend({\r\n\r\n    Init:function(){\r\n        this.JS_Name = app.subGameName+\"_NetManager\";\r\n\r\n        this.emitter = new emitter();\r\n\t    this.ShareDefine = app[app.subGameName + \"_ShareDefine\"]();\r\n        this.SysDataManager = app[app.subGameName + \"_SysDataManager\"]();\r\n\t    this.NetWork = app[app.subGameName + \"_NetWork\"]();\r\n\t    this.httpRequest = app[app.subGameName + \"_NetRequest\"]();\r\n\t    this.ComTool = app[app.subGameName + \"_ComTool\"]();\r\n\r\n\r\n\t    this.NewSysMsg = this.SysDataManager.GetTableDict(\"NewSysMsg\");\r\n\r\n\t    //h5客户端启动url\r\n\t    this.H5ClientStartUrl = \"\";\r\n\r\n        this.InitServerAddress();\r\n\r\n        this.InitHttpPack();\r\n\r\n\t    this.RegNetPack(\"game.C1105GMPack\", this.OnPack_GMPack, this);\r\n\r\n\t    this.RetryTime=0;\r\n    },\r\n\r\n\t//切换账号\r\n\tOnReload:function(){\r\n\t\tthis.NetWork.OnReload();\r\n\t},\r\n\r\n\t//初始化连接\r\n\tInitConnectAccountID:function(accountID){\r\n\t\tthis.NetWork.InitConnectInfo(accountID);\r\n\t},\r\n\r\n    //初始化连接的服务器地址\r\n    InitServerAddress:function(){\r\n\r\n\t    let clientConfig = app[app.subGameName + \"Client\"].GetClientConfig();\r\n\r\n\t    this.AccountServerUrl = ['http://', clientConfig[\"AccountServerIP\"], \":\", clientConfig[\"AccountServerPort\"], \"/ClientPack\"].join(\"\");\r\n\r\n\t    //this.AccountServerUrlHttps = ['https://', clientConfig[\"AccountServerIP\"], \":\", clientConfig[\"AccountServerPort\"].toString()+'0', \"/ClientPack\"].join(\"\");\r\n\r\n\r\n\t    this.OrderServerUrl = ['http://', clientConfig[\"OrderServerIP\"], \":\", clientConfig[\"OrderServerPort\"], \"/ClientPack\"].join(\"\");\r\n\r\n\t    this.ResServerUrl = ['http://', clientConfig[\"ResServerIP\"], \":\", clientConfig[\"ResServerPort\"], \"/ClientPack\"].join(\"\");\r\n\r\n\t    let gateServerInfo = app[\"GateServerInfo\"];\r\n\r\n\t\tthis.SysLog(\"AccountServer(%s)\", this.AccountServerUrl, \"b-g\");\r\n\t    this.SysLog(\"OrderServer(%s)\", this.OrderServerUrl, \"b-g\");\r\n\t    this.SysLog(\"ResServerUrl(%s)\", this.ResServerUrl, \"b-g\");\r\n\t    this.SysLog(\"Server(%s:%s)\", clientConfig[\"GameServerIP\"], clientConfig[\"GameServerPort\"], \"b-g\");\r\n    },\r\n\r\n\t//设置首次连接服务器IP\r\n\tSetGateServerAddress:function(gateServerIP, gateServerPort){\r\n\t\tif(!gateServerIP || !gateServerPort){\r\n\t\t\tthis.ErrLog(\"SetGateServerAddress(%s,%s) error\", gateServerIP, gateServerPort);\r\n\t\t\treturn\r\n\t\t}\r\n\t\t//更新内存\r\n\t\tlet gateServerInfo = app[\"GateServerInfo\"];\r\n\t\tgateServerInfo[\"GateServerIP\"] = gateServerIP;\r\n\t\tgateServerInfo[\"GateServerPort\"] = gateServerPort;\r\n\r\n\t\t//修改本地数据库\r\n\t\tapp.LocalDataManager().GetConfigProperty(\"DebugInfo\", \"GateServerInfo\", gateServerInfo);\r\n\r\n\t\tapp[app.subGameName + \"Client\"].OnEvent(\"OnGateServerChangeIP\", null);\r\n\t},\r\n\r\n\t//设置服务器连接IP地址\r\n    SetServerAddress:function(gameServerIP, gameServerPort){\r\n\r\n\t    if(!gameServerIP || !gameServerPort){\r\n\t\t    this.ErrLog(\"SetServerAddress(%s,%s) error\", gameServerIP, gameServerPort);\r\n\t\t    return\r\n\t    }\r\n\r\n\t    //保存到本地数据库\r\n\t    let LocalDataManager = app.LocalDataManager();\r\n\t    let dbGameServerInfo = {\r\n\t\t\t\t\t\t\t\t    \"GameServerIP\":gameServerIP,\r\n\t\t\t\t\t\t\t\t    \"GameServerPort\":gameServerPort,\r\n\t\t\t\t\t\t\t    }\r\n\t    LocalDataManager.SetConfigProperty(\"DebugInfo\", \"GameServerInfo\", dbGameServerInfo);\r\n\r\n\t    //修改内存中缓存的字典\r\n\t    app[app.subGameName + \"Client\"].RefreshClientConfig()\r\n\r\n\t    app[app.subGameName + \"Client\"].OnEvent(\"OnChangeIP\", null);\r\n    },\r\n\tSetAccountAddress:function(accountServerIP, serverServerPort){\r\n\t\tif(!accountServerIP || !serverServerPort){\r\n\t\t\tthis.ErrLog(\"SetAccountAddress(%s,%s) error\", accountServerIP, serverServerPort);\r\n\t\t\treturn\r\n\t\t}\r\n\t\tthis.AccountServerUrl = ['http://', accountServerIP, \":\", serverServerPort, \"/ClientPack\"].join(\"\");\r\n\t\t//this.AccountServerUrlHttps = ['https://', accountServerIP, \":\", serverServerPort.toString()+'0', \"/ClientPack\"].join(\"\");\r\n\r\n\t\t//保存到本地数据库\r\n\t\tlet LocalDataManager = app.LocalDataManager();\r\n\t\tlet dbAccountServerInfo = {\r\n\t\t\t\"AccountServerIP\":accountServerIP,\r\n\t\t\t\"AccountServerPort\":serverServerPort,\r\n\t\t}\r\n\t\tLocalDataManager.SetConfigProperty(\"DebugInfo\", \"AccountServerInfo\", dbAccountServerInfo);\r\n\r\n\t\t//修改内存中缓存的字典\r\n\t\tapp[app.subGameName + \"Client\"].RefreshClientConfig()\r\n\r\n\t\tapp[app.subGameName + \"Client\"].OnEvent(\"OnChangeIP\", null);\r\n\t},\r\n    SetResAddress:function(resServerIP, serverServerPort){\r\n        if(!resServerIP || !serverServerPort){\r\n            this.ErrLog(\"SetResAddress(%s,%s) error\", resServerIP, serverServerPort);\r\n            return\r\n        }\r\n        this.ResServerUrl = ['http://', resServerIP, \":\", serverServerPort, \"/ClientPack\"].join(\"\");\r\n\r\n        //保存到本地数据库\r\n        let LocalDataManager = app.LocalDataManager();\r\n        let dbResServerInfo = {\r\n            \"ResServerIP\":resServerIP,\r\n            \"ResServerPort\":serverServerPort,\r\n        }\r\n        LocalDataManager.SetConfigProperty(\"DebugInfo\", \"ResServerInfo\", dbResServerInfo);\r\n\r\n        //修改内存中缓存的字典\r\n        app[app.subGameName + \"Client\"].RefreshClientConfig()\r\n\r\n        app[app.subGameName + \"Client\"].OnEvent(\"OnChangeIP\", null);\r\n    },\r\n    SetOrderAddress:function(orderServerIP, serverServerPort){\r\n        if(!orderServerIP || !serverServerPort){\r\n            this.ErrLog(\"SetOrderAddress(%s,%s) error\", orderServerIP, serverServerPort);\r\n            return\r\n        }\r\n        this.OrderServerUrl = ['http://', orderServerIP, \":\", serverServerPort, \"/ClientPack\"].join(\"\");\r\n\r\n        //保存到本地数据库\r\n        let LocalDataManager = app.LocalDataManager();\r\n        let dbOrderServerInfo = {\r\n            \"OrderServerIP\":orderServerIP,\r\n            \"OrderServerPort\":serverServerPort,\r\n        }\r\n        LocalDataManager.SetConfigProperty(\"DebugInfo\", \"OrderServerInfo\", dbOrderServerInfo);\r\n\r\n        //修改内存中缓存的字典\r\n        app[app.subGameName + \"Client\"].RefreshClientConfig()\r\n\r\n        app[app.subGameName + \"Client\"].OnEvent(\"OnChangeIP\", null);\r\n    },\r\n\r\n\r\n\t//设置资源服务器地址\r\n\tSetH5ClientStartUrl:function(h5ClientStartUrl){\r\n\t\tthis.H5ClientStartUrl = h5ClientStartUrl;\r\n\t},\r\n\r\n\r\n\t//初始化http封包\r\n    InitHttpPack:function(){\r\n        //输出发送封包字典\r\n        // {\r\n        //     0xFF00:packName\r\n        // }\r\n        this.sendHttpPackDict = {};\r\n\r\n        //封包发送到那个服务器\r\n        // {\r\n        //     0xFF00:account,\r\n        // }\r\n        this.packReceiveServerTypeDict = {};\r\n\r\n        let ClientHttpPackDict = app[app.subGameName + \"_HttpPack\"]().ClientHttpPackDict;\r\n\r\n        for(let packHeadName in ClientHttpPackDict){\r\n            let headNameList = packHeadName.split(\".\");\r\n            if(headNameList.length != 3){\r\n                this.ErrLog(\"InitHttpPack ClientHttpPackDict packHeadName:%s error\", packHeadName);\r\n                continue\r\n            }\r\n            let headInt = Math.floor(headNameList[1]);\r\n\r\n            if(this.sendHttpPackDict.hasOwnProperty(headInt)){\r\n                this.ErrLog(\"InitHttpPack sendHttpPackDict have find(%s) headInt\", packHeadName);\r\n                continue\r\n            }\r\n            this.sendHttpPackDict[headInt] = ClientHttpPackDict[packHeadName];\r\n\r\n            this.packReceiveServerTypeDict[headInt] = headNameList[2];\r\n        }\r\n    },\r\n\r\n    //初始化连接\r\n\tInitConnectServer:function(){\r\n        app[app.subGameName + \"Client\"].OnEvent(\"ModalLayer\", \"OpenNet\");\r\n\r\n\t\tlet clientConfig = app[app.subGameName + \"Client\"].GetClientConfig();\r\n\r\n\t\tlet gameServerIP = clientConfig[\"GameServerIP\"];\r\n\t\tlet gameServerPort = clientConfig[\"GameServerPort\"];\r\n\r\n    \t//初始化连接服务器\r\n\t    this.NetWork.InitWebSocket(gameServerIP, gameServerPort, this.OnWebSocketEvent.bind(this), this.OnConnectSuccess.bind(this));\r\n\r\n    },\r\n\r\n\r\n    /**\r\n     * 获取url字符串格式\r\n     * @param dataDict\r\n     * @returns {String}\r\n     */\r\n    GetUrlStr:function(dataDict){\r\n\r\n        if(!dataDict){\r\n            return \"\"\r\n        }\r\n        var urlSendStr = '?';\r\n        for(var key in dataDict){\r\n            urlSendStr += key + '=' + dataDict[key] + '&';\r\n        }\r\n        //去掉最后一个&\r\n        urlSendStr = urlSendStr.substring(0, urlSendStr.length-1);\r\n\r\n        return urlSendStr;\r\n    },\r\n\r\n    //获取http请求发送的封包\r\n    GetHttpSendPack:function(head){\r\n        if(!this.sendHttpPackDict.hasOwnProperty(head)){\r\n            this.ErrLog(\"GetHttpSendPack sendHttpPackDict not find:%s\", head);\r\n            return\r\n        }\r\n        return {\"Head\":head}\r\n    },\r\n\r\n    //获取http封包发送的目的地地址\r\n    GetHttpSendPackUrl:function(head){\r\n        let serverType = this.packReceiveServerTypeDict[head];\r\n        if(!serverType){\r\n            this.ErrLog(\"GetHttpSendPackUrl(%s) not find\", head);\r\n            return\r\n        }\r\n\r\n        let url = \"\";\r\n        switch(serverType){\r\n            case \"account\":\r\n                url = this.AccountServerUrl;\r\n                break\r\n\t        case \"order\":\r\n\t\t        url = this.OrderServerUrl;\r\n\t\t        break\r\n\t        case \"res\":\r\n\t\t        url = this.ResServerUrl;\r\n\t\t        break\r\n            default:\r\n                this.ErrLog(\"GetHttpSendPackUrl serverType:%s error\", serverType);\r\n                break\r\n        }\r\n\t\tconsole.log(url)\r\n        return url\r\n    },\r\n\r\n\t//获取客户端启动后的html地址串\r\n\tGetH5ClientStartUrl:function(){\r\n\t\treturn this.H5ClientStartUrl\r\n\t},\r\n\r\n\t//获取客户端资源服务器HTTP地址\r\n\tGetResServerHttpAddress:function(){\r\n\t\tlet clientConfig = app[app.subGameName + \"Client\"].GetClientConfig();\r\n\t\treturn ['http://', clientConfig[\"ResServerIP\"], \":\", clientConfig[\"ResServerPort\"]].join(\"\");\r\n\t},\r\n\r\n\t//-------------websocket请求------------------\r\n\t//系统自主发送重连请求\r\n\tSendReConnect:function(eventName, sendPack){\r\n\t\tapp[app.subGameName + \"Client\"].OnEvent(\"ModalLayer\", \"OpenNet\");\r\n\t\tthis.NetWork.RequestReConnect(eventName, sendPack)\r\n\t},\r\n\t//向服务器发起请求\r\n\tSendPack:function(eventName, sendPack, callback=null, errorCallback=null){\r\n\t\t//开启模态层\r\n\t\tapp[app.subGameName + \"Client\"].OnEvent(\"ModalLayer\", \"OpenNet\");\r\n\t\tthis.NetWork.Request(eventName, sendPack, callback, errorCallback);\r\n\t},\r\n\r\n\t//向服务器发起请求,不触发网络\r\n\tSendPackOnly:function(eventName, sendPack, callback=null, errorCallback=null){\r\n\t\tthis.NetWork.Request(eventName, sendPack, callback, errorCallback);\r\n\t},\r\n\t\r\n\t//通知服务器得封包数据\r\n\tNotifyPack:function(eventName, sendPack){\r\n\t\tthis.NetWork.Notify(eventName, sendPack);\r\n\t},\r\n\r\n    //注册封包事件(需要字符串封包头,才可以避免RegHttpNetPack相同封包头注册事件区分)\r\n    RegNetPack:function(head, func, target){\r\n        head = head.toLocaleLowerCase();\r\n        let valueType = Object.prototype.toString.call(head).slice(\"[object \".length, -1);\r\n        if(valueType != \"String\"){\r\n            this.ErrLog(\"RegNetPack need String head\");\r\n            return\r\n        }\r\n\r\n\t    if(!func || !target){\r\n\t\t    this.ErrLog(\"RegNetPack head:%s error\", head);\r\n\t\t    return\r\n\t    }\r\n    \tthis.emitter.on(head, func, target);\r\n    },\r\n\r\n    //取消封包注册\r\n    UnRegNetPack:function(eventName, func){\r\n        this.emitter.off(eventName, func);\r\n    },\r\n    \r\n    //取消所有封包注册\r\n    UnAllRegNetPack:function(){\r\n        this.emitter.removeAllListeners();\r\n    },\r\n\r\n    //服务器连接成功\r\n\tOnConnectSuccess:function(isReconnecting){\r\n        //关闭模态层\r\n        app[app.subGameName + \"Client\"].OnEvent(\"ModalLayer\", \"ReceiveNet\");\r\n        app[app.subGameName + \"Client\"].OnEvent(app.subGameName + \"_ConnectSuccess\", {\"ServerName\":\"GameServer\", \"IsReconnecting\":isReconnecting});\r\n    },\r\n\t//websocket事件回掉\r\n\tOnWebSocketEvent:function(eventName, arg){\r\n\t\t// console.log(\"子游戏 OnWebSocketEvent 回调\");\r\n\t\t//关闭模态层\r\n\t\tapp[app.subGameName + \"Client\"].OnEvent(\"ModalLayer\", \"ReceiveNet\");\r\n\r\n\t\tswitch (eventName) {\r\n\t\t\tcase \"OnError\":\r\n\t\t\t\tapp[app.subGameName + \"Client\"].OnEvent(\"ConnectFail\", {\"ServerName\":\"GameServer\", \"EventType\": \"OnError\"});\r\n\t\t\t\tbreak\r\n\r\n\t\t\tcase \"Reconnectd\":\r\n\t\t\t\tapp[app.subGameName + \"Client\"].OnEvent(\"ModalLayer\", \"StartReConnect\");\r\n\t\t\t\tthis.NetWork.ReConnect();\r\n\t\t\t\tbreak\r\n\r\n\t\t\tcase \"OnClose\":\r\n\t\t\t\tapp[app.subGameName + \"Client\"].OnEvent(\"ConnectFail\", {\"bCloseByLogout\":arg[0],\"ServerName\":\"GameServer\", \"EventType\": \"OnClose\"});\r\n\t\t\t\tbreak\r\n\r\n\t\t\tcase \"OnKick\":\r\n\t\t\t\tapp[app.subGameName + \"_SysNotifyManager\"]().ShowSysMsg(\"Kick_ByServer\");\r\n\t\t\t\tbreak\r\n\r\n\t\t\tcase \"OnReceive\":\r\n\t\t\t\tthis.OnReceive(arg[0], arg[1]);\r\n\t\t\t\tbreak\r\n\r\n\t\t\tcase \"OnCodeError\":\r\n\t\t\t\tthis.OnCodeError(arg[0], arg[1], arg[2]);\r\n\t\t\t\tbreak\r\n\r\n\t\t\tcase \"OnGMReceive\":\r\n\t\t\t\tthis.OnGMReceive(arg[0], arg[1]);\r\n\t\t\t\tbreak\r\n\r\n\t\t\tdefault:\r\n\t\t\t\tthis.ErrLog(\"OnWebSocketEvent(%s):\", eventName, arg);\r\n\t\t\t\tbreak\r\n\t\t}\r\n\t},\r\n\r\n\tOnConFirm:function(clickType, msgID, backArgList){\r\n\t\tif(clickType != \"Sure\"){\r\n\t\t\treturn\r\n\t\t}\r\n\t\tif(\"goBuyCard\" == msgID){\r\n\t\t\tlet clientConfig = app[app.subGameName + \"Client\"].GetClientConfig();\r\n\t\t\tapp[app.subGameName + \"_FormManager\"]().ShowForm(\"UIStore\");\r\n\t\t\tapp[app.subGameName + \"_FormManager\"]().CloseForm(\"UIJoin\");\r\n\t\t\tapp[app.subGameName + \"_FormManager\"]().CloseForm(\"UIChouJiang\");\r\n\t\t\tapp[app.subGameName + \"_FormManager\"]().CloseForm(\"game/base/ui/majiang/UIMJResultDetail\");\r\n\t\t\treturn;\r\n\t\t}\r\n\t},\r\n\r\n    //封包事件回掉\r\n    OnReceive:function(routeName, receivePack){\r\n        try {\r\n            this.emitter.emit(routeName, receivePack);\r\n        }\r\n        catch(error){\r\n            this.ErrLog(\"OnReceive:%s\", error.stack);\r\n            this.ErrLog(\"OnReceive routeName :%s, receivePack:%s\", routeName, JSON.stringify(receivePack));\r\n        }\r\n    },\r\n\r\n    //封包事件失败回掉\r\n    OnCodeError:function(eventName, code, resultInfo){\r\n\t    let codeMsg = [\"Code\", code].join(\"_\");\r\n\r\n\t    //如果是错误提示类型,根据提示码提示,直接提示\r\n\t    if(code == this.ShareDefine.ErrorSysMsg){\r\n\t\t    app[app.subGameName + \"_SysNotifyManager\"]().ShowSysMsg(resultInfo[\"Msg\"]);\r\n\t\t}\r\n\t\t// else if(code == this.ShareDefine.NotAllow){\r\n\t\t// \tapp[app.subGameName + \"_SysNotifyManager\"]().ShowSysMsg('MSG_SERVICE_NOTALLOW');\r\n\t\t// }\r\n\t    else if(code == this.ShareDefine.InOtherRoomPlay){\r\n\t    \tapp[app.subGameName + \"_SysNotifyManager\"]().ShowSysMsg('MSG_IN_OTHER_ROOM_PLAY');\r\n\t    }\r\n\t    else if (code == 12) {\r\n            app[app.subGameName + \"Client\"].ExitGame();\r\n        }\r\n         //继续游戏失败\r\n        else if(code == this.ShareDefine.ResetRoomInfo){\r\n        \tlet roomID = app[app.subGameName.toUpperCase() + \"RoomMgr\"]().GetEnterRoomID();\r\n        \tif(roomID){\r\n        \t\t app[app.subGameName.toUpperCase() + \"RoomMgr\"]().SendGetRoomInfo(roomID);\r\n        \t}\r\n        }\r\n\t    else if(code == this.ShareDefine.Maintain){\r\n\t    \tlet finishttime = resultInfo[\"Msg\"];\r\n\t    \tapp[app.subGameName + \"_SysNotifyManager\"]().ShowSysMsg('服务器维护中,预计结束时间：'+app[app.subGameName + \"_ComTool\"]().GetDateYearMonthDayHourMinuteString(finishttime));\r\n\t    }\r\n\t    else if(code == this.ShareDefine.ErrorNotRoomCard){//房卡不足\r\n\t    \tlet desc = app[app.subGameName + \"_SysNotifyManager\"]().GetSysMsgContentByMsgID(\"MSG_NotRoomCard\");\r\n\t\t\tapp[app.subGameName + \"_ConfirmManager\"]().SetWaitForConfirmForm(this.OnConFirm.bind(this), \"goBuyCard\", []);\r\n\t    \tapp[app.subGameName + \"_FormManager\"]().ShowForm(app.subGameName + \"_UIMessage\", null, this.ShareDefine.ConfirmBuyGoTo, 0, 0,desc)\r\n\t    }\r\n\t    else if(code == this.ShareDefine.ErrorMaxRoom){\r\n\t    \tapp[app.subGameName + \"_SysNotifyManager\"]().ShowSysMsg('可以创建的房间数量不足');\r\n\t    }\r\n\t    else if(code == this.ShareDefine.NotMagic){\r\n\t    \tapp[app.subGameName + \"_SysNotifyManager\"]().ShowSysMsg('禁止魔法表情');\r\n\t    }\r\n\t    else if(code == 15000){\r\n\t    \t//托管状态报错\r\n\t        app[app.subGameName + \"_FormManager\"]().ShowForm(app.subGameName + \"_UIAutoPlay\");\r\n\t\t}\r\n\r\n\r\n\t    else if(code == this.ShareDefine.ErrorNotQuanCard){//圈币不足\r\n\t\t   app[app.subGameName + \"_SysNotifyManager\"]().ShowSysMsg('圈卡不足，请前往亲友圈商城购买圈卡');\r\n\t\t   app[app.subGameName + \"_FormManager\"]().GetFormComponentByFormName(\"ui/club/UIClub\").OnClick('btn_addRoomCard',null);\r\n\t\t}\r\n\t    //如果有配置系统提示码,则提示错误提示码对应的文本\r\n\t    else if(this.NewSysMsg.hasOwnProperty(codeMsg)){\r\n\r\n\t\t    let errorMsg = resultInfo[\"Msg\"];\r\n\t\t\t//开发模式有 提示文本的话 显示错误文本\r\n\t\t    if(this.ShareDefine.IsDevelopment && errorMsg){\r\n\t\t\t    app[app.subGameName + \"_SysNotifyManager\"]().ShowSysMsg(\"CodeErrorMsg\", [errorMsg]);\r\n\t\t    }\r\n\t\t    //如果不是开发模式,弹通用的系统提示\r\n\t\t    else{\r\n\t\t\t    app[app.subGameName + \"_SysNotifyManager\"]().ShowSysMsg(codeMsg);\r\n\t\t    }\r\n\t    }\r\n\t    //如果配置表没有配置的错误码\r\n\t    else{\r\n\t\t    //如果是不需要提示的,不配置也不需要显示的系统提示码\r\n\t\t    if(this.ShareDefine.NoShowSysMsgCodeList.InArray(code)){\r\n\r\n\t\t    }\r\n\t\t    //没有配置,是开发模式弹框\r\n\t\t    else if(this.ShareDefine.IsDevelopment){\r\n\t\t\t    app[app.subGameName + \"_SysNotifyManager\"]().ShowSysMsg(\"CodeErrorMsg\", [resultInfo[\"Msg\"]]);\r\n\t\t    }\r\n\t    }\r\n\t    app[app.subGameName + \"Client\"].OnEvent(\"CodeError\", {\"Code\":code, \"EventName\":eventName, \"Result\":resultInfo});\r\n    },\r\n\r\n    //接受到GM命令汇报\r\n    OnGMReceive:function(eventName, argDict){\r\n        app[app.subGameName + \"Client\"].OnEvent(\"ReceiveGM\", argDict);\r\n    },\r\n\r\n\t//------------------http请求--------------------------------\r\n\r\n\t//注册http封包事件(需要整形封包头,才可以避免RegNetPack相同封包头注册事件区分)\r\n\tRegHttpNetPack:function(head, func, target){\r\n\t\tlet valueType = Object.prototype.toString.call(head).slice(\"[object \".length, -1);\r\n\t\tif(valueType != \"Number\"){\r\n\t\t\tthis.ErrLog(\"RegNetPack need Int head\");\r\n\t\t\treturn\r\n\t\t}\r\n\t\thead = head.toString();\r\n\t\tthis.emitter.on(head, func, target);\r\n\t},\r\n\r\n\tUnRegHttpNetPack:function(head, func){\r\n\t\tlet valueType = Object.prototype.toString.call(head).slice(\"[object \".length, -1);\r\n\t\tif(valueType != \"Number\"){\r\n\t\t\tthis.ErrLog(\"UnRegHttpNetPack need Int head\");\r\n\t\t\treturn\r\n\t\t}\r\n\t\thead = head.toString();\r\n\t\tthis.emitter.off(head, func);\r\n\t},\r\n\r\n    //发送HTTP请求\r\n    SendHttpPack:function(sendPack){\r\n    \tconsole.log(\"sendPack:\",sendPack);\r\n        let serverUrl = this.GetHttpSendPackUrl(sendPack.Head);\r\n        if(!serverUrl){\r\n            this.ErrLog(\"SendHttpPack(%s) not find serverUrl\", sendPack);\r\n            return\r\n        }\r\n\t\t//开启模态层\r\n        app[app.subGameName + \"Client\"].OnEvent(\"ModalLayer\", \"OpenNet\");\r\n        let argDict = {\"Sign\":\"ddcat\"};\r\n        let argString = this.GetUrlStr(argDict);\r\n\r\n\t    if(this.IsDevelopment()){\r\n\t\t    this.NetLog(\"[SendHttp](%s):\", serverUrl, sendPack, \"b-g\");\r\n\t    }\r\n\t    this.sendPack=sendPack;\r\n        this.httpRequest.SendHttpRequest(serverUrl, argString, \"POST\", sendPack);\r\n    },\r\n\r\n    //发送HTTPS请求\r\n    /*SendHttpsPack:function(){\r\n    \tlet sendPack=this.sendPack;\r\n        let serverUrl=this.AccountServerUrlHttps;\r\n        if(!serverUrl){\r\n            this.ErrLog(\"SendHttpPacks(%s) not find serverUrl\", sendPack);\r\n            return\r\n        }\r\n\t\t//开启模态层\r\n        app[app.subGameName + \"Client\"].OnEvent(\"ModalLayer\", \"OpenNet\");\r\n        let argDict = {\"Sign\":\"ddcat\"};\r\n        let argString = this.GetUrlStr(argDict);\r\n\r\n\t    if(this.IsDevelopment()){\r\n\t\t    this.NetLog(\"[SendHttps](%s):\", serverUrl, sendPack, \"b-g\");\r\n\t    }\r\n\r\n        this.httpRequest.SendHttpRequest(serverUrl, argString, \"POST\", sendPack);\r\n    },\r\n*/\r\n\t//接受到http请求回复\r\n\tOnReceiveHttpPack:function(serverUrl, httpResText){\r\n\t\t//关闭模态层\r\n\t\tapp[app.subGameName + \"Client\"].OnEvent(\"ModalLayer\", \"ReceiveNet\");\r\n\r\n\t\tvar receivePack = JSON.parse(httpResText);\r\n\t\tif(this.IsDevelopment()){\r\n\t\t\tthis.NetLog(\"[RecvHttp]:\", receivePack, \"b-gb\");\r\n\t\t}\r\n\r\n\t\tif(receivePack.hasOwnProperty(\"code\")){\r\n\t\t\tthis.ErrLog(\"OnReceiveHttpPack HttpCode:\", receivePack);\r\n\r\n\t\t\tlet eventName = \"HttpRequestCode\";\r\n\t\t\tif(serverUrl == this.AccountServerUrl){\r\n\t\t\t\teventName = \"AccountServerCode\";\r\n\t\t\t\tthis.OnCodeError(eventName, receivePack[\"code\"], receivePack);\r\n\t\t\t}\r\n\t\t\telse if(serverUrl == this.ResServerUrl){\r\n\t\t\t\teventName = \"ResServerCode\";\r\n\t\t\t\tthis.OnCodeError(eventName, receivePack[\"code\"], receivePack);\r\n\t\t\t}\r\n\t\t\telse{\r\n\t\t\t\tthis.ErrLog(\"OnReceiveHttpPack serverUrl(%s) error\", serverUrl);\r\n\t\t\t}\r\n\t\t}\r\n\t\telse{\r\n\t\t\ttry{\r\n\t\t\t\t//转化封包头为字符串 分发事件\r\n\t\t\t\tlet head = receivePack.Head.toString();\r\n\t\t\t\tthis.emitter.emit(head, receivePack);\r\n\t\t\t}\r\n\t\t\tcatch(error){\r\n\t\t\t\tthis.ErrLog(\"OnReceiveHttpPack(%s) error\", httpResText);\r\n\t\t\t\treturn\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\t/**\r\n\t * 请求连接失败\r\n\t */\r\n\tOnConnectHttpFail:function(serverUrl, readyState, status){\r\n\t\tthis.ErrLog(\"HttpConnectFail(%s, %s,%s)\", serverUrl, readyState, status);\r\n\r\n\t\t//关闭模态层\r\n\t\tapp[app.subGameName + \"Client\"].OnEvent(\"ModalLayer\", \"ReceiveNet\");\r\n\r\n\t\tif(serverUrl == this.AccountServerUrl){\r\n\t\t\t//app[app.subGameName + \"_SysNotifyManager\"]().ShowSysMsg(\"Code_10010\");\r\n\t\t\t//app[app.subGameName + \"Client\"].OnEvent(\"ConnectHttpFail\", {\"ServerName\":\"AccountServer\"});\r\n\t\t\t//http请求失败，尝试用https请求\r\n\t\t\t//this.SendHttpsPack();\r\n\t\t\tif(this.RetryTime==9){\r\n\t\t\t\tapp[app.subGameName + \"_SysNotifyManager\"]().ShowSysMsg(\"Code_10010\");\r\n\t\t\t\tapp[app.subGameName + \"Client\"].OnEvent(\"ConnectHttpFail\", {\"ServerName\":\"AccountServer\"});\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\t//换节点\r\n\t\t\tapp[app.subGameName + \"_HeroAccountManager\"]().UpdateAccessPoint();\r\n\t\t\tthis.InitServerAddress();\r\n\t\t\tthis.SendHttpPack(this.sendPack);\r\n\t\t\tthis.RetryTime=this.RetryTime+1;\r\n\t\t}else if(serverUrl == this.AccountServerUrlHttps){\r\n\t\t\t/*if(this.RetryTime==5){\r\n\t\t\t\tapp[app.subGameName + \"_SysNotifyManager\"]().ShowSysMsg(\"Code_10010\");\r\n\t\t\t\tapp[app.subGameName + \"Client\"].OnEvent(\"ConnectHttpFail\", {\"ServerName\":\"AccountServer\"});\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\t//换节点\r\n\t\t\tapp[app.subGameName + \"_HeroAccountManager\"]().UpdateAccessPoint();\r\n\t\t\tthis.InitServerAddress();\r\n\t\t\tthis.SendHttpPack(this.sendPack);\r\n\t\t\tthis.RetryTime=this.RetryTime+1;*/\r\n\t\t}\r\n\t\telse{\r\n\t\t\tthis.ErrLog(\"OnConnectHttpFail serverUrl:%s error\", serverUrl);\r\n\t\t}\r\n\t},\r\n\r\n    //------------操作函数-----------------------------\r\n\r\n    //下线\r\n    Disconnect:function(byLogout = false){\r\n        this.NetWork.Disconnect(byLogout);\r\n    },\r\n\r\n\tSendGMPack:function(cmdString){\r\n\t\tlet sendPack = {\"cmdString\":cmdString};\r\n\t\tthis.SendPack(\"game.C1105GMPack\", sendPack)\r\n\t},\r\n\r\n\tOnPack_GMPack:function(serverPack){\r\n\t\tapp[app.subGameName + \"Client\"].OnEvent(\"GMPack\", serverPack);\r\n\t},\r\n\r\n});\r\n\r\nvar g_pdk_NetManager = null;\r\n\r\n/**\r\n * 绑定模块外部方法\r\n */\r\nexports.GetModel = function(){\r\n    if(!g_pdk_NetManager){\r\n        g_pdk_NetManager = new pdk_NetManager();\r\n    }\r\n    return g_pdk_NetManager;\r\n}"]}