{"version":3,"sources":["..\\..\\..\\..\\..\\assets\\script\\ui/assets\\script\\ui\\pdk_BaseChildForm.js"],"names":["app","require","BaseChildForm","cc","Class","extends","subGameName","properties","frontNode","Node","backNode","deviation","OnCreate","parent","childComponentName","index","userData","pos","JS_Name","join","Parent","_dataInfo","parentEventFuncDict","InitBaseData","OnCreateInit","ShowFormName","node","setPosition","initClickX","InitScrollEffect","unuse","stopAllActions","DeleteFormAllEffect","ClearFormAllChildComponent","reuse","active","OnLoad","Destroy","OnDestroy","destroy","ShowForm","argList","OnShow","apply","error","ErrLog","stack","CloseForm","OnClose","ShowOrCloseForm","OnParentEvent","eventName","argDict","parentEventFunc","Log","IsFormShow","GetParent","on","OnFront_TouchMove","OnFront_TouchStart","OnFront_TouchEnd","OnFront_TouchCancel","event","width","director","getWinSize","ClickPositionX","getLocationX","frontPosition","getPositionX","DistanceX","touchPosX","getLocation","x","nodeX","setPositionX","RegEvent","func","RegParentEvent","OnClick_Close","module","exports"],"mappings":"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","file":"pdk_BaseChildForm.js","sourceRoot":"..\\..\\..\\..\\..\\assets\\script\\ui","sourcesContent":["/*\r\n BaseChildForm 子界面基类(又界面控制创建和销毁,一般是BaseForm的子界面,或者BaseChildForm的子界面(可以无限嵌套下去))\r\n */\r\n\r\nvar app = require(\"pdk_app\");\r\n\r\n\r\nvar BaseChildForm = cc.Class({\r\n\r\n\textends: require(app.subGameName + \"_BaseForm\"),\r\n\r\n\tproperties: {\r\n\t\tfrontNode:cc.Node,\r\n\t\tbackNode:cc.Node,\r\n        deviation:0,\r\n\t},\r\n\r\n\tOnCreate:function(parent, childComponentName, index, userData, pos=null){\r\n\t\tthis.JS_Name = [childComponentName, index].join(\"_\");\r\n\r\n\t\tthis.Parent = parent;\r\n\r\n\t\t//界面数据\r\n\t\tthis._dataInfo = {\r\n\t\t\t\"FormName\":childComponentName,\r\n\t\t\t\"UserData\":userData,\r\n\t\t\t\"ChildIndex\":index,\r\n\t\t};\r\n\r\n\t\t//注册父类事件分发\r\n\t\tthis.parentEventFuncDict = {};\r\n\r\n\t\tthis.InitBaseData();\r\n\r\n\t\tthis.OnCreateInit();\r\n\r\n\t\tthis.ShowFormName();\r\n\r\n\t\tif(pos){\r\n\t\t\tthis.node.setPosition(pos);\r\n\t\t}\r\n\r\n        this.initClickX = 0;\r\n\r\n\t\tthis.InitScrollEffect();\r\n\r\n    },\r\n\r\n\t//------------回掉函数----------------\r\n\r\n\t//被对象池回收\r\n\tunuse: function () {\r\n\t\tthis.node.stopAllActions();\r\n\t\tthis.DeleteFormAllEffect();\r\n\t\tthis.ClearFormAllChildComponent();\r\n\t},\r\n\r\n\t//对象池释放复用\r\n\treuse: function () {\r\n\t\tthis.node.active = true;\r\n\t},\r\n\r\n\t// 加载创建界面\r\n\tOnLoad: function () {\r\n\r\n\t},\r\n\r\n\t//销毁界面\r\n\tDestroy:function(){\r\n\r\n\t\tthis.OnDestroy();\r\n\t\t//销毁节点\r\n\t\tthis.node.destroy();\r\n\t},\r\n\r\n\r\n\t//显示界面\r\n\tShowForm:function(...argList){\r\n\t\ttry {\r\n\t\t\tthis.node.active = true;\r\n\t\t\tthis.OnShow.apply(this, argList);\r\n\t\t}\r\n\t\tcatch(error){\r\n\t\t\tthis.ErrLog(\"ShowForm:%s\", error.stack);\r\n\t\t}\r\n\r\n\t},\r\n\r\n\t//关闭界面\r\n\tCloseForm:function(){\r\n\t\tthis.node.active = false;\r\n\t\tthis.OnClose();\r\n\t},\r\n\r\n\t//开启或者关闭界面\r\n\tShowOrCloseForm:function(){\r\n\t\tthis.ErrLog(\"ShowOrCloseForm cant call\")\r\n\t},\r\n\r\n\t//响应父类事件\r\n\tOnParentEvent:function(eventName, argDict){\r\n\t\tlet parentEventFunc = this.parentEventFuncDict[eventName];\r\n\t\tif(!parentEventFunc){\r\n\t\t\tthis.Log(\"OnParentEvent(%s) not parentEventFunc\", eventName);\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tparentEventFunc.apply(this, [argDict]);\r\n\t},\r\n\r\n\t//--------------获取接口-----------------\r\n\t//界面是否显示中\r\n\tIsFormShow:function(){\r\n\t\tthis.ErrLog(\"IsFormShow cant call\")\r\n\t},\r\n\r\n\t//-------------获取接口-------------------\r\n\t//获取界面父类\r\n\tGetParent:function(){\r\n\t\treturn this.Parent;\r\n\t},\r\n\r\n\t//-------------滑动出现删除控件效果-----------------\r\n\tInitScrollEffect:function () {\r\n\t\tif(this.frontNode){\r\n            this.frontNode.on(\"touchmove\", this.OnFront_TouchMove, this);\r\n            this.frontNode.on(\"touchstart\", this.OnFront_TouchStart, this);\r\n            this.frontNode.on(\"touchend\", this.OnFront_TouchEnd, this);\r\n            this.frontNode.on(\"touchcancel\", this.OnFront_TouchCancel, this);\r\n\t\t}\r\n    },\r\n\tOnFront_TouchEnd:function (event) {\r\n        // let MoveNodeParent = this.frontNode.parent;\r\n        // let MoveNodeWorldPositionX = MoveNodeParent.parent.convertToWorldSpaceAR(MoveNodeParent.getPosition()).x + MoveNodeParent.width/2;\r\n        // let DeleteBtnNodeWorldPositionX = this.backNode.parent.convertToWorldSpaceAR(this.backNode.getPosition()).x;\r\n\t\t// this.Log(MoveNodeWorldPositionX, DeleteBtnNodeWorldPositionX);\r\n    },\r\n\tOnFront_TouchCancel:function () {\r\n\r\n    },\r\n\tOnFront_TouchStart:function (event) {\r\n        let width = cc.director.getWinSize().width / 2;\r\n\t\tlet ClickPositionX = event.getLocationX() - width;\r\n\t\tlet frontPosition = this.frontNode.getPositionX();\r\n        this.DistanceX = ClickPositionX - frontPosition;\r\n    },\r\n\tOnFront_TouchMove:function (event) {\r\n\t\tif(!this.backNode){\r\n\t\t\tthis.ErrLog(\"OnFront_TouchMove not find backNode %s\", this.backNode);\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif(!this.DistanceX){\r\n\t\t\tthis.ErrLog(\"OnFront_TouchMove not find initClickX %s\", this.initClickX);\r\n\t\t\treturn;\r\n\t\t}\r\n        let width = cc.director.getWinSize().width / 2;\r\n        let touchPosX = event.getLocation().x - width;\r\n        let nodeX = touchPosX - this.DistanceX ;\r\n        if(nodeX >= 0){\r\n            nodeX = 0;\r\n        }\r\n        let deviation = this.backNode.width+this.deviation;\r\n        if(nodeX <= -deviation){\r\n            nodeX = -deviation;\r\n        }\r\n\t\tthis.frontNode.setPositionX(nodeX);\r\n    },\r\n\t//------------快捷功能函数-------------\r\n\r\n\t//注冊事件函数\r\n\tRegEvent:function(eventName, func){\r\n\t\tthis.ErrLog(\"RegEvent cant call\")\r\n\t},\r\n\r\n\t/**\r\n\t * 注册父类相应事件回调函数\r\n\t */\r\n\tRegParentEvent:function(event, func){\r\n\t\tthis.parentEventFuncDict[event] = func;\r\n\t},\r\n\r\n\t//-------------点击函数-------------\r\n\t//关闭界面\r\n\tOnClick_Close:function(){\r\n\t\tthis.ErrLog(\"OnClick_Close cant call\")\r\n\t},\r\n\t//--------------子类重载接口---------------\r\n\r\n\t//每次显示界面被调用\r\n\tOnShow:function(){\r\n\t},\r\n\r\n\r\n});\r\n\r\nmodule.exports = BaseChildForm;\r\n\r\n\r\n"]}