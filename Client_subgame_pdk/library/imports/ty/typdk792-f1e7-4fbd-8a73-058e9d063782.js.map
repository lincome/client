{"version":3,"sources":["..\\..\\..\\..\\..\\assets\\script\\ui/assets\\script\\ui\\pdk_UIJoin.js"],"names":["app","require","cc","Class","extends","subGameName","properties","sp_shurukuang","Node","OnCreateInit","labelString","GameManager","RegEvent","Event_GetFamilyInfo","Event_CodeError","event","codeInfo","ShareDefine","CLUB_NotClubJoinRoomErr","ShowSysMsg","Event_EnterRoomNeedJoinFamily","familyID","WaitForConfirm","ConfirmYN","length","roomKey","join","SendEnterRoom","ErrLog","OnShow","ResetNumber","children","idx","sp_bg","getChildByName","getComponent","Label","string","OnConFirm","clickType","msgID","backArgList","SendJoinFamily","OnClickForm","OnClick","btnName","btnNode","Click_Btn_Clear","Click_btn_close","Click_BtnNumber","OnClick_Close","node","GetWndNode","pop","num","Math","floor","substring","push","lb_num","data","toString","self","SendPack","toUpperCase"],"mappings":"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","file":"pdk_UIJoin.js","sourceRoot":"..\\..\\..\\..\\..\\assets\\script\\ui","sourcesContent":["/*\r\n UIJoin 登陆界面\r\n*/\r\nvar app = require(\"pdk_app\");\r\ncc.Class({\r\n    extends: require(app.subGameName + \"_BaseForm\"),\r\n\r\n    properties: {\r\n        sp_shurukuang:cc.Node,\r\n    },\r\n    OnCreateInit: function () {\r\n        this.labelString = [];\r\n        this.GameManager = app[app.subGameName + \"_GameManager\"]();\r\n\t    // this.RegEvent(\"EnterRoomNeedJoinFamily\", this.Event_EnterRoomNeedJoinFamily, this);\r\n\t    this.RegEvent(\"GetFamilyInfo\", this.Event_GetFamilyInfo, this);\r\n        this.RegEvent(\"CodeError\", this.Event_CodeError, this);\r\n    },\r\n\t//事件回调\r\n    Event_CodeError:function(event){\r\n        let codeInfo = event;\r\n        if(codeInfo[\"Code\"] == this.ShareDefine.CLUB_NotClubJoinRoomErr){\r\n            app[app.subGameName + \"_SysNotifyManager\"]().ShowSysMsg('CLUB_NotClubJoinRoomErr');\r\n        }\r\n    },\r\n\tEvent_EnterRoomNeedJoinFamily:function(event){\r\n\t\tlet familyID = event[\"familyID\"];\r\n\r\n\t\tthis.WaitForConfirm(\"EnterRoomNeedJoinFamily\", [], [familyID], this.ShareDefine.ConfirmYN);\r\n\t},\r\n\r\n\tEvent_GetFamilyInfo:function(){\r\n\r\n\t\t//加入房主工会成功,再次发送进入房间\r\n\t\tif(this.labelString.length == 6){\r\n\t\t\tlet roomKey = this.labelString.join(\"\");\r\n\t\t\tthis.GameManager.SendEnterRoom(roomKey);\r\n\t\t}\r\n\t\telse{\r\n\t\t\tthis.ErrLog(\"Event_GetFamilyInfo labelString error\", this.labelString);\r\n\t\t}\r\n\t},\r\n\r\n    OnShow:function () {\r\n        this.ResetNumber();\r\n    },\r\n\r\n    ResetNumber:function(){\r\n        let children = this.sp_shurukuang.children;\r\n        for(let idx = 0; idx < children.length; idx++){\r\n            let sp_bg = children[idx];\r\n            sp_bg.getChildByName(\"lb_num\").getComponent(cc.Label).string = \"\";\r\n        }\r\n        this.labelString = [];\r\n    },\r\n\r\n\t/**\r\n\t * 2次确认点击回调\r\n\t * @param curEventType\r\n\t * @param curArgList\r\n\t */\r\n\tOnConFirm:function(clickType, msgID, backArgList){\r\n\t\tif(clickType != \"Sure\"){\r\n\t\t\treturn\r\n\t\t}\r\n\r\n\t\t//如果确定加入房主的工会\r\n\t\tif(msgID == \"EnterRoomNeedJoinFamily\"){\r\n\t\t\t//发送加入工会\r\n\t\t\tapp[app.subGameName+\"_PlayerFamilyManager\"]().SendJoinFamily(backArgList[0]);\r\n\t\t}\r\n\t\telse{\r\n\t\t\tthis.ErrLog(\"OnConFirm not find msgID:%s\", msgID);\r\n\t\t}\r\n\t},\r\n    OnClickForm:function () {\r\n        //this.CloseForm();\r\n    },\r\n    //---------点击函数---------------------\r\n    OnClick:function(btnName, btnNode){\r\n        if(!btnName){\r\n            this.ErrLog(\"UIJoin Buttn OnClick(%s) not find btnName\", btnName);\r\n        }\r\n        if(btnName === \"btn_clear\"){\r\n            this.Click_Btn_Clear();\r\n        }\r\n        else if(btnName === \"btn_close\"){\r\n            this.Click_btn_close();\r\n        }\r\n        else if(btnName === \"btn_reset\"){\r\n            this.ResetNumber();\r\n        }\r\n        else{\r\n            this.Click_BtnNumber(btnName);\r\n        }\r\n    },\r\n\r\n    Click_btn_close:function () {\r\n        this.labelString = [];\r\n        this.OnClick_Close();\r\n    },\r\n\r\n    Click_Btn_Clear:function () {\r\n        if(this.labelString.length == 0){\r\n            return\r\n        }\r\n        let node = this.GetWndNode(\"sp_shuru/shurukuang/sp_bg\" + this.labelString.length + \"/lb_num\");\r\n        node.getComponent(cc.Label).string = \"\";\r\n        this.labelString.pop();\r\n    },\r\n\r\n    Click_BtnNumber:function (btnName) {\r\n        if(this.labelString.length >= 6)\r\n            return;\r\n        let num = Math.floor(btnName.substring(btnName.length - 1));\r\n        this.labelString.push(num);\r\n\t    let roomKey = this.labelString.join(\"\");\r\n\r\n        let children = this.sp_shurukuang.children;\r\n        for(let idx = 0; idx < children.length; idx++){\r\n            let sp_bg = children[idx];\r\n            let lb_num = sp_bg.getChildByName(\"lb_num\").getComponent(cc.Label);\r\n            if(lb_num.string == \"\"){\r\n                let data = this.labelString[this.labelString.length -1];\r\n                lb_num.string = data.toString();\r\n                break;\r\n            }\r\n        }\r\n        if(this.labelString.length == 6){\r\n            let self = this;\r\n            app[app.subGameName + \"_NetManager\"]().SendPack(app.subGameName + \".C\" + app.subGameName.toUpperCase() + \"EnterRoom\", {\"roomKey\":roomKey,\"posID\":-1}, function(){}, function(event){\r\n                self.ResetNumber();\r\n            });\r\n        }\r\n    },\r\n\r\n});\r\n"]}