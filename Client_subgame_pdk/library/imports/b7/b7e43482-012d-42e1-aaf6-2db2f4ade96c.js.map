{"version":3,"sources":["..\\..\\..\\..\\..\\assets\\script\\ui/assets\\script\\ui\\pdk_UIRoomTest.js"],"names":["app","require","cc","Class","extends","subGameName","properties","OnCreateInit","cards","OnShow","totalNum","cardMap","i","length","element","GetValue","push","model","node","getChildByName","bg","children","destroy","key","Object","hasOwnProperty","call","item","instantiate","parent","active","name","GetName","getComponent","Label","string","v","names","Sure","test","num","parseInt","index","Math","min","RoomMgr","toUpperCase","roomID","GetEnterRoom","GetRoomProperty","that","SendChat","JSON","stringify","msg","console","log","code","ShowSysMsg","CloseForm","Add","event","target","Del","type","quickID","content","success","SendPack"],"mappings":"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","file":"pdk_UIRoomTest.js","sourceRoot":"..\\..\\..\\..\\..\\assets\\script\\ui","sourcesContent":["var app = require(\"pdk_app\");\r\ncc.Class({\r\n    extends: require(app.subGameName + \"_BaseForm\"),\r\n\r\n    properties: {\r\n\t\t\r\n    },\r\n    OnCreateInit: function (cards) {\r\n       \r\n        \r\n    },\r\n    OnShow: function (cards) {\r\n        this.cards = cards\r\n        this.totalNum = 0\r\n        this.cardMap = {}\r\n        for (let i = 0; i < cards.length; i++) {\r\n            const element = this.GetValue(cards[i]);\r\n            if(!element) continue\r\n            if (!this.cardMap[element]) {\r\n                this.cardMap[element] = []\r\n            }\r\n            this.cardMap[element].push(cards[i])\r\n        }\r\n        let model = this.node.getChildByName(\"model\")\r\n        let bg = this.node.getChildByName(\"bg\")\r\n        for (let i = 0; i < bg.children.length; i++) {\r\n            const element = bg.children[i];\r\n            element.destroy()\r\n        }\r\n        for (const key in this.cardMap) {\r\n            if (!Object.hasOwnProperty.call(this.cardMap, key)) continue;\r\n            let item = cc.instantiate(model)\r\n            item.parent = bg\r\n            item.active = true\r\n            let name = this.GetName(key)\r\n            item.getChildByName(\"poker\").getChildByName(\"Label\").getComponent(cc.Label).string = name\r\n            item.name = key\r\n        }\r\n        model.active = false\r\n    },\r\n    GetValue:function(v){\r\n        if(!v) v = 0\r\n        v = v%16;\r\n        if (v == 14) {\r\n            return 1\r\n        }\r\n        if (v == 15) {\r\n            return 2\r\n        }\r\n        return v\r\n    },\r\n    GetName:function(v){\r\n        if(!v) return \"\"\r\n        let names = [\"扑克A\",\"扑克2\",\"扑克3\",\"扑克4\",\"扑克5\",\"扑克6\",\"扑克7\",\"扑克8\",\"扑克9\",\r\n        \"扑克10\",\"扑克J\",\"扑克Q\",\"扑克K\",\"小鬼\",\"大鬼\"]\r\n        return names[v-1] || \"\"\r\n    },\r\n    Sure:function(){\r\n        let bg = this.node.getChildByName(\"bg\")\r\n        let test = []\r\n        for (let i = 0; i < bg.children.length; i++) {\r\n            const element = bg.children[i].name;\r\n            if (!this.cardMap[element] || this.cardMap[element].length == 0) continue\r\n            let num = parseInt(bg.children[i].getChildByName(\"num\").getComponent(cc.Label).string)\r\n            for (let index = 0; index < Math.min(num, this.cardMap[element].length); index++) {\r\n                test.push(this.cardMap[element][index])\r\n            }\r\n        }\r\n        let RoomMgr = app[app.subGameName.toUpperCase()+\"RoomMgr\"]();\r\n        if(!RoomMgr) return;\r\n\t\tlet roomID = RoomMgr.GetEnterRoom().GetRoomProperty(\"roomID\");\r\n        if(!roomID) return\r\n        let that = this\r\n        this.SendChat(5, 9988, roomID, JSON.stringify(test),(msg)=>{\r\n            console.log(msg)\r\n            if(msg.code == \"Success\")\r\n            {\r\n                this.ShowSysMsg(msg.msg);\r\n                that.CloseForm()\r\n            }\r\n        });\r\n        console.log(test)\r\n    },\r\n    Add:function(event){\r\n        let bg = this.node.getChildByName(\"bg\")\r\n        let key = event.target.parent.name\r\n        let num = parseInt(bg.getChildByName(key).getChildByName(\"num\").getComponent(cc.Label).string)\r\n        num ++\r\n        if (this.totalNum >= 16) return\r\n        if (num > this.cardMap[key].length) {\r\n            num = this.cardMap[key].length\r\n        }\r\n        else{\r\n            this.totalNum ++\r\n        }\r\n        bg.getChildByName(key).getChildByName(\"num\").getComponent(cc.Label).string = num\r\n    },\r\n    Del:function(event){\r\n        let bg = this.node.getChildByName(\"bg\")\r\n        let key = event.target.parent.name\r\n        let num = parseInt(bg.getChildByName(key).getChildByName(\"num\").getComponent(cc.Label).string)\r\n        num --\r\n        if (num < 0) {\r\n            num = 0\r\n        }\r\n        else{\r\n            this.totalNum --\r\n        }\r\n        bg.getChildByName(key).getChildByName(\"num\").getComponent(cc.Label).string = num\r\n    },\r\n    SendChat:function (type, quickID, roomID, content,success) {\r\n\t\tapp[app.subGameName + \"_NetManager\"]().SendPack(app.subGameName + \".C\" + app.subGameName.toUpperCase() + \"Chat\", \r\n        {\"type\":type, \"quickID\":quickID, \"targetID\":roomID, \"content\":content}, success);\r\n\t},\r\n});\r\n"]}